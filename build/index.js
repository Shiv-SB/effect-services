var iC=Object.defineProperty;var o4=($,X)=>{for(var J in X)iC($,J,{get:X[J],enumerable:!0,configurable:!0,set:(Z)=>X[J]=()=>Z})};function E7($,X){var J={};for(var Z in $)if(Object.prototype.hasOwnProperty.call($,Z)&&X.indexOf(Z)<0)J[Z]=$[Z];if($!=null&&typeof Object.getOwnPropertySymbols==="function"){for(var Q=0,Z=Object.getOwnPropertySymbols($);Q<Z.length;Q++)if(X.indexOf(Z[Q])<0&&Object.prototype.propertyIsEnumerable.call($,Z[Q]))J[Z[Q]]=$[Z[Q]]}return J}function qH($){var X=typeof Symbol==="function"&&Symbol.iterator,J=X&&$[X],Z=0;if(J)return J.call($);if($&&typeof $.length==="number")return{next:function(){if($&&Z>=$.length)$=void 0;return{value:$&&$[Z++],done:!$}}};throw TypeError(X?"Object is not iterable.":"Symbol.iterator is not defined.")}function b0($){return this instanceof b0?(this.v=$,this):new b0($)}function I7($,X,J){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var Z=J.apply($,X||[]),Q,Y=[];return Q=Object.create((typeof AsyncIterator==="function"?AsyncIterator:Object).prototype),K("next"),K("throw"),K("return",G),Q[Symbol.asyncIterator]=function(){return this},Q;function G(A){return function(F){return Promise.resolve(F).then(A,V)}}function K(A,F){if(Z[A]){if(Q[A]=function(E){return new Promise(function(d,n){Y.push([A,E,d,n])>1||B(A,E)})},F)Q[A]=F(Q[A])}}function B(A,F){try{H(Z[A](F))}catch(E){N(Y[0][3],E)}}function H(A){A.value instanceof b0?Promise.resolve(A.value.v).then(z,V):N(Y[0][2],A)}function z(A){B("next",A)}function V(A){B("throw",A)}function N(A,F){if(A(F),Y.shift(),Y.length)B(Y[0][0],Y[0][1])}}function MH($){var X,J;return X={},Z("next"),Z("throw",function(Q){throw Q}),Z("return"),X[Symbol.iterator]=function(){return this},X;function Z(Q,Y){X[Q]=$[Q]?function(G){return(J=!J)?{value:b0($[Q](G)),done:!1}:Y?Y(G):G}:Y}}function R7($){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var X=$[Symbol.asyncIterator],J;return X?X.call($):($=typeof qH==="function"?qH($):$[Symbol.iterator](),J={},Z("next"),Z("throw"),Z("return"),J[Symbol.asyncIterator]=function(){return this},J);function Z(Y){J[Y]=$[Y]&&function(G){return new Promise(function(K,B){G=$[Y](G),Q(K,B,G.done,G.value)})}}function Q(Y,G,K,B){Promise.resolve(B).then(function(H){Y({value:H,done:K})},G)}}function DG(...$){if($.length>0){let X=String($[0]);if(X.includes(":error"))console.error(...$);else if(X.includes(":warning"))console.warn(...$);else if(X.includes(":info"))console.info(...$);else if(X.includes(":verbose"))console.debug(...$);else console.debug(...$)}}var PH=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,CH,VG=[],UG=[],fZ=[];if(PH)NG(PH);var EH=Object.assign(($)=>{return IH($)},{enable:NG,enabled:AG,disable:rC,log:DG});function NG($){CH=$,VG=[],UG=[];let X=$.split(",").map((J)=>J.trim());for(let J of X)if(J.startsWith("-"))UG.push(J.substring(1));else VG.push(J);for(let J of fZ)J.enabled=AG(J.namespace)}function AG($){if($.endsWith("*"))return!0;for(let X of UG)if(_H($,X))return!1;for(let X of VG)if(_H($,X))return!0;return!1}function _H($,X){if(X.indexOf("*")===-1)return $===X;let J=X;if(X.indexOf("**")!==-1){let N=[],A="";for(let F of X)if(F==="*"&&A==="*")continue;else A=F,N.push(F);J=N.join("")}let Z=0,Q=0,Y=J.length,G=$.length,K=-1,B=-1;while(Z<G&&Q<Y)if(J[Q]==="*"){if(K=Q,Q++,Q===Y)return!0;while($[Z]!==J[Q])if(Z++,Z===G)return!1;B=Z,Z++,Q++;continue}else if(J[Q]===$[Z])Q++,Z++;else if(K>=0){if(Q=K+1,Z=B+1,Z===G)return!1;while($[Z]!==J[Q])if(Z++,Z===G)return!1;B=Z,Z++,Q++;continue}else return!1;let H=Z===$.length,z=Q===J.length,V=Q===J.length-1&&J[Q]==="*";return H&&(z||V)}function rC(){let $=CH||"";return NG(""),$}function IH($){let X=Object.assign(J,{enabled:AG($),destroy:aC,log:EH.log,namespace:$,extend:sC});function J(...Z){if(!X.enabled)return;if(Z.length>0)Z[0]=`${$} ${Z[0]}`;X.log(...Z)}return fZ.push(X),X}function aC(){let $=fZ.indexOf(this);if($>=0)return fZ.splice($,1),!0;return!1}function sC($){let X=IH(`${this.namespace}:${$}`);return X.log=this.log,X}var W5=EH;var OG=["verbose","info","warning","error"],RH={verbose:400,info:300,warning:200,error:100};function SH($,X){X.log=(...J)=>{$.log(...J)}}function jH($){return OG.includes($)}function pZ($){let X=new Set,J=typeof process<"u"&&process.env&&process.env[$.logLevelEnvVarName]||void 0,Z,Q=W5($.namespace);Q.log=(...z)=>{W5.log(...z)};function Y(z){if(z&&!jH(z))throw Error(`Unknown log level '${z}'. Acceptable values: ${OG.join(",")}`);Z=z;let V=[];for(let N of X)if(G(N))V.push(N.namespace);W5.enable(V.join(","))}if(J)if(jH(J))Y(J);else console.error(`${$.logLevelEnvVarName} set to unknown log level '${J}'; logging is not enabled. Acceptable values: ${OG.join(", ")}.`);function G(z){return Boolean(Z&&RH[z.level]<=RH[Z])}function K(z,V){let N=Object.assign(z.extend(V),{level:V});if(SH(z,N),G(N)){let A=W5.disable();W5.enable(A+","+N.namespace)}return X.add(N),N}function B(){return Z}function H(z){let V=Q.extend(z);return SH(Q,V),{error:K(V,"error"),warning:K(V,"warning"),info:K(V,"info"),verbose:K(V,"verbose")}}return{setLogLevel:Y,getLogLevel:B,createClientLogger:H,logger:Q}}var xH=pZ({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"}),Xl=xH.logger;function nZ($){return xH.createClientLogger($)}var kH=pZ({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"}),Gl=kH.logger;function j$($){return kH.createClientLogger($)}var vH=j$("keyvault-secrets");var yH=j$("keyvault-secrets");class i4 extends Error{constructor($){super($);this.name="AbortError"}}function lZ($){return $.toLowerCase()}function*tC($){for(let X of $.values())yield[X.name,X.value]}class bH{_headersMap;constructor($){if(this._headersMap=new Map,$)for(let X of Object.keys($))this.set(X,$[X])}set($,X){this._headersMap.set(lZ($),{name:$,value:String(X).trim()})}get($){return this._headersMap.get(lZ($))?.value}has($){return this._headersMap.has(lZ($))}delete($){this._headersMap.delete(lZ($))}toJSON($={}){let X={};if($.preserveCase)for(let J of this._headersMap.values())X[J.name]=J.value;else for(let[J,Z]of this._headersMap)X[J]=Z.value;return X}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return tC(this._headersMap)}}function k8($){return new bH($)}function gH(){let $="";for(let X=0;X<32;X++){let J=Math.floor(Math.random()*16);if(X===12)$+="4";else if(X===16)$+=J&3|8;else $+=J.toString(16);if(X===7||X===11||X===15||X===19)$+="-"}return $}var eC=typeof globalThis?.crypto?.randomUUID==="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):gH;function S7(){return eC()}class hH{url;method;headers;timeout;withCredentials;body;multipartBody;formData;streamResponseStatusCodes;enableBrowserStreams;proxySettings;disableKeepAlive;abortSignal;requestId;allowInsecureConnection;onUploadProgress;onDownloadProgress;requestOverrides;authSchemes;constructor($){this.url=$.url,this.body=$.body,this.headers=$.headers??k8(),this.method=$.method??"GET",this.timeout=$.timeout??0,this.multipartBody=$.multipartBody,this.formData=$.formData,this.disableKeepAlive=$.disableKeepAlive??!1,this.proxySettings=$.proxySettings,this.streamResponseStatusCodes=$.streamResponseStatusCodes,this.withCredentials=$.withCredentials??!1,this.abortSignal=$.abortSignal,this.onUploadProgress=$.onUploadProgress,this.onDownloadProgress=$.onDownloadProgress,this.requestId=$.requestId||S7(),this.allowInsecureConnection=$.allowInsecureConnection??!1,this.enableBrowserStreams=$.enableBrowserStreams??!1,this.requestOverrides=$.requestOverrides,this.authSchemes=$.authSchemes}}function mH($){return new hH($)}var dH=new Set(["Deserialize","Serialize","Retry","Sign"]);class oZ{_policies=[];_orderedPolicies;constructor($){this._policies=$?.slice(0)??[],this._orderedPolicies=void 0}addPolicy($,X={}){if(X.phase&&X.afterPhase)throw Error("Policies inside a phase cannot specify afterPhase.");if(X.phase&&!dH.has(X.phase))throw Error(`Invalid phase name: ${X.phase}`);if(X.afterPhase&&!dH.has(X.afterPhase))throw Error(`Invalid afterPhase name: ${X.afterPhase}`);this._policies.push({policy:$,options:X}),this._orderedPolicies=void 0}removePolicy($){let X=[];return this._policies=this._policies.filter((J)=>{if($.name&&J.policy.name===$.name||$.phase&&J.options.phase===$.phase)return X.push(J.policy),!1;else return!0}),this._orderedPolicies=void 0,X}sendRequest($,X){return this.getOrderedPolicies().reduceRight((Q,Y)=>{return(G)=>{return Y.sendRequest(G,Q)}},(Q)=>$.sendRequest(Q))(X)}getOrderedPolicies(){if(!this._orderedPolicies)this._orderedPolicies=this.orderPolicies();return this._orderedPolicies}clone(){return new oZ(this._policies)}static create(){return new oZ}orderPolicies(){let $=[],X=new Map;function J(A){return{name:A,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let Z=J("Serialize"),Q=J("None"),Y=J("Deserialize"),G=J("Retry"),K=J("Sign"),B=[Z,Q,Y,G,K];function H(A){if(A==="Retry")return G;else if(A==="Serialize")return Z;else if(A==="Deserialize")return Y;else if(A==="Sign")return K;else return Q}for(let A of this._policies){let{policy:F,options:E}=A,d=F.name;if(X.has(d))throw Error("Duplicate policy names not allowed in pipeline");let n={policy:F,dependsOn:new Set,dependants:new Set};if(E.afterPhase)n.afterPhase=H(E.afterPhase),n.afterPhase.hasAfterPolicies=!0;X.set(d,n),H(E.phase).policies.add(n)}for(let A of this._policies){let{policy:F,options:E}=A,d=F.name,n=X.get(d);if(!n)throw Error(`Missing node for policy ${d}`);if(E.afterPolicies)for(let K0 of E.afterPolicies){let _0=X.get(K0);if(_0)n.dependsOn.add(_0),_0.dependants.add(n)}if(E.beforePolicies)for(let K0 of E.beforePolicies){let _0=X.get(K0);if(_0)_0.dependsOn.add(n),n.dependants.add(_0)}}function z(A){A.hasRun=!0;for(let F of A.policies){if(F.afterPhase&&(!F.afterPhase.hasRun||F.afterPhase.policies.size))continue;if(F.dependsOn.size===0){$.push(F.policy);for(let E of F.dependants)E.dependsOn.delete(F);X.delete(F.policy.name),A.policies.delete(F)}}}function V(){for(let A of B){if(z(A),A.policies.size>0&&A!==Q){if(!Q.hasRun)z(Q);return}if(A.hasAfterPolicies)z(Q)}}let N=0;while(X.size>0){N++;let A=$.length;if(V(),$.length<=A&&N>1)throw Error("Cannot satisfy policy dependencies due to requirements cycle.")}return $}}function j7(){return oZ.create()}function x7($){return typeof $==="object"&&$!==null&&!Array.isArray($)&&!($ instanceof RegExp)&&!($ instanceof Date)}function r4($){if(x7($)){let X=typeof $.name==="string",J=typeof $.message==="string";return X&&J}return!1}var cH=Symbol();var wG="REDACTED",$E=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],XE=["api-version"];class Q4{allowedHeaderNames;allowedQueryParameters;constructor({additionalAllowedHeaderNames:$=[],additionalAllowedQueryParameters:X=[]}={}){$=$E.concat($),X=XE.concat(X),this.allowedHeaderNames=new Set($.map((J)=>J.toLowerCase())),this.allowedQueryParameters=new Set(X.map((J)=>J.toLowerCase()))}sanitize($){let X=new Set;return JSON.stringify($,(J,Z)=>{if(Z instanceof Error)return{...Z,name:Z.name,message:Z.message};if(J==="headers")return this.sanitizeHeaders(Z);else if(J==="url")return this.sanitizeUrl(Z);else if(J==="query")return this.sanitizeQuery(Z);else if(J==="body")return;else if(J==="response")return;else if(J==="operationSpec")return;else if(Array.isArray(Z)||x7(Z)){if(X.has(Z))return"[Circular]";X.add(Z)}return Z},2)}sanitizeUrl($){if(typeof $!=="string"||$===null||$==="")return $;let X=new URL($);if(!X.search)return $;for(let[J]of X.searchParams)if(!this.allowedQueryParameters.has(J.toLowerCase()))X.searchParams.set(J,wG);return X.toString()}sanitizeHeaders($){let X={};for(let J of Object.keys($))if(this.allowedHeaderNames.has(J.toLowerCase()))X[J]=$[J];else X[J]=wG;return X}sanitizeQuery($){if(typeof $!=="object"||$===null)return $;let X={};for(let J of Object.keys($))if(this.allowedQueryParameters.has(J.toLowerCase()))X[J]=$[J];else X[J]=wG;return X}}var JE=new Q4;class s0 extends Error{static REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";static PARSE_ERROR="PARSE_ERROR";code;statusCode;request;response;details;constructor($,X={}){super($);this.name="RestError",this.code=X.code,this.statusCode=X.statusCode,Object.defineProperty(this,"request",{value:X.request,enumerable:!1}),Object.defineProperty(this,"response",{value:X.response,enumerable:!1});let J=this.request?.agent?{maxFreeSockets:this.request.agent.maxFreeSockets,maxSockets:this.request.agent.maxSockets}:void 0;Object.defineProperty(this,cH,{value:()=>{return`RestError: ${this.message} 
 ${JE.sanitize({...this,request:{...this.request,agent:J},response:this.response})}`},enumerable:!1}),Object.setPrototypeOf(this,s0.prototype)}}function k7($){if($ instanceof s0)return!0;return r4($)&&$.name==="RestError"}function v7($,X){switch(X){case"utf-8":return QE($);case"base64":return fH($);case"base64url":return ZE($);case"hex":return YE($)}}function u0($,X){switch(X){case"utf-8":return GE($);case"base64":return pH($);case"base64url":return KE($);case"hex":return BE($)}}function fH($){return btoa([...$].map((X)=>String.fromCharCode(X)).join(""))}function ZE($){return fH($).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function QE($){return new TextDecoder().decode($)}function YE($){return[...$].map((X)=>X.toString(16).padStart(2,"0")).join("")}function GE($){return new TextEncoder().encode($)}function pH($){return new Uint8Array([...atob($)].map((X)=>X.charCodeAt(0)))}function KE($){let X=$.replace(/-/g,"+").replace(/_/g,"/");return pH(X)}var uH=new Set("0123456789abcdefABCDEF");function BE($){let X=new Uint8Array($.length/2);for(let J=0;J<$.length/2;++J){let Z=$[2*J],Q=$[2*J+1];if(!uH.has(Z)||!uH.has(Q))return X.slice(0,J);X[J]=parseInt(`${Z}${Q}`,16)}return X}function FG($){return Boolean($&&typeof $.pipe==="function")}function H5($){return Boolean($&&typeof $.getReader==="function"&&typeof $.tee==="function")}function TG($){return $!==void 0&&($ instanceof Uint8Array||LG($)||typeof $==="function"||$ instanceof Blob)}function LG($){return FG($)||H5($)}function nH($){return typeof $.stream==="function"}function lH($){if($.buffer instanceof ArrayBuffer&&$.byteOffset===0&&$.byteLength===$.buffer.byteLength)return $.buffer;let X=new ArrayBuffer($.byteLength),J=new Uint8Array(X),Z=new Uint8Array($.buffer,$.byteOffset,$.byteLength);return J.set(Z),J.buffer}function WE($){return(typeof Blob==="function"||typeof Blob==="object")&&$ instanceof Blob}class oH{async sendRequest($){if(new URL($.url).protocol!=="https:"&&!$.allowInsecureConnection)throw Error(`Cannot connect to ${$.url} while allowInsecureConnection is false.`);if($.proxySettings)throw Error("HTTP proxy is not supported in browser environment");try{return await HE($)}catch(Z){throw VE(Z,$)}}}async function HE($){let{abortController:X,abortControllerCleanup:J}=DE($);try{let Z=UE($.headers),{streaming:Q,body:Y}=AE($),G={body:Y,method:$.method,headers:Z,signal:X.signal,..."credentials"in Request.prototype?{credentials:$.withCredentials?"include":"same-origin"}:{},..."cache"in Request.prototype?{cache:"no-store"}:{}};if(Q)G.duplex="half";let K=await fetch($.url,{...G,...$.requestOverrides});if(WE($.body)&&$.onUploadProgress)$.onUploadProgress({loadedBytes:$.body.size});return zE(K,$,J)}catch(Z){throw J?.(),Z}}async function zE($,X,J){let Z=NE($),Q={request:X,headers:Z,status:$.status},Y=H5($.body)?iH($.body,{onProgress:X.onDownloadProgress,onEnd:J}):$.body;if(X.streamResponseStatusCodes?.has(Number.POSITIVE_INFINITY)||X.streamResponseStatusCodes?.has(Q.status))if(X.enableBrowserStreams)Q.browserStreamBody=Y??void 0;else{let G=new Response(Y);Q.blobBody=G.blob(),J?.()}else{let G=new Response(Y);Q.bodyAsText=await G.text(),J?.()}return Q}function DE($){let X=new AbortController,J,Z;if($.abortSignal){if($.abortSignal.aborted)throw new i4("The operation was aborted. Request has already been canceled.");Z=(Q)=>{if(Q.type==="abort")X.abort()},$.abortSignal.addEventListener("abort",Z),J=()=>{if(Z)$.abortSignal?.removeEventListener("abort",Z)}}if($.timeout>0)setTimeout(()=>{X.abort()},$.timeout);return{abortController:X,abortControllerCleanup:J}}function VE($,X){if($&&$?.name==="AbortError")return $;else return new s0(`Error sending request: ${$.message}`,{code:$?.code??s0.REQUEST_SEND_ERROR,request:X})}function UE($){let X=new Headers;for(let[J,Z]of $)X.append(J,Z);return X}function NE($){let X=k8();for(let[J,Z]of $.headers)X.set(J,Z);return X}function AE($){let X=typeof $.body==="function"?$.body():$.body;if(FG(X))throw Error("Node streams are not supported in browser environment.");if(H5(X))return{streaming:!0,body:iH(X,{onProgress:$.onUploadProgress})};else if(typeof X==="object"&&X&&"buffer"in X)return{streaming:!1,body:lH(X)};else if(X===void 0)return{streaming:!1};else return{streaming:!1,body:X}}function iH($,X={}){let J=0,{onProgress:Z,onEnd:Q}=X;if(OE($))return $.pipeThrough(new TransformStream({transform(Y,G){if(Y===null){G.terminate();return}if(G.enqueue(Y),J+=Y.length,Z)Z({loadedBytes:J})},flush(){Q?.()}}));else{let Y=$.getReader();return new ReadableStream({async pull(G){let{done:K,value:B}=await Y.read();if(K||!B){Q?.(),G.close(),Y.releaseLock();return}if(J+=B?.length??0,G.enqueue(B),Z)Z({loadedBytes:J})},cancel(G){return Q?.(),Y.cancel(G)}})}}function rH(){return new oH}function OE($){return $.pipeThrough!==void 0&&self.TransformStream!==void 0}function aH(){return rH()}var iZ=nZ("ts-http-runtime");var qG="logPolicy";function y7($={}){let X=$.logger??iZ.info,J=new Q4({additionalAllowedHeaderNames:$.additionalAllowedHeaderNames,additionalAllowedQueryParameters:$.additionalAllowedQueryParameters});return{name:qG,async sendRequest(Z,Q){if(!X.enabled)return Q(Z);X(`Request: ${J.sanitize(Z)}`);let Y=await Q(Z);return X(`Response status code: ${Y.status}`),X(`Headers: ${J.sanitize(Y.headers)}`),Y}}}var sH=["GET","HEAD"];function b7($={}){let{maxRetries:X=20}=$;return{name:"redirectPolicy",async sendRequest(J,Z){let Q=await Z(J);return tH(Z,Q,X)}}}async function tH($,X,J,Z=0){let{request:Q,status:Y,headers:G}=X,K=G.get("location");if(K&&(Y===300||Y===301&&sH.includes(Q.method)||Y===302&&sH.includes(Q.method)||Y===303&&Q.method==="POST"||Y===307)&&Z<J){let B=new URL(K,Q.url);if(Q.url=B.toString(),Y===303)Q.method="GET",Q.headers.delete("Content-Length"),delete Q.body;Q.headers.delete("Authorization");let H=await $(Q);return tH($,H,J,Z+1)}return X}function eH(){return"x-ms-useragent"}function wE($){let X=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(let J of X){let Z=$.match(J.regex);if(Z)return{brand:J.name,version:Z[1]}}return}function FE($){let X=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(let J of X){let Z=$.find((Q)=>Q.brand===J);if(Z)return Z}return}async function $z($){let X=globalThis.navigator,J="unknown";if(X?.userAgentData){let Z=await X.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);J=`${Z.platform} ${Z.platformVersion}; ${Z.architecture}`;let Q=FE(X.userAgentData.brands);if(Q)$.set(Q.brand,`${Q.version} (${J})`)}else if(X?.platform){J=X.platform;let Z=wE(X.userAgent);if(Z)$.set(Z.brand,`${Z.version} (${J})`)}else if(typeof globalThis.EdgeRuntime==="string")$.set("EdgeRuntime",`${globalThis.EdgeRuntime} (${J})`)}var Xz="0.3.2",g7=3;function TE($){let X=[];for(let[J,Z]of $){let Q=Z?`${J}/${Z}`:J;X.push(Q)}return X.join(" ")}function Jz(){return eH()}async function Zz($){let X=new Map;X.set("ts-http-runtime",Xz),await $z(X);let J=TE(X);return $?`${$} ${J}`:J}var Qz=Jz(),LE="userAgentPolicy";function Yz($={}){let X=Zz($.userAgentPrefix);return{name:LE,async sendRequest(J,Z){if(!J.headers.has(Qz))J.headers.set(Qz,await X);return Z(J)}}}function h7(){throw Error("decompressResponsePolicy is not supported in browser environment")}function MG($,X){return $=Math.ceil($),X=Math.floor(X),Math.floor(Math.random()*(X-$+1))+$}function PG($,X){let J=X.retryDelayInMs*Math.pow(2,$),Z=Math.min(X.maxRetryDelayInMs,J);return{retryAfterInMs:Z/2+MG(0,Z/2)}}var qE="The operation was aborted.";function Gz($,X,J){return new Promise((Z,Q)=>{let Y=void 0,G=void 0,K=()=>{return Q(new i4(J?.abortErrorMsg?J?.abortErrorMsg:qE))},B=()=>{if(J?.abortSignal&&G)J.abortSignal.removeEventListener("abort",G)};if(G=()=>{if(Y)clearTimeout(Y);return B(),K()},J?.abortSignal&&J.abortSignal.aborted)return K();if(Y=setTimeout(()=>{B(),Z(X)},$),J?.abortSignal)J.abortSignal.addEventListener("abort",G)})}function Kz($,X){let J=$.headers.get(X);if(!J)return;let Z=Number(J);if(Number.isNaN(Z))return;return Z}var _G="Retry-After",ME=["retry-after-ms","x-ms-retry-after-ms",_G];function Bz($){if(!($&&[429,503].includes($.status)))return;try{for(let Q of ME){let Y=Kz($,Q);if(Y===0||Y)return Y*(Q===_G?1000:1)}let X=$.headers.get(_G);if(!X)return;let Z=Date.parse(X)-Date.now();return Number.isFinite(Z)?Math.max(0,Z):void 0}catch{return}}function Wz($){return Number.isFinite(Bz($))}function Hz(){return{name:"throttlingRetryStrategy",retry({response:$}){let X=Bz($);if(!Number.isFinite(X))return{skipStrategy:!0};return{retryAfterInMs:X}}}}var PE=1000,_E=64000;function zz($={}){let X=$.retryDelayInMs??PE,J=$.maxRetryDelayInMs??_E;return{name:"exponentialRetryStrategy",retry({retryCount:Z,response:Q,responseError:Y}){let G=EE(Y),K=G&&$.ignoreSystemErrors,B=CE(Q),H=B&&$.ignoreHttpStatusCodes;if(Q&&(Wz(Q)||!B)||H||K)return{skipStrategy:!0};if(Y&&!G&&!B)return{errorToThrow:Y};return PG(Z,{retryDelayInMs:X,maxRetryDelayInMs:J})}}}function CE($){return Boolean($&&$.status!==void 0&&($.status>=500||$.status===408)&&$.status!==501&&$.status!==505)}function EE($){if(!$)return!1;return $.code==="ETIMEDOUT"||$.code==="ESOCKETTIMEDOUT"||$.code==="ECONNREFUSED"||$.code==="ECONNRESET"||$.code==="ENOENT"||$.code==="ENOTFOUND"}var IE=nZ("ts-http-runtime retryPolicy"),RE="retryPolicy";function Dz($,X={maxRetries:g7}){let J=X.logger||IE;return{name:RE,async sendRequest(Z,Q){let Y,G,K=-1;$:while(!0){K+=1,Y=void 0,G=void 0;try{J.info(`Retry ${K}: Attempting to send request`,Z.requestId),Y=await Q(Z),J.info(`Retry ${K}: Received a response from request`,Z.requestId)}catch(B){if(J.error(`Retry ${K}: Received an error from request`,Z.requestId),G=B,!B||G.name!=="RestError")throw B;Y=G.response}if(Z.abortSignal?.aborted)throw J.error(`Retry ${K}: Request aborted.`),new i4;if(K>=(X.maxRetries??g7))if(J.info(`Retry ${K}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),G)throw G;else if(Y)return Y;else throw Error("Maximum retries reached with no response or error to throw");J.info(`Retry ${K}: Processing ${$.length} retry strategies.`);X:for(let B of $){let H=B.logger||J;H.info(`Retry ${K}: Processing retry strategy ${B.name}.`);let z=B.retry({retryCount:K,response:Y,responseError:G});if(z.skipStrategy){H.info(`Retry ${K}: Skipped.`);continue X}let{errorToThrow:V,retryAfterInMs:N,redirectTo:A}=z;if(V)throw H.error(`Retry ${K}: Retry strategy ${B.name} throws error:`,V),V;if(N||N===0){H.info(`Retry ${K}: Retry strategy ${B.name} retries after ${N}`),await Gz(N,void 0,{abortSignal:Z.abortSignal});continue $}if(A){H.info(`Retry ${K}: Retry strategy ${B.name} redirects to ${A}`),Z.url=A;continue $}}if(G)throw J.info("None of the retry strategies could work with the received error. Throwing it."),G;if(Y)return J.info("None of the retry strategies could work with the received response. Returning it."),Y}}}}var CG="defaultRetryPolicy";function m7($={}){return{name:CG,sendRequest:Dz([Hz(),zz($)],{maxRetries:$.maxRetries??g7}).sendRequest}}var Vz=typeof window<"u"&&typeof window.document<"u",Uz=typeof self==="object"&&typeof self?.importScripts==="function"&&(self.constructor?.name==="DedicatedWorkerGlobalScope"||self.constructor?.name==="ServiceWorkerGlobalScope"||self.constructor?.name==="SharedWorkerGlobalScope"),Nz=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",Az=typeof Bun<"u"&&typeof Bun.version<"u",O$=typeof globalThis.process<"u"&&Boolean(globalThis.process.version)&&Boolean(globalThis.process.versions?.node);var Oz=typeof navigator<"u"&&navigator?.product==="ReactNative";var EG="formDataPolicy";function SE($){let X={};for(let[J,Z]of $.entries())X[J]??=[],X[J].push(Z);return X}function d7(){return{name:EG,async sendRequest($,X){if(O$&&typeof FormData<"u"&&$.body instanceof FormData)$.formData=SE($.body),$.body=void 0;if($.formData){let J=$.headers.get("Content-Type");if(J&&J.indexOf("application/x-www-form-urlencoded")!==-1)$.body=jE($.formData);else await xE($.formData,$);$.formData=void 0}return X($)}}}function jE($){let X=new URLSearchParams;for(let[J,Z]of Object.entries($))if(Array.isArray(Z))for(let Q of Z)X.append(J,Q.toString());else X.append(J,Z.toString());return X.toString()}async function xE($,X){let J=X.headers.get("Content-Type");if(J&&!J.startsWith("multipart/form-data"))return;X.headers.set("Content-Type",J??"multipart/form-data");let Z=[];for(let[Q,Y]of Object.entries($))for(let G of Array.isArray(Y)?Y:[Y])if(typeof G==="string")Z.push({headers:k8({"Content-Disposition":`form-data; name="${Q}"`}),body:u0(G,"utf-8")});else if(G===void 0||G===null||typeof G!=="object")throw Error(`Unexpected value for key ${Q}: ${G}. Value should be serialized to string first.`);else{let K=G.name||"blob",B=k8();B.set("Content-Disposition",`form-data; name="${Q}"; filename="${K}"`),B.set("Content-Type",G.type||"application/octet-stream"),Z.push({headers:B,body:G})}X.multipartBody={parts:Z}}function c7(){throw Error("proxyPolicy is not supported in browser environment")}function u7($){return{name:"agentPolicy",sendRequest:async(X,J)=>{if(!X.agent)X.agent=$;return J(X)}}}function f7($){return{name:"tlsPolicy",sendRequest:async(X,J)=>{if(!X.tlsSettings)X.tlsSettings=$;return J(X)}}}function kE($){return new Response($).blob()}async function vE($){if($ instanceof Blob||$ instanceof Uint8Array)return $;if(H5($))return kE($);else throw Error("Unsupported source type. Only Blob, Uint8Array, and ReadableStream are supported in browser.")}function yE($){if("resize"in $.buffer)return $;return $.map((X)=>X)}async function wz($){let X=[];for(let J of $){let Z=await vE(typeof J==="function"?J():J);if(Z instanceof Blob)X.push(Z);else X.push(new Blob([yE(Z)]))}return new Blob(X)}function bE(){return`----AzSDKFormBoundary${S7()}`}function gE($){let X="";for(let[J,Z]of $)X+=`${J}: ${Z}\r
`;return X}function hE($){if($ instanceof Uint8Array)return $.byteLength;else if(nH($))return $.size===-1?void 0:$.size;else return}function mE($){let X=0;for(let J of $){let Z=hE(J);if(Z===void 0)return;else X+=Z}return X}async function dE($,X,J){let Z=[u0(`--${J}`,"utf-8"),...X.flatMap((Y)=>[u0(`\r
`,"utf-8"),u0(gE(Y.headers),"utf-8"),u0(`\r
`,"utf-8"),Y.body,u0(`\r
--${J}`,"utf-8")]),u0(`--\r
\r
`,"utf-8")],Q=mE(Z);if(Q)$.headers.set("Content-Length",Q);$.body=await wz(Z)}var z5="multipartPolicy",cE=70,uE=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function fE($){if($.length>cE)throw Error(`Multipart boundary "${$}" exceeds maximum length of 70 characters`);if(Array.from($).some((X)=>!uE.has(X)))throw Error(`Multipart boundary "${$}" contains invalid characters`)}function p7(){return{name:z5,async sendRequest($,X){if(!$.multipartBody)return X($);if($.body)throw Error("multipartBody and regular body cannot be set at the same time");let J=$.multipartBody.boundary,Z=$.headers.get("Content-Type")??"multipart/mixed",Q=Z.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!Q)throw Error(`Got multipart request body, but content-type header was not multipart: ${Z}`);let[,Y,G]=Q;if(G&&J&&G!==J)throw Error(`Multipart boundary was specified as ${G} in the header, but got ${J} in the request body`);if(J??=G,J)fE(J);else J=bE();return $.headers.set("Content-Type",`${Y}; boundary=${J}`),await dE($,$.multipartBody.parts,J),$.multipartBody=void 0,X($)}}}function Fz($){let X=j7();if(O$){if($.agent)X.addPolicy(u7($.agent));if($.tlsOptions)X.addPolicy(f7($.tlsOptions));X.addPolicy(c7($.proxyOptions)),X.addPolicy(h7())}if(X.addPolicy(d7(),{beforePolicies:[z5]}),X.addPolicy(Yz($.userAgentOptions)),X.addPolicy(p7(),{afterPhase:"Deserialize"}),X.addPolicy(m7($.retryOptions),{phase:"Retry"}),O$)X.addPolicy(b7($.redirectOptions),{afterPhase:"Retry"});return X.addPolicy(y7($.loggingOptions),{afterPhase:"Sign"}),X}function Tz($){return{name:"ApiVersionPolicy",sendRequest:(X,J)=>{let Z=new URL(X.url);if(!Z.searchParams.get("api-version")&&$.apiVersion)X.url=`${X.url}${Array.from(Z.searchParams.keys()).length>0?"&":"?"}api-version=${$.apiVersion}`;return J(X)}}}function Lz($){return"getOAuth2Token"in $}function qz($){return"getBearerToken"in $}function Mz($){return"username"in $&&"password"in $}function Pz($){return"key"in $}var _z=!1;function pE($,X){if(X.allowInsecureConnection&&$.allowInsecureConnection){let J=new URL($.url);if(J.hostname==="localhost"||J.hostname==="127.0.0.1")return!0}return!1}function nE(){if(iZ.warning("Sending token over insecure transport. Assume any token issued is compromised."),typeof process?.emitWarning==="function"&&!_z)_z=!0,process.emitWarning("Sending token over insecure transport. Assume any token issued is compromised.")}function Y4($,X){if(!$.url.toLowerCase().startsWith("https://"))if(pE($,X))nE();else throw Error("Authentication is not permitted for non-TLS protected (non-https) URLs when allowInsecureConnection is false.")}var lE="apiKeyAuthenticationPolicy";function Cz($){return{name:lE,async sendRequest(X,J){Y4(X,$);let Z=(X.authSchemes??$.authSchemes)?.find((Q)=>Q.kind==="apiKey");if(!Z)return J(X);if(Z.apiKeyLocation!=="header")throw Error(`Unsupported API key location: ${Z.apiKeyLocation}`);return X.headers.set(Z.name,$.credential.key),J(X)}}}var oE="bearerAuthenticationPolicy";function Ez($){return{name:oE,async sendRequest(X,J){if(Y4(X,$),!(X.authSchemes??$.authSchemes)?.find((K)=>K.kind==="http"&&K.scheme==="basic"))return J(X);let{username:Q,password:Y}=$.credential,G=v7(u0(`${Q}:${Y}`,"utf-8"),"base64");return X.headers.set("Authorization",`Basic ${G}`),J(X)}}}var iE="bearerAuthenticationPolicy";function Iz($){return{name:iE,async sendRequest(X,J){if(Y4(X,$),!(X.authSchemes??$.authSchemes)?.find((Y)=>Y.kind==="http"&&Y.scheme==="bearer"))return J(X);let Q=await $.credential.getBearerToken({abortSignal:X.abortSignal});return X.headers.set("Authorization",`Bearer ${Q}`),J(X)}}}var rE="oauth2AuthenticationPolicy";function Rz($){return{name:rE,async sendRequest(X,J){Y4(X,$);let Z=(X.authSchemes??$.authSchemes)?.find((Y)=>Y.kind==="oauth2");if(!Z)return J(X);let Q=await $.credential.getOAuth2Token(Z.flows,{abortSignal:X.abortSignal});return X.headers.set("Authorization",`Bearer ${Q}`),J(X)}}}var IG;function Sz($={}){let X=Fz($);X.addPolicy(Tz($));let{credential:J,authSchemes:Z,allowInsecureConnection:Q}=$;if(J){if(Pz(J))X.addPolicy(Cz({authSchemes:Z,credential:J,allowInsecureConnection:Q}));else if(Mz(J))X.addPolicy(Ez({authSchemes:Z,credential:J,allowInsecureConnection:Q}));else if(qz(J))X.addPolicy(Iz({authSchemes:Z,credential:J,allowInsecureConnection:Q}));else if(Lz(J))X.addPolicy(Rz({authSchemes:Z,credential:J,allowInsecureConnection:Q}))}return X}function jz(){if(!IG)IG=aH();return IG}function kz($,X){if($.headers){let J=Object.keys($.headers).find((Z)=>Z.toLowerCase()===X.toLowerCase());if(J)return $.headers[J]}return}function aE($){let X=kz($,"content-type");if(X)return X;if($.contentType===null)return;if($.contentType)return $.contentType;let{body:J}=$;if(J===null||J===void 0)return;if(typeof J==="string"||typeof J==="number"||typeof J==="boolean")return"text/plain; charset=UTF-8";if(J instanceof Blob)return J.type||"application/octet-stream";if(TG(J))return"application/octet-stream";return"application/json"}function xz($){return JSON.stringify($)}function sE($){let X=kz($,"content-disposition");if(X)return X;if($.dispositionType===void 0&&$.name===void 0&&$.filename===void 0)return;let Z=$.dispositionType??"form-data";if($.name)Z+=`; name=${xz($.name)}`;let Q=void 0;if($.filename)Q=$.filename;else if(typeof File<"u"&&$.body instanceof File){let Y=$.body.name;if(Y!=="")Q=Y}if(Q)Z+=`; filename=${xz(Q)}`;return Z}function tE($,X){if($===void 0)return new Uint8Array([]);if(TG($))return $;if(typeof $==="string"||typeof $==="number"||typeof $==="boolean")return u0(String($),"utf-8");if(X&&/application\/(.+\+)?json(;.+)?/i.test(String(X)))return u0(JSON.stringify($),"utf-8");throw new s0(`Unsupported body/content-type combination: ${$}, ${X}`)}function eE($){let X=aE($),J=sE($),Z=k8($.headers??{});if(X)Z.set("content-type",X);if(J)Z.set("content-disposition",J);let Q=tE($.body,X);return{headers:Z,body:Q}}function vz($){return{parts:$.map(eE)}}async function rZ($,X,J,Z={},Q){let Y=Q??jz(),G=JI($,X,Z);try{let K=await J.sendRequest(Y,G),B=K.headers.toJSON(),H=K.readableStreamBody??K.browserStreamBody,z=Z.responseAsStream||H!==void 0?void 0:QI(K),V=H??z;if(Z?.onResponse)Z.onResponse({...K,request:G,rawHeaders:B,parsedBody:z});return{request:G,headers:B,status:`${K.status}`,body:V}}catch(K){if(k7(K)&&K.response&&Z.onResponse){let{response:B}=K,H=B.headers.toJSON();Z?.onResponse({...B,request:G,rawHeaders:H},K)}throw K}}function $I($={}){return $.contentType??$.headers?.["content-type"]??XI($.body)}function XI($){if(ArrayBuffer.isView($))return"application/octet-stream";if(typeof $==="string")try{return JSON.parse($),"application/json"}catch(X){return}return"application/json"}function JI($,X,J={}){let Z=$I(J),{body:Q,multipartBody:Y}=ZI(J.body,Z),G=Q!==void 0||Y!==void 0,K=k8({...J.headers?J.headers:{},accept:J.accept??J.headers?.accept??"application/json",...G&&Z&&{"content-type":Z}});return mH({url:X,method:$,body:Q,multipartBody:Y,headers:K,allowInsecureConnection:J.allowInsecureConnection,abortSignal:J.abortSignal,onUploadProgress:J.onUploadProgress,onDownloadProgress:J.onDownloadProgress,timeout:J.timeout,enableBrowserStreams:!0,streamResponseStatusCodes:J.responseAsStream?new Set([Number.POSITIVE_INFINITY]):void 0})}function ZI($,X=""){if($===void 0)return{body:void 0};if(typeof FormData<"u"&&$ instanceof FormData)return{body:$};if(LG($))return{body:$};if(ArrayBuffer.isView($))return{body:$ instanceof Uint8Array?$:JSON.stringify($)};switch(X.split(";")[0]){case"application/json":return{body:JSON.stringify($)};case"multipart/form-data":if(Array.isArray($))return{multipartBody:vz($)};return{body:JSON.stringify($)};case"text/plain":return{body:String($)};default:if(typeof $==="string")return{body:$};return{body:JSON.stringify($)}}}function QI($){let J=($.headers.get("content-type")??"").split(";")[0],Z=$.bodyAsText??"";if(J==="text/plain")return String(Z);try{return Z?JSON.parse(Z):void 0}catch(Q){if(J==="application/json")throw YI($,Q);return String(Z)}}function YI($,X){let J=`Error "${X}" occurred while parsing the response body - ${$.bodyAsText}.`,Z=X.code??s0.PARSE_ERROR;return new s0(J,{code:Z,statusCode:$.status,request:$.request,response:$})}function GI($){let X=$.value;return X!==void 0&&X.toString!==void 0&&typeof X.toString==="function"}function yz($,X,J,Z={}){if(X.startsWith("https://")||X.startsWith("http://"))return X;$=BI($,Z),X=WI(X,J,Z);let Q=KI(`${$}/${X}`,Z);return new URL(Q).toString().replace(/([^:]\/)\/+/g,"$1")}function RG($,X,J,Z){let Q;if(J==="pipeDelimited")Q="|";else if(J==="spaceDelimited")Q="%20";else Q=",";let Y;if(Array.isArray(Z))Y=Z;else if(typeof Z==="object"&&Z.toString===Object.prototype.toString)Y=Object.entries(Z).flat();else Y=[Z];let G=Y.map((K)=>{if(K===null||K===void 0)return"";if(!K.toString||typeof K.toString!=="function")throw Error(`Query parameters must be able to be represented as string, ${$} can't`);let B=K.toISOString!==void 0?K.toISOString():K.toString();return X?B:encodeURIComponent(B)}).join(Q);return`${X?$:encodeURIComponent($)}=${G}`}function KI($,X={}){if(!X.queryParameters)return $;let J=new URL($),Z=X.queryParameters,Q=[];for(let Y of Object.keys(Z)){let G=Z[Y];if(G===void 0||G===null)continue;let K=GI(G),B=K?G.value:G,H=K?G.explode??!1:!1,z=K&&G.style?G.style:"form";if(H)if(Array.isArray(B))for(let V of B)Q.push(RG(Y,X.skipUrlEncoding??!1,z,V));else if(typeof B==="object")for(let[V,N]of Object.entries(B))Q.push(RG(V,X.skipUrlEncoding??!1,z,N));else throw Error("explode can only be set to true for objects and arrays");else Q.push(RG(Y,X.skipUrlEncoding??!1,z,B))}if(J.search!=="")J.search+="&";return J.search+=Q.join("&"),J.toString()}function BI($,X){if(!X.pathParameters)return $;let J=X.pathParameters;for(let[Z,Q]of Object.entries(J)){if(Q===void 0||Q===null)throw Error(`Path parameters ${Z} must not be undefined or null`);if(!Q.toString||typeof Q.toString!=="function")throw Error(`Path parameters must be able to be represented as string, ${Z} can't`);let Y=Q.toISOString!==void 0?Q.toISOString():String(Q);if(!X.skipUrlEncoding)Y=encodeURIComponent(Q);$=HI($,`{${Z}}`,Y)??""}return $}function WI($,X,J={}){for(let Z of X){let Q=typeof Z==="object"&&(Z.allowReserved??!1),Y=typeof Z==="object"?Z.value:Z;if(!J.skipUrlEncoding&&!Q)Y=encodeURIComponent(Y);$=$.replace(/\{[\w-]+\}/,String(Y))}return $}function HI($,X,J){return!$||!X?$:$.split(X).join(J||"")}function SG($,X={}){let J=X.pipeline??Sz(X);if(X.additionalPolicies?.length)for(let{policy:K,position:B}of X.additionalPolicies){let H=B==="perRetry"?"Sign":void 0;J.addPolicy(K,{afterPhase:H})}let{allowInsecureConnection:Z,httpClient:Q}=X,Y=X.endpoint??$,G=(K,...B)=>{let H=(z)=>yz(Y,K,B,{allowInsecureConnection:Z,...z});return{get:(z={})=>{return G4("GET",H(z),J,z,Z,Q)},post:(z={})=>{return G4("POST",H(z),J,z,Z,Q)},put:(z={})=>{return G4("PUT",H(z),J,z,Z,Q)},patch:(z={})=>{return G4("PATCH",H(z),J,z,Z,Q)},delete:(z={})=>{return G4("DELETE",H(z),J,z,Z,Q)},head:(z={})=>{return G4("HEAD",H(z),J,z,Z,Q)},options:(z={})=>{return G4("OPTIONS",H(z),J,z,Z,Q)},trace:(z={})=>{return G4("TRACE",H(z),J,z,Z,Q)}}};return{path:G,pathUnchecked:G,pipeline:J}}function G4($,X,J,Z,Q,Y){return Q=Z.allowInsecureConnection??Q,{then:function(G,K){return rZ($,X,J,{...Z,allowInsecureConnection:Q},Y).then(G,K)},async asBrowserStream(){if(O$)throw Error("`asBrowserStream` is supported only in the browser environment. Use `asNodeStream` instead to obtain the response body stream. If you require a Web stream of the response in Node, consider using `Readable.toWeb` on the result of `asNodeStream`.");else return rZ($,X,J,{...Z,allowInsecureConnection:Q,responseAsStream:!0},Y)},async asNodeStream(){if(O$)return rZ($,X,J,{...Z,allowInsecureConnection:Q,responseAsStream:!0},Y);else throw Error("`isNodeStream` is not supported in the browser environment. Use `asBrowserStream` to obtain the response body stream.")}}}function jG($){return{allowInsecureConnection:$.requestOptions?.allowInsecureConnection,timeout:$.requestOptions?.timeout,skipUrlEncoding:$.requestOptions?.skipUrlEncoding,abortSignal:$.abortSignal,onUploadProgress:$.requestOptions?.onUploadProgress,onDownloadProgress:$.requestOptions?.onDownloadProgress,headers:{...$.requestOptions?.headers},onResponse:$.onResponse}}function aZ($,X){let J=typeof $==="string"?X:$,Z=J.body?.error??J.body,Q=typeof $==="string"?$:Z?.message??`Unexpected status code: ${J.status}`;return new s0(Q,{statusCode:bz(J.status),code:Z?.code,request:J.request,response:zI(J)})}function zI($){return{headers:k8($.headers),request:$.request,status:bz($.status)??-1}}function bz($){let X=Number.parseInt($);return Number.isNaN(X)?void 0:X}function t0($,X){if(typeof $==="string")return aZ($,X);else return aZ($)}function gz(){return j7()}var U6=j$("core-rest-pipeline");function hz($={}){return y7({logger:U6.info,...$})}function mz($={}){return b7($)}function dz(){return"x-ms-useragent"}function wI($){let X=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(let J of X){let Z=$.match(J.regex);if(Z)return{brand:J.name,version:Z[1]}}return}function FI($){let X=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(let J of X){let Z=$.find((Q)=>Q.brand===J);if(Z)return Z}return}async function cz($){let X=globalThis.navigator,J="unknown";if(X?.userAgentData){let Z=await X.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);J=`${Z.platform} ${Z.platformVersion}; ${Z.architecture}`;let Q=FI(X.userAgentData.brands);if(Q)$.set(Q.brand,`${Q.version} (${J})`)}else if(X?.platform){J=X.platform;let Z=wI(X.userAgent);if(Z)$.set(Z.brand,`${Z.version} (${J})`)}else if(typeof globalThis.EdgeRuntime==="string")$.set("EdgeRuntime",`${globalThis.EdgeRuntime} (${J})`)}var sZ="1.22.2";function TI($){let X=[];for(let[J,Z]of $){let Q=Z?`${J}/${Z}`:J;X.push(Q)}return X.join(" ")}function uz(){return dz()}async function tZ($){let X=new Map;X.set("core-rest-pipeline",sZ),await cz(X);let J=TI(X);return $?`${$} ${J}`:J}var fz=uz(),LI="userAgentPolicy";function pz($={}){let X=tZ($.userAgentPrefix);return{name:LI,async sendRequest(J,Z){if(!J.headers.has(fz))J.headers.set(fz,await X);return Z(J)}}}class eZ extends Error{constructor($){super($);this.name="AbortError"}}function nz($,X){let{cleanupBeforeAbort:J,abortSignal:Z,abortErrorMsg:Q}=X??{};return new Promise((Y,G)=>{function K(){G(new eZ(Q??"The operation was aborted."))}function B(){Z?.removeEventListener("abort",H)}function H(){J?.(),B(),K()}if(Z?.aborted)return K();try{$((z)=>{B(),Y(z)},(z)=>{B(),G(z)})}catch(z){G(z)}Z?.addEventListener("abort",H)})}var PI="The delay was aborted.";function a4($,X){let J,{abortSignal:Z,abortErrorMsg:Q}=X??{};return nz((Y)=>{J=setTimeout(Y,$)},{cleanupBeforeAbort:()=>clearTimeout(J),abortSignal:Z,abortErrorMsg:Q??PI})}function D5($){if(r4($))return $.message;else{let X;try{if(typeof $==="object"&&$)X=JSON.stringify($);else X=String($)}catch(J){X="[unable to stringify input]"}return`Unknown error ${X}`}}function xG($){return typeof $<"u"&&$!==null}function kG($,X){if(!xG($)||typeof $!=="object")return!1;for(let J of X)if(!lz($,J))return!1;return!0}function lz($,X){return xG($)&&typeof $==="object"&&X in $}function oz($){return r4($)}var vG=O$;function iz($,X){return v7($,X)}function rz($,X){return u0($,X)}var az=Symbol("rawContent");function yG($){return typeof $[az]==="function"}function sz($){if(yG($))return $[az]();else return $}var bG=z5;function tz(){let $=p7();return{name:bG,sendRequest:async(X,J)=>{if(X.multipartBody){for(let Z of X.multipartBody.parts)if(yG(Z.body))Z.body=sz(Z.body)}return $.sendRequest(X,J)}}}function ez(){return h7()}function $D($={}){return m7($)}function XD(){return d7()}function JD($,X){return c7($,X)}function ZD($="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",async sendRequest(X,J){if(!X.headers.has($))X.headers.set($,X.requestId);return J(X)}}}function QD($){return u7($)}function YD($){return f7($)}var V5={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function GD($={}){let X=new n7($.parentContext);if($.span)X=X.setValue(V5.span,$.span);if($.namespace)X=X.setValue(V5.namespace,$.namespace);return X}class n7{_contextMap;constructor($){this._contextMap=$ instanceof n7?new Map($._contextMap):new Map}setValue($,X){let J=new n7(this);return J._contextMap.set($,X),J}getValue($){return this._contextMap.get($)}deleteValue($){let X=new n7(this);return X._contextMap.delete($),X}}var $9={instrumenterImplementation:void 0};function _I(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}}}function CI(){return{createRequestHeaders:()=>{return{}},parseTraceparentHeader:()=>{return},startSpan:($,X)=>{return{span:_I(),tracingContext:GD({parentContext:X.tracingContext})}},withContext($,X,...J){return X(...J)}}}function l7(){if(!$9.instrumenterImplementation)$9.instrumenterImplementation=CI();return $9.instrumenterImplementation}function s4($){let{namespace:X,packageName:J,packageVersion:Z}=$;function Q(H,z,V){let N=l7().startSpan(H,{...V,packageName:J,packageVersion:Z,tracingContext:z?.tracingOptions?.tracingContext}),A=N.tracingContext,F=N.span;if(!A.getValue(V5.namespace))A=A.setValue(V5.namespace,X);F.setAttribute("az.namespace",A.getValue(V5.namespace));let E=Object.assign({},z,{tracingOptions:{...z?.tracingOptions,tracingContext:A}});return{span:F,updatedOptions:E}}async function Y(H,z,V,N){let{span:A,updatedOptions:F}=Q(H,z,N);try{let E=await G(F.tracingOptions.tracingContext,()=>Promise.resolve(V(F,A)));return A.setStatus({status:"success"}),E}catch(E){throw A.setStatus({status:"error",error:E}),E}finally{A.end()}}function G(H,z,...V){return l7().withContext(H,z,...V)}function K(H){return l7().parseTraceparentHeader(H)}function B(H){return l7().createRequestHeaders(H)}return{startSpan:Q,withSpan:Y,withContext:G,parseTraceparentHeader:K,createRequestHeaders:B}}var X9=s0;function o7($){return k7($)}var EI="tracingPolicy";function KD($={}){let X=tZ($.userAgentPrefix),J=new Q4({additionalAllowedQueryParameters:$.additionalAllowedQueryParameters}),Z=II();return{name:EI,async sendRequest(Q,Y){if(!Z)return Y(Q);let G=await X,K={"http.url":J.sanitizeUrl(Q.url),"http.method":Q.method,"http.user_agent":G,requestId:Q.requestId};if(G)K["http.user_agent"]=G;let{span:B,tracingContext:H}=RI(Z,Q,K)??{};if(!B||!H)return Y(Q);try{let z=await Z.withContext(H,Y,Q);return jI(B,z),z}catch(z){throw SI(B,z),z}}}}function II(){try{return s4({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:sZ})}catch($){U6.warning(`Error when creating the TracingClient: ${D5($)}`);return}}function RI($,X,J){try{let{span:Z,updatedOptions:Q}=$.startSpan(`HTTP ${X.method}`,{tracingOptions:X.tracingOptions},{spanKind:"client",spanAttributes:J});if(!Z.isRecording()){Z.end();return}let Y=$.createRequestHeaders(Q.tracingOptions.tracingContext);for(let[G,K]of Object.entries(Y))X.headers.set(G,K);return{span:Z,tracingContext:Q.tracingOptions.tracingContext}}catch(Z){U6.warning(`Skipping creating a tracing span due to an error: ${D5(Z)}`);return}}function SI($,X){try{if($.setStatus({status:"error",error:oz(X)?X:void 0}),o7(X)&&X.statusCode)$.setAttribute("http.status_code",X.statusCode);$.end()}catch(J){U6.warning(`Skipping tracing span processing due to an error: ${D5(J)}`)}}function jI($,X){try{$.setAttribute("http.status_code",X.status);let J=X.headers.get("x-ms-request-id");if(J)$.setAttribute("serviceRequestId",J);if(X.status>=400)$.setStatus({status:"error"});$.end()}catch(J){U6.warning(`Skipping tracing span processing due to an error: ${D5(J)}`)}}function BD($){if($ instanceof AbortSignal)return{abortSignal:$};if($.aborted)return{abortSignal:AbortSignal.abort($.reason)};let X=new AbortController,J=!0;function Z(){if(J)$.removeEventListener("abort",Q),J=!1}function Q(){X.abort($.reason),Z()}return $.addEventListener("abort",Q),{abortSignal:X.signal,cleanup:Z}}var xI="wrapAbortSignalLikePolicy";function WD(){return{name:xI,sendRequest:async($,X)=>{if(!$.abortSignal)return X($);let{abortSignal:J,cleanup:Z}=BD($.abortSignal);$.abortSignal=J;try{return await X($)}finally{Z?.()}}}}function gG($){let X=gz();if(vG){if($.agent)X.addPolicy(QD($.agent));if($.tlsOptions)X.addPolicy(YD($.tlsOptions));X.addPolicy(JD($.proxyOptions)),X.addPolicy(ez())}if(X.addPolicy(WD()),X.addPolicy(XD(),{beforePolicies:[bG]}),X.addPolicy(pz($.userAgentOptions)),X.addPolicy(ZD($.telemetryOptions?.clientRequestIdHeaderName)),X.addPolicy(tz(),{afterPhase:"Deserialize"}),X.addPolicy($D($.retryOptions),{phase:"Retry"}),X.addPolicy(KD({...$.userAgentOptions,...$.loggingOptions}),{afterPhase:"Retry"}),vG)X.addPolicy(mz($.redirectOptions),{afterPhase:"Retry"});return X.addPolicy(hz($.loggingOptions),{afterPhase:"Sign"}),X}var kI={forcedRefreshWindowInMs:1000,retryIntervalInMs:3000,refreshWindowInMs:120000};async function vI($,X,J){async function Z(){if(Date.now()<J)try{return await $()}catch{return null}else{let Y=await $();if(Y===null)throw Error("Failed to refresh access token.");return Y}}let Q=await Z();while(Q===null)await a4(X),Q=await Z();return Q}function HD($,X){let J=null,Z=null,Q,Y={...kI,...X},G={get isRefreshing(){return J!==null},get shouldRefresh(){if(G.isRefreshing)return!1;if(Z?.refreshAfterTimestamp&&Z.refreshAfterTimestamp<Date.now())return!0;return(Z?.expiresOnTimestamp??0)-Y.refreshWindowInMs<Date.now()},get mustRefresh(){return Z===null||Z.expiresOnTimestamp-Y.forcedRefreshWindowInMs<Date.now()}};function K(B,H){if(!G.isRefreshing)J=vI(()=>$.getToken(B,H),Y.retryIntervalInMs,Z?.expiresOnTimestamp??Date.now()).then((V)=>{return J=null,Z=V,Q=H.tenantId,Z}).catch((V)=>{throw J=null,Z=null,Q=void 0,V});return J}return async(B,H)=>{let z=Boolean(H.claims),V=Q!==H.tenantId;if(z)Z=null;if(V||z||G.mustRefresh)return K(B,H);if(G.shouldRefresh)K(B,H);return Z}}var Z9="bearerTokenAuthenticationPolicy";async function J9($,X){try{return[await X($),void 0]}catch(J){if(o7(J)&&J.response)return[J.response,J];else throw J}}async function yI($){let{scopes:X,getAccessToken:J,request:Z}=$,Q={abortSignal:Z.abortSignal,tracingOptions:Z.tracingOptions,enableCae:!0},Y=await J(X,Q);if(Y)$.request.headers.set("Authorization",`Bearer ${Y.token}`)}function zD($){return $.status===401&&$.headers.has("WWW-Authenticate")}async function DD($,X){let{scopes:J}=$,Z=await $.getAccessToken(J,{enableCae:!0,claims:X});if(!Z)return!1;return $.request.headers.set("Authorization",`${Z.tokenType??"Bearer"} ${Z.token}`),!0}function hG($){let{credential:X,scopes:J,challengeCallbacks:Z}=$,Q=$.logger||U6,Y={authorizeRequest:Z?.authorizeRequest?.bind(Z)??yI,authorizeRequestOnChallenge:Z?.authorizeRequestOnChallenge?.bind(Z)},G=X?HD(X):()=>Promise.resolve(null);return{name:Z9,async sendRequest(K,B){if(!K.url.toLowerCase().startsWith("https://"))throw Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await Y.authorizeRequest({scopes:Array.isArray(J)?J:[J],request:K,getAccessToken:G,logger:Q});let H,z,V;if([H,z]=await J9(K,B),zD(H)){let N=VD(H.headers.get("WWW-Authenticate"));if(N){let A;try{A=atob(N)}catch(F){return Q.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${N}`),H}if(V=await DD({scopes:Array.isArray(J)?J:[J],response:H,request:K,getAccessToken:G,logger:Q},A),V)[H,z]=await J9(K,B)}else if(Y.authorizeRequestOnChallenge){if(V=await Y.authorizeRequestOnChallenge({scopes:Array.isArray(J)?J:[J],request:K,response:H,getAccessToken:G,logger:Q}),V)[H,z]=await J9(K,B);if(zD(H)){if(N=VD(H.headers.get("WWW-Authenticate")),N){let A;try{A=atob(N)}catch(F){return Q.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${N}`),H}if(V=await DD({scopes:Array.isArray(J)?J:[J],response:H,request:K,getAccessToken:G,logger:Q},A),V)[H,z]=await J9(K,B)}}}}if(z)throw z;else return H}}}function bI($){let X=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,J=/(\w+)="([^"]*)"/g,Z=[],Q;while((Q=X.exec($))!==null){let Y=Q[1],G=Q[2],K={},B;while((B=J.exec(G))!==null)K[B[1]]=B[2];Z.push({scheme:Y,params:K})}return Z}function VD($){if(!$)return;return bI($).find((J)=>J.scheme==="Bearer"&&J.params.claims&&J.params.error==="insufficient_claims")?.params.claims}function mG($){return kG($,["key"])&&typeof $.key==="string"}function i7($){let X=$;return X&&typeof X.getToken==="function"&&(X.signRequest===void 0||X.getToken.length>0)}function UD($){return{name:"ApiVersionPolicy",sendRequest:(X,J)=>{let Z=new URL(X.url);if(!Z.searchParams.get("api-version")&&$.apiVersion)X.url=`${X.url}${Array.from(Z.searchParams.keys()).length>0?"&":"?"}api-version=${$.apiVersion}`;return J(X)}}}function ND($,X){return{name:"keyCredentialAuthenticationPolicy",async sendRequest(J,Z){return J.headers.set(X,$.key),Z(J)}}}function gI($,X,J={}){let{credential:Z,clientOptions:Q}=J;if(!Z)return;if(i7(Z)){let Y=hG({credential:Z,scopes:Q?.credentials?.scopes??`${X}/.default`});$.addPolicy(Y)}else if(hI(Z)){if(!Q?.credentials?.apiKeyHeaderName)throw Error("Missing API Key Header Name");let Y=ND(Z,Q?.credentials?.apiKeyHeaderName);$.addPolicy(Y)}}function AD($,X,J={}){let Z=gG(J);return Z.addPolicy(UD(J)),gI(Z,$,{credential:X,clientOptions:J}),Z}function hI($){return $.key!==void 0}function w8($){return jG($)}function K4($){if($.onResponse)return{...$,onResponse(X,J){$.onResponse?.(X,J,J)}};return $}function OD($,X,J={}){let Z;if(X)if(mI(X))Z=X;else J=X??{};let Q=AD($,Z,J),Y=SG($,{...J,pipeline:Q}),G=(K,...B)=>{return{get:(H={})=>{return Y.path(K,...B).get(K4(H))},post:(H={})=>{return Y.path(K,...B).post(K4(H))},put:(H={})=>{return Y.path(K,...B).put(K4(H))},patch:(H={})=>{return Y.path(K,...B).patch(K4(H))},delete:(H={})=>{return Y.path(K,...B).delete(K4(H))},head:(H={})=>{return Y.path(K,...B).head(K4(H))},options:(H={})=>{return Y.path(K,...B).options(K4(H))},trace:(H={})=>{return Y.path(K,...B).trace(K4(H))}}};return{path:G,pathUnchecked:G,pipeline:Y.pipeline}}function mI($){return mG($)||i7($)}function dG($,X,J={}){var Z,Q,Y,G,K,B,H,z;let V=(Q=(Z=J.endpoint)!==null&&Z!==void 0?Z:J.baseUrl)!==null&&Q!==void 0?Q:String($),N=(Y=J===null||J===void 0?void 0:J.userAgentOptions)===null||Y===void 0?void 0:Y.userAgentPrefix,A="azsdk-js-keyvault-secrets/1.0.0-beta.1",F=N?`${N} azsdk-js-api azsdk-js-keyvault-secrets/1.0.0-beta.1`:"azsdk-js-api azsdk-js-keyvault-secrets/1.0.0-beta.1",E=Object.assign(Object.assign({},J),{userAgentOptions:{userAgentPrefix:F},loggingOptions:{logger:(K=(G=J.loggingOptions)===null||G===void 0?void 0:G.logger)!==null&&K!==void 0?K:yH.info},credentials:{scopes:(H=(B=J.credentials)===null||B===void 0?void 0:B.scopes)!==null&&H!==void 0?H:["https://vault.azure.net/.default"]}}),{apiVersion:d}=E,n=E7(E,["apiVersion"]),K0=OD(V,X,n);K0.pipeline.removePolicy({name:"ApiVersionPolicy"});let _0=(z=J.apiVersion)!==null&&z!==void 0?z:"7.6";return K0.pipeline.addPolicy({name:"ClientApiVersionPolicy",sendRequest:(c0,l4)=>{let t8=new URL(c0.url);if(!t8.searchParams.get("api-version"))c0.url=`${c0.url}${Array.from(t8.searchParams.keys()).length>0?"&":"?"}api-version=${_0}`;return l4(c0)}}),Object.assign(Object.assign({},K0),{apiVersion:_0})}function TD($){return{value:$.value,tags:$.tags,contentType:$.contentType,attributes:!$.secretAttributes?$.secretAttributes:LD($.secretAttributes)}}function LD($){return{enabled:$.enabled,nbf:!$.notBefore?$.notBefore:$.notBefore.getTime()/1000|0,exp:!$.expires?$.expires:$.expires.getTime()/1000|0}}function Q9($){return{enabled:$.enabled,notBefore:!$.nbf?$.nbf:new Date($.nbf*1000),expires:!$.exp?$.exp:new Date($.exp*1000),created:!$.created?$.created:new Date($.created*1000),updated:!$.updated?$.updated:new Date($.updated*1000),recoverableDays:$.recoverableDays,recoveryLevel:$.recoveryLevel}}var wD;(function($){$.Purgeable="Purgeable",$.RecoverablePurgeable="Recoverable+Purgeable",$.Recoverable="Recoverable",$.RecoverableProtectedSubscription="Recoverable+ProtectedSubscription",$.CustomizedRecoverablePurgeable="CustomizedRecoverable+Purgeable",$.CustomizedRecoverable="CustomizedRecoverable",$.CustomizedRecoverableProtectedSubscription="CustomizedRecoverable+ProtectedSubscription"})(wD||(wD={}));function U5($){return{value:$.value,id:$.id,contentType:$.contentType,attributes:!$.attributes?$.attributes:Q9($.attributes),tags:$.tags,kid:$.kid,managed:$.managed}}function v8($){return{error:!$.error?$.error:qD($.error)}}function qD($){return{code:$.code,message:$.message,innerError:!$.innererror?$.innererror:qD($.innererror)}}function cG($){return{value:$.value,id:$.id,contentType:$.contentType,attributes:!$.attributes?$.attributes:Q9($.attributes),tags:$.tags,kid:$.kid,managed:$.managed,recoveryId:$.recoveryId,scheduledPurgeDate:!$.scheduledPurgeDate?$.scheduledPurgeDate:new Date($.scheduledPurgeDate*1000),deletedDate:!$.deletedDate?$.deletedDate:new Date($.deletedDate*1000)}}function MD($){return{contentType:$.contentType,attributes:!$.secretAttributes?$.secretAttributes:LD($.secretAttributes),tags:$.tags}}function uG($){return{value:!$.value?$.value:dI($.value),nextLink:$.nextLink}}function dI($){return $.map((X)=>{return cI(X)})}function cI($){return{id:$.id,attributes:!$.attributes?$.attributes:Q9($.attributes),tags:$.tags,contentType:$.contentType,managed:$.managed}}function PD($){return{value:!$.value?$.value:uI($.value),nextLink:$.nextLink}}function uI($){return $.map((X)=>{return fI(X)})}function fI($){return{id:$.id,attributes:!$.attributes?$.attributes:Q9($.attributes),tags:$.tags,contentType:$.contentType,managed:$.managed,recoveryId:$.recoveryId,scheduledPurgeDate:!$.scheduledPurgeDate?$.scheduledPurgeDate:new Date($.scheduledPurgeDate*1000),deletedDate:!$.deletedDate?$.deletedDate:new Date($.deletedDate*1000)}}function _D($){return{value:!$.value?$.value:typeof $.value==="string"?rz($.value,"base64url"):$.value}}function CD($){return{value:iz($.secretBundleBackup,"base64url")}}var FD;(function($){$.V75="7.5",$.V76Preview2="7.6-preview.2",$.V76="7.6"})(FD||(FD={}));function Y9($,X,J,Z,Q={}){var Y,G;let K=(Y=Q.itemName)!==null&&Y!==void 0?Y:"value",B=(G=Q.nextLinkName)!==null&&G!==void 0?G:"nextLink",H={getPage:async(z)=>{let V=z===void 0?await X():await $.pathUnchecked(z).get();iI(V,Z);let N=await J(V),A=lI(N,B);return{page:oI(N,K),nextPageLink:A}},byPage:(z)=>{let{continuationToken:V}=z!==null&&z!==void 0?z:{};return fG(H,{pageLink:V})}};return pI(H)}function pI($){var X;let J=nI($);return{next(){return J.next()},[Symbol.asyncIterator](){return this},byPage:(X=$===null||$===void 0?void 0:$.byPage)!==null&&X!==void 0?X:(Z)=>{let{continuationToken:Q}=Z!==null&&Z!==void 0?Z:{};return fG($,{pageLink:Q})}}}function nI($){return I7(this,arguments,function*(){var J,Z,Q,Y;let G=fG($);try{for(var K=!0,B=R7(G),H;H=yield b0(B.next()),J=H.done,!J;K=!0)Y=H.value,K=!1,yield b0(yield*MH(R7(Y)))}catch(z){Z={error:z}}finally{try{if(!K&&!J&&(Q=B.return))yield b0(Q.call(B))}finally{if(Z)throw Z.error}}})}function fG($){return I7(this,arguments,function*(J,Z={}){let{pageLink:Q}=Z,Y=yield b0(J.getPage(Q!==null&&Q!==void 0?Q:J.firstPageLink));if(!Y)return yield b0(void 0);let G=Y.page;G.continuationToken=Y.nextPageLink,yield yield b0(G);while(Y.nextPageLink){if(Y=yield b0(J.getPage(Y.nextPageLink)),!Y)return yield b0(void 0);G=Y.page,G.continuationToken=Y.nextPageLink,yield yield b0(G)}})}function lI($,X){if(!X)return;let J=$[X];if(typeof J!=="string"&&typeof J<"u"&&J!==null)throw new X9(`Body Property ${X} should be a string or undefined or null but got ${typeof J}`);if(J===null)return;return J}function oI($,X){let J=$[X];if(!Array.isArray(J))throw new X9(`Couldn't paginate response
 Body doesn't contain an array property with name: ${X}`);return J!==null&&J!==void 0?J:[]}function iI($,X){if(!X.includes($.status))throw t0(`Pagination failed with unexpected statusCode ${$.status}`,$)}function N5($,X,J){return(X!==null&&X!==void 0?X:J==="+")||J==="#"?ED($):ID($)}function ED($){return $.split(/(%[0-9A-Fa-f]{2})/g).map((X)=>!/%[0-9A-Fa-f]/.test(X)?encodeURI(X):X).join("")}function ID($){return encodeURIComponent($).replace(/[!'()*]/g,(X)=>`%${X.charCodeAt(0).toString(16).toUpperCase()}`)}function r7($){return $!==void 0&&$!==null}function pG($){return[!!$&&[";","?","&"].includes($),!!$&&["?","&"].includes($)?"=":""]}function G9($,X=!1){if(X)return!$||$==="+"?"":$;else if(!$||$==="+"||$==="#")return",";else if($==="?")return"&";else return $}function rI($){let X=$.isFirst,{op:J,varName:Z,varValue:Q,reserved:Y}=$,G=[],[K,B]=pG(J);if(Array.isArray(Q))for(let H of Q.filter(r7)){if(G.push(`${G9(J,X)}`),K&&Z)G.push(`${encodeURIComponent(Z)}`),H===""?G.push(B):G.push("=");G.push(N5(H,Y,J)),X=!1}else if(typeof Q==="object")for(let H of Object.keys(Q)){let z=Q[H];if(!r7(z))continue;if(G.push(`${G9(J,X)}`),H)G.push(`${encodeURIComponent(H)}`),K&&z===""?G.push(B):G.push("=");G.push(N5(z,Y,J)),X=!1}return G.join("")}function aI($){let{op:X,varName:J,varValue:Z,isFirst:Q,reserved:Y}=$,G=[],K=G9(X,Q),[B,H]=pG(X);if(B&&J){if(G.push(N5(J,Y,X)),Z===""){if(!H)G.push(H);return!G.join("")?void 0:`${K}${G.join("")}`}G.push("=")}let z=[];if(Array.isArray(Z))for(let V of Z.filter(r7))z.push(N5(V,Y,X));else if(typeof Z==="object")for(let V of Object.keys(Z)){if(!r7(Z[V]))continue;z.push(ID(V)),z.push(N5(Z[V],Y,X))}return G.push(z.join(",")),!G.join(",")?void 0:`${K}${G.join("")}`}function sI($){let{op:X,varName:J,modifier:Z,isFirst:Q,reserved:Y,varValue:G}=$;if(!r7(G))return;else if(["string","number","boolean"].includes(typeof G)){let K=G.toString(),[B,H]=pG(X),z=[G9(X,Q)];if(B&&J)z.push(J),K===""?z.push(H):z.push("=");if(Z&&Z!=="*")K=K.substring(0,parseInt(Z,10));return z.push(N5(K,Y,X)),z.join("")}else if(Z==="*")return rI($);else return aI($)}function y8($,X,J){return $.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,(Z,Q,Y)=>{if(!Q)return ED(Y);let G;if(["+","#",".","/",";","?","&"].includes(Q[0]))G=Q[0],Q=Q.slice(1);let K=Q.split(/,/g),B=[];for(let H of K){let z=/([^:\*]*)(?::(\d+)|(\*))?/.exec(H);if(!z||!z[1])continue;let V=sI({isFirst:B.length===0,op:G,varValue:X[z[1]],varName:z[1],modifier:z[2]||z[3],reserved:J===null||J===void 0?void 0:J.allowReserved});if(V)B.push(V)}return B.join("")})}function tI($,X,J={requestOptions:{}}){var Z,Q;let Y=y8("/secrets/restore{?api%2Dversion}",{"api%2Dversion":$.apiVersion},{allowReserved:(Z=J===null||J===void 0?void 0:J.requestOptions)===null||Z===void 0?void 0:Z.skipUrlEncoding});return $.path(Y).post(Object.assign(Object.assign({},w8(J)),{contentType:"application/json",headers:Object.assign({accept:"application/json"},(Q=J.requestOptions)===null||Q===void 0?void 0:Q.headers),body:CD(X)}))}async function eI($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return U5($.body)}async function RD($,X,J={requestOptions:{}}){let Z=await tI($,X,J);return eI(Z)}function $R($,X,J={requestOptions:{}}){var Z,Q;let Y=y8("/secrets/{secret-name}/backup{?api%2Dversion}",{"secret-name":X,"api%2Dversion":$.apiVersion},{allowReserved:(Z=J===null||J===void 0?void 0:J.requestOptions)===null||Z===void 0?void 0:Z.skipUrlEncoding});return $.path(Y).post(Object.assign(Object.assign({},w8(J)),{headers:Object.assign({accept:"application/json"},(Q=J.requestOptions)===null||Q===void 0?void 0:Q.headers)}))}async function XR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return _D($.body)}async function SD($,X,J={requestOptions:{}}){let Z=await $R($,X,J);return XR(Z)}function JR($,X,J={requestOptions:{}}){var Z,Q;let Y=y8("/deletedsecrets/{secret-name}/recover{?api%2Dversion}",{"secret-name":X,"api%2Dversion":$.apiVersion},{allowReserved:(Z=J===null||J===void 0?void 0:J.requestOptions)===null||Z===void 0?void 0:Z.skipUrlEncoding});return $.path(Y).post(Object.assign(Object.assign({},w8(J)),{headers:Object.assign({accept:"application/json"},(Q=J.requestOptions)===null||Q===void 0?void 0:Q.headers)}))}async function ZR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return U5($.body)}async function jD($,X,J={requestOptions:{}}){let Z=await JR($,X,J);return ZR(Z)}function QR($,X,J={requestOptions:{}}){var Z,Q;let Y=y8("/deletedsecrets/{secret-name}{?api%2Dversion}",{"secret-name":X,"api%2Dversion":$.apiVersion},{allowReserved:(Z=J===null||J===void 0?void 0:J.requestOptions)===null||Z===void 0?void 0:Z.skipUrlEncoding});return $.path(Y).delete(Object.assign(Object.assign({},w8(J)),{headers:Object.assign({accept:"application/json"},(Q=J.requestOptions)===null||Q===void 0?void 0:Q.headers)}))}async function YR($){if(!["204"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return}async function xD($,X,J={requestOptions:{}}){let Z=await QR($,X,J);return YR(Z)}function GR($,X,J={requestOptions:{}}){var Z,Q;let Y=y8("/deletedsecrets/{secret-name}{?api%2Dversion}",{"secret-name":X,"api%2Dversion":$.apiVersion},{allowReserved:(Z=J===null||J===void 0?void 0:J.requestOptions)===null||Z===void 0?void 0:Z.skipUrlEncoding});return $.path(Y).get(Object.assign(Object.assign({},w8(J)),{headers:Object.assign({accept:"application/json"},(Q=J.requestOptions)===null||Q===void 0?void 0:Q.headers)}))}async function KR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return cG($.body)}async function kD($,X,J={requestOptions:{}}){let Z=await GR($,X,J);return KR(Z)}function BR($,X={requestOptions:{}}){var J,Z;let Q=y8("/deletedsecrets{?api%2Dversion,maxresults}",{"api%2Dversion":$.apiVersion,maxresults:X===null||X===void 0?void 0:X.maxresults},{allowReserved:(J=X===null||X===void 0?void 0:X.requestOptions)===null||J===void 0?void 0:J.skipUrlEncoding});return $.path(Q).get(Object.assign(Object.assign({},w8(X)),{headers:Object.assign({accept:"application/json"},(Z=X.requestOptions)===null||Z===void 0?void 0:Z.headers)}))}async function WR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return PD($.body)}function vD($,X={requestOptions:{}}){return Y9($,()=>BR($,X),WR,["200"],{itemName:"value",nextLinkName:"nextLink"})}function HR($,X,J={requestOptions:{}}){var Z,Q;let Y=y8("/secrets/{secret-name}/versions{?api%2Dversion,maxresults}",{"secret-name":X,"api%2Dversion":$.apiVersion,maxresults:J===null||J===void 0?void 0:J.maxresults},{allowReserved:(Z=J===null||J===void 0?void 0:J.requestOptions)===null||Z===void 0?void 0:Z.skipUrlEncoding});return $.path(Y).get(Object.assign(Object.assign({},w8(J)),{headers:Object.assign({accept:"application/json"},(Q=J.requestOptions)===null||Q===void 0?void 0:Q.headers)}))}async function zR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return uG($.body)}function yD($,X,J={requestOptions:{}}){return Y9($,()=>HR($,X,J),zR,["200"],{itemName:"value",nextLinkName:"nextLink"})}function DR($,X={requestOptions:{}}){var J,Z;let Q=y8("/secrets{?api%2Dversion,maxresults}",{"api%2Dversion":$.apiVersion,maxresults:X===null||X===void 0?void 0:X.maxresults},{allowReserved:(J=X===null||X===void 0?void 0:X.requestOptions)===null||J===void 0?void 0:J.skipUrlEncoding});return $.path(Q).get(Object.assign(Object.assign({},w8(X)),{headers:Object.assign({accept:"application/json"},(Z=X.requestOptions)===null||Z===void 0?void 0:Z.headers)}))}async function VR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return uG($.body)}function bD($,X={requestOptions:{}}){return Y9($,()=>DR($,X),VR,["200"],{itemName:"value",nextLinkName:"nextLink"})}function UR($,X,J,Z={requestOptions:{}}){var Q,Y;let G=y8("/secrets/{secret-name}/{secret-version}{?api%2Dversion}",{"secret-name":X,"secret-version":J,"api%2Dversion":$.apiVersion},{allowReserved:(Q=Z===null||Z===void 0?void 0:Z.requestOptions)===null||Q===void 0?void 0:Q.skipUrlEncoding});return $.path(G).get(Object.assign(Object.assign({},w8(Z)),{headers:Object.assign({accept:"application/json"},(Y=Z.requestOptions)===null||Y===void 0?void 0:Y.headers)}))}async function NR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return U5($.body)}async function gD($,X,J,Z={requestOptions:{}}){let Q=await UR($,X,J,Z);return NR(Q)}function AR($,X,J,Z,Q={requestOptions:{}}){var Y,G;let K=y8("/secrets/{secret-name}/{secret-version}{?api%2Dversion}",{"secret-name":X,"secret-version":J,"api%2Dversion":$.apiVersion},{allowReserved:(Y=Q===null||Q===void 0?void 0:Q.requestOptions)===null||Y===void 0?void 0:Y.skipUrlEncoding});return $.path(K).patch(Object.assign(Object.assign({},w8(Q)),{contentType:"application/json",headers:Object.assign({accept:"application/json"},(G=Q.requestOptions)===null||G===void 0?void 0:G.headers),body:MD(Z)}))}async function OR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return U5($.body)}async function hD($,X,J,Z,Q={requestOptions:{}}){let Y=await AR($,X,J,Z,Q);return OR(Y)}function wR($,X,J={requestOptions:{}}){var Z,Q;let Y=y8("/secrets/{secret-name}{?api%2Dversion}",{"secret-name":X,"api%2Dversion":$.apiVersion},{allowReserved:(Z=J===null||J===void 0?void 0:J.requestOptions)===null||Z===void 0?void 0:Z.skipUrlEncoding});return $.path(Y).delete(Object.assign(Object.assign({},w8(J)),{headers:Object.assign({accept:"application/json"},(Q=J.requestOptions)===null||Q===void 0?void 0:Q.headers)}))}async function FR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return cG($.body)}async function mD($,X,J={requestOptions:{}}){let Z=await wR($,X,J);return FR(Z)}function TR($,X,J,Z={requestOptions:{}}){var Q,Y;let G=y8("/secrets/{secret-name}{?api%2Dversion}",{"secret-name":X,"api%2Dversion":$.apiVersion},{allowReserved:(Q=Z===null||Z===void 0?void 0:Z.requestOptions)===null||Q===void 0?void 0:Q.skipUrlEncoding});return $.path(G).put(Object.assign(Object.assign({},w8(Z)),{contentType:"application/json",headers:Object.assign({accept:"application/json"},(Y=Z.requestOptions)===null||Y===void 0?void 0:Y.headers),body:TD(J)}))}async function LR($){if(!["200"].includes($.status)){let J=t0($);throw J.details=v8($.body),J}return U5($.body)}async function dD($,X,J,Z={requestOptions:{}}){let Q=await TR($,X,J,Z);return LR(Q)}class nG{constructor($,X,J={}){var Z;let Q=(Z=J===null||J===void 0?void 0:J.userAgentOptions)===null||Z===void 0?void 0:Z.userAgentPrefix,Y=Q?`${Q} azsdk-js-client`:"azsdk-js-client";this._client=dG($,X,Object.assign(Object.assign({},J),{userAgentOptions:{userAgentPrefix:Y}})),this.pipeline=this._client.pipeline}restoreSecret($,X={requestOptions:{}}){return RD(this._client,$,X)}backupSecret($,X={requestOptions:{}}){return SD(this._client,$,X)}recoverDeletedSecret($,X={requestOptions:{}}){return jD(this._client,$,X)}purgeDeletedSecret($,X={requestOptions:{}}){return xD(this._client,$,X)}getDeletedSecret($,X={requestOptions:{}}){return kD(this._client,$,X)}getDeletedSecrets($={requestOptions:{}}){return vD(this._client,$)}getSecretVersions($,X={requestOptions:{}}){return yD(this._client,$,X)}getSecrets($={requestOptions:{}}){return bD(this._client,$)}getSecret($,X,J={requestOptions:{}}){return gD(this._client,$,X,J)}updateSecret($,X,J,Z={requestOptions:{}}){return hD(this._client,$,X,J,Z)}deleteSecret($,X={requestOptions:{}}){return mD(this._client,$,X)}setSecret($,X,J={requestOptions:{}}){return dD(this._client,$,X,J)}}var qR=["authorization","authorization_url","resource","scope","tenantId","claims","error"];function lG($){let X=/,? +/,J=$.split(X).reduce((Z,Q)=>{if(Q.match(/\w="/)){let[Y,...G]=Q.split("=");if(qR.includes(Y))return Object.assign(Object.assign({},Z),{[Y]:G.join("=").slice(1,-1)})}return Z},{});if(J.authorization)try{let Z=new URL(J.authorization).pathname.substring(1);if(Z)J.tenantId=Z}catch(Z){throw Error(`The challenge authorization URI '${J.authorization}' is invalid.`)}return J}var MR={forcedRefreshWindowInMs:1000,retryIntervalInMs:3000,refreshWindowInMs:120000};async function PR($,X,J){async function Z(){if(Date.now()<J)try{return await $()}catch(Y){return null}else{let Y=await $();if(Y===null)throw Error("Failed to refresh access token.");return Y}}let Q=await Z();while(Q===null)await a4(X),Q=await Z();return Q}function cD($,X){let J=null,Z=null,Q,Y=Object.assign(Object.assign({},MR),X),G={get isRefreshing(){return J!==null},get shouldRefresh(){var B;if(G.isRefreshing)return!1;if((Z===null||Z===void 0?void 0:Z.refreshAfterTimestamp)&&Z.refreshAfterTimestamp<Date.now())return!0;return((B=Z===null||Z===void 0?void 0:Z.expiresOnTimestamp)!==null&&B!==void 0?B:0)-Y.refreshWindowInMs<Date.now()},get mustRefresh(){return Z===null||Z.expiresOnTimestamp-Y.forcedRefreshWindowInMs<Date.now()}};function K(B,H){var z;if(!G.isRefreshing)J=PR(()=>$.getToken(B,H),Y.retryIntervalInMs,(z=Z===null||Z===void 0?void 0:Z.expiresOnTimestamp)!==null&&z!==void 0?z:Date.now()).then((N)=>{return J=null,Z=N,Q=H.tenantId,Z}).catch((N)=>{throw J=null,Z=null,Q=void 0,N});return J}return async(B,H)=>{let z=Boolean(H.claims),V=Q!==H.tenantId;if(z)Z=null;if(V||z||G.mustRefresh)return K(B,H);if(G.shouldRefresh)K(B,H);return Z}}var uD=j$("keyvault-common");function _R($,X){let J;try{J=new URL($)}catch(Q){throw Error(`The challenge contains invalid scope '${$}'`)}if(!new URL(X.url).hostname.endsWith(`.${J.hostname}`))throw Error(`The challenge resource '${J.hostname}' does not match the requested domain. Set disableChallengeResourceVerification to true in your client options to disable. See https://aka.ms/azsdk/blog/vault-uri for more information.`)}var CR="keyVaultAuthenticationPolicy";function fD($,X={}){let{disableChallengeResourceVerification:J}=X,Z={status:"none"},Q=cD($);function Y(z){return{abortSignal:z.abortSignal,requestOptions:{timeout:z.timeout>0?z.timeout:void 0},tracingOptions:z.tracingOptions}}async function G(z){let V=Y(z);switch(Z.status){case"none":Z={status:"started",originalBody:z.body},z.body=null;break;case"started":break;case"complete":{let N=await Q(Z.scopes,Object.assign(Object.assign({},V),{enableCae:!0,tenantId:Z.tenantId}));if(N)z.headers.set("authorization",`Bearer ${N.token}`);break}}}async function K(z,V,N){if(V.status!==401)return V;if(z.body===null&&Z.status==="started")z.body=Z.originalBody;let A=Y(z),F=V.headers.get("WWW-Authenticate");if(!F)return uD.warning("keyVaultAuthentication policy encountered a 401 response without a corresponding WWW-Authenticate header. This is unexpected. Not handling the 401 response."),V;let E=lG(F),d=E.resource?E.resource+"/.default":E.scope;if(!d)return V;if(!J)_R(d,z);let n=await Q([d],Object.assign(Object.assign({},A),{enableCae:!0,tenantId:E.tenantId}));if(!n)return V;return z.headers.set("Authorization",`Bearer ${n.token}`),Z={status:"complete",scopes:[d],tenantId:E.tenantId},N(z)}async function B(z,V,N){if(Z.status!=="complete")return V;if(V.status!==401)return V;let A=Y(z),F=V.headers.get("WWW-Authenticate");if(!F)return V;let{claims:E,error:d}=lG(F);if(d!=="insufficient_claims"||E===void 0)return V;let n=atob(E),K0=await Q(Z.scopes,Object.assign(Object.assign({},A),{enableCae:!0,tenantId:Z.tenantId,claims:n}));return z.headers.set("Authorization",`Bearer ${K0.token}`),N(z)}async function H(z,V){await G(z);let N=await V(z);return N=await K(z,N,V),N=await B(z,N,V),N}return{name:CR,sendRequest:H}}function pD($,X){if(typeof $!=="string"||!($=$.trim()))throw Error("Invalid collection argument");if(typeof X!=="string"||!(X=X.trim()))throw Error("Invalid identifier argument");let J;try{J=new URL(X)}catch(K){throw Error(`Invalid ${$} identifier: ${X}. Not a valid URI`)}let Z=(J.pathname||"").split("/");if(Z.length!==3&&Z.length!==4)throw Error(`Invalid ${$} identifier: ${X}. Bad number of segments: ${Z.length}`);if($!==Z[1])throw Error(`Invalid ${$} identifier: ${X}. segment [1] should be "${$}", found "${Z[1]}"`);let Q=`${J.protocol}//${J.host}`,Y=Z[2],G=Z.length===4?Z[3]:void 0;return{vaultUrl:Q,name:Y,version:G}}var nD="7.6";function lD($){let J=$.split("/")[3];return Object.assign({sourceId:$},pD(J,$))}function K8($){let X=$,J=$,Z=lD(X.id),Q=X.attributes;delete X.attributes;let Y={value:X.value,name:Z.name,properties:{expiresOn:Q===null||Q===void 0?void 0:Q.expires,createdOn:Q===null||Q===void 0?void 0:Q.created,updatedOn:Q===null||Q===void 0?void 0:Q.updated,enabled:Q===null||Q===void 0?void 0:Q.enabled,notBefore:Q===null||Q===void 0?void 0:Q.notBefore,recoverableDays:Q===null||Q===void 0?void 0:Q.recoverableDays,recoveryLevel:Q===null||Q===void 0?void 0:Q.recoveryLevel,id:X.id,contentType:X.contentType,tags:X.tags,managed:X.managed,vaultUrl:Z.vaultUrl,version:Z.version,name:Z.name,certificateKeyId:X.kid}};if(J.recoveryId)Y.properties.recoveryId=J.recoveryId,Y.properties.scheduledPurgeDate=J.scheduledPurgeDate,Y.properties.deletedOn=J.deletedDate,Y.recoveryId=J.recoveryId,Y.scheduledPurgeDate=J.scheduledPurgeDate,Y.deletedOn=J.deletedDate;if(Q){if(Q.vaultUrl)delete Y.properties.vaultUrl;if(Q.expires)delete Y.properties.expires;if(Q.created)delete Y.properties.created;if(Q.updated)delete Y.properties.updated}return Y}function K9($,X,J){let Z=void 0;return{async next(){Z!==null&&Z!==void 0||(Z=$(Object.assign(Object.assign({},X),{maxresults:void 0})));let Q=await Z.next();return Object.assign(Object.assign({},Q),{value:Q.value&&J(Q.value)})},[Symbol.asyncIterator](){return this},byPage(Q){return I7(this,arguments,function*(){var G,K,B,H;let z=$(Object.assign(Object.assign({},X),{maxresults:Q===null||Q===void 0?void 0:Q.maxPageSize})).byPage(Q);try{for(var V=!0,N=R7(z),A;A=yield b0(N.next()),G=A.done,!G;V=!0)H=A.value,V=!1,yield yield b0(H.map(J))}catch(F){K={error:F}}finally{try{if(!V&&!G&&(B=N.return))yield b0(B.call(N))}finally{if(K)throw K.error}}})}}}var B9="4.10.0";var F8=s4({namespace:"Microsoft.KeyVault",packageName:"@azure/keyvault-secrets",packageVersion:B9});class oG extends Error{constructor($){super($);this.name="PollerStoppedError",Object.setPrototypeOf(this,oG.prototype)}}class iG extends Error{constructor($){super($);this.name="PollerCancelledError",Object.setPrototypeOf(this,iG.prototype)}}class rG{constructor($){this.resolveOnUnsuccessful=!1,this.stopped=!0,this.pollProgressCallbacks=[],this.operation=$,this.promise=new Promise((X,J)=>{this.resolve=X,this.reject=J}),this.promise.catch(()=>{})}async startPolling($={}){if(this.stopped)this.stopped=!1;while(!this.isStopped()&&!this.isDone())await this.poll($),await this.delay()}async pollOnce($={}){if(!this.isDone())this.operation=await this.operation.update({abortSignal:$.abortSignal,fireProgress:this.fireProgress.bind(this)});this.processUpdatedState()}fireProgress($){for(let X of this.pollProgressCallbacks)X($)}async cancelOnce($={}){this.operation=await this.operation.cancel($)}poll($={}){if(!this.pollOncePromise){this.pollOncePromise=this.pollOnce($);let X=()=>{this.pollOncePromise=void 0};this.pollOncePromise.then(X,X).catch(this.reject)}return this.pollOncePromise}processUpdatedState(){if(this.operation.state.error){if(this.stopped=!0,!this.resolveOnUnsuccessful)throw this.reject(this.operation.state.error),this.operation.state.error}if(this.operation.state.isCancelled){if(this.stopped=!0,!this.resolveOnUnsuccessful){let $=new iG("Operation was canceled");throw this.reject($),$}}if(this.isDone()&&this.resolve)this.resolve(this.getResult())}async pollUntilDone($={}){if(this.stopped)this.startPolling($).catch(this.reject);return this.processUpdatedState(),this.promise}onProgress($){return this.pollProgressCallbacks.push($),()=>{this.pollProgressCallbacks=this.pollProgressCallbacks.filter((X)=>X!==$)}}isDone(){let $=this.operation.state;return Boolean($.isCompleted||$.isCancelled||$.error)}stopPolling(){if(!this.stopped){if(this.stopped=!0,this.reject)this.reject(new oG("This poller is already stopped"))}}isStopped(){return this.stopped}cancelOperation($={}){if(!this.cancelPromise)this.cancelPromise=this.cancelOnce($);else if($.abortSignal)throw Error("A cancel request is currently pending");return this.cancelPromise}getOperationState(){return this.operation.state}getResult(){return this.operation.state.result}toString(){return this.operation.toString()}}class a7 extends rG{constructor(){super(...arguments);this.intervalInMs=2000}async delay(){return a4(this.intervalInMs)}}class s7{constructor($,X={}){if(this.state=$,this.cancelMessage="",X.cancelMessage)this.cancelMessage=X.cancelMessage}async update(){throw Error("Operation not supported.")}async cancel(){throw Error(this.cancelMessage)}toString(){return JSON.stringify({state:this.state})}}class aG extends s7{constructor($,X,J={}){super($,{cancelMessage:"Canceling the deletion of a secret is not supported."});this.state=$,this.client=X,this.operationOptions=J}deleteSecret($,X={}){return F8.withSpan("DeleteSecretPoller.deleteSecret",X,async(J)=>{let Z=await this.client.deleteSecret($,J);return K8(Z)})}getDeletedSecret($,X={}){return F8.withSpan("DeleteSecretPoller.getDeletedSecret",X,async(J)=>{let Z=await this.client.getDeletedSecret($,J);return K8(Z)})}async update($={}){let X=this.state,{name:J}=X;if($.abortSignal)this.operationOptions.abortSignal=$.abortSignal;if(!X.isStarted){let Z=await this.deleteSecret(J,this.operationOptions);if(X.isStarted=!0,X.result=Z,!Z.properties.recoveryId)X.isCompleted=!0}if(!X.isCompleted)try{X.result=await this.getDeletedSecret(J,this.operationOptions),X.isCompleted=!0}catch(Z){if(Z.statusCode===403)X.isCompleted=!0;else if(Z.statusCode!==404)throw X.error=Z,X.isCompleted=!0,Z}return this}}class sG extends a7{constructor($){let{client:X,name:J,operationOptions:Z,intervalInMs:Q=2000,resumeFrom:Y}=$,G;if(Y)G=JSON.parse(Y).state;let K=new aG(Object.assign(Object.assign({},G),{name:J}),X,Z);super(K);this.intervalInMs=Q}}class tG extends s7{constructor($,X,J={}){super($,{cancelMessage:"Canceling the recovery of a deleted secret is not supported."});this.state=$,this.client=X,this.options=J}getSecret($,X={}){return F8.withSpan("RecoverDeletedSecretPoller.getSecret",X,async(J)=>{let Z=await this.client.getSecret($,X&&X.version?X.version:"",J);return K8(Z)})}recoverDeletedSecret($,X={}){return F8.withSpan("RecoverDeletedSecretPoller.recoverDeletedSecret",X,async(J)=>{let Z=await this.client.recoverDeletedSecret($,J);return K8(Z)})}async update($={}){let X=this.state,{name:J}=X;if($.abortSignal)this.options.abortSignal=$.abortSignal;if(!X.isStarted){try{X.result=(await this.getSecret(J,this.options)).properties,X.isCompleted=!0}catch(Z){}if(!X.isCompleted)X.result=(await this.recoverDeletedSecret(J,this.options)).properties,X.isStarted=!0}if(!X.isCompleted)try{X.result=(await this.getSecret(J,this.options)).properties,X.isCompleted=!0}catch(Z){if(Z.statusCode===403)X.isCompleted=!0;else if(Z.statusCode!==404)throw X.error=Z,X.isCompleted=!0,Z}return this}}class eG extends a7{constructor($){let{client:X,name:J,operationOptions:Z,intervalInMs:Q=2000,resumeFrom:Y}=$,G;if(Y)G=JSON.parse(Y).state;let K=new tG(Object.assign(Object.assign({},G),{name:J}),X,Z);super(K);this.intervalInMs=Q}}class $3{constructor($,X,J={}){var Z,Q;this.vaultUrl=$;let Y=Object.assign(Object.assign({},J),{userAgentOptions:{userAgentPrefix:`${(Q=(Z=J.userAgentOptions)===null||Z===void 0?void 0:Z.userAgentPrefix)!==null&&Q!==void 0?Q:""} azsdk-js-keyvault-secrets/${B9}`},apiVersion:J.serviceVersion||nD,loggingOptions:{logger:vH.info,additionalAllowedHeaderNames:["x-ms-keyvault-region","x-ms-keyvault-network-info","x-ms-keyvault-service-version"]}});this.client=new nG(this.vaultUrl,X,Y),this.client.pipeline.removePolicy({name:Z9}),this.client.pipeline.addPolicy(fD(X,J),{}),this.client.pipeline.addPolicy({name:"ContentTypePolicy",sendRequest(G,K){var B;if(((B=G.headers.get("Content-Type"))!==null&&B!==void 0?B:"").startsWith("application/json"))G.headers.set("Content-Type","application/json");return K(G)}})}setSecret($,X,J={}){let{enabled:Z,notBefore:Q,expiresOn:Y,tags:G}=J,K=E7(J,["enabled","notBefore","expiresOn","tags"]);return F8.withSpan("SecretClient.setSecret",K,async(B)=>{let H=await this.client.setSecret($,{value:X,secretAttributes:{enabled:Z,notBefore:Q,expires:Y},tags:G},B);return K8(H)})}async beginDeleteSecret($,X={}){let J=new sG(Object.assign(Object.assign({name:$,client:this.client},X),{operationOptions:X}));return await J.poll(),J}async updateSecretProperties($,X,J={}){let{enabled:Z,notBefore:Q,expiresOn:Y,tags:G}=J,K=E7(J,["enabled","notBefore","expiresOn","tags"]);return F8.withSpan("SecretClient.updateSecretProperties",K,async(B)=>{let H=await this.client.updateSecret($,X,{secretAttributes:{enabled:Z,notBefore:Q,expires:Y},tags:G},B);return K8(H).properties})}getSecret($,X={}){return F8.withSpan("SecretClient.getSecret",X,async(J)=>{let Z=await this.client.getSecret($,X&&X.version?X.version:"",J);return K8(Z)})}getDeletedSecret($,X={}){return F8.withSpan("SecretClient.getDeletedSecret",X,async(J)=>{let Z=await this.client.getDeletedSecret($,J);return K8(Z)})}purgeDeletedSecret($,X={}){return F8.withSpan("SecretClient.purgeDeletedSecret",X,async(J)=>{await this.client.purgeDeletedSecret($,J)})}async beginRecoverDeletedSecret($,X={}){let J=new eG(Object.assign(Object.assign({name:$,client:this.client},X),{operationOptions:X}));return await J.poll(),J}backupSecret($,X={}){return F8.withSpan("SecretClient.backupSecret",X,async(J)=>{return(await this.client.backupSecret($,J)).value})}restoreSecretBackup($,X={}){return F8.withSpan("SecretClient.restoreSecretBackup",X,async(J)=>{let Z=await this.client.restoreSecret({secretBundleBackup:$},J);return K8(Z).properties})}listPropertiesOfSecretVersions($,X={}){return K9((J)=>this.client.getSecretVersions($,J),X,(J)=>K8(J).properties)}listPropertiesOfSecrets($={}){return K9(this.client.getSecrets.bind(this.client),$,(X)=>K8(X).properties)}listDeletedSecrets($={}){return K9(this.client.getDeletedSecrets.bind(this.client),$,K8)}}var iD=j$("identity");function rD($){return`SUCCESS. Scopes: ${Array.isArray($)?$.join(", "):$}.`}function A5($,X){let J="ERROR.";if($?.length)J+=` Scopes: ${Array.isArray($)?$.join(", "):$}.`;return`${J} Error message: ${typeof X==="string"?X:X.message}.`}function oD($,X,J=iD){let Z=X?`${X.fullTitle} ${$}`:$;function Q(B){J.info(`${Z} =>`,B)}function Y(B){J.warning(`${Z} =>`,B)}function G(B){J.verbose(`${Z} =>`,B)}function K(B){J.error(`${Z} =>`,B)}return{title:$,fullTitle:Z,info:Q,warning:Y,verbose:G,error:K}}function W9($,X=iD){let J=oD($,void 0,X);return{...J,parent:X,getToken:oD("=> getToken()",J,X)}}var ER="CredentialUnavailableError";class X3 extends Error{constructor($,X){super($,X);this.name=ER}}var IR="AggregateAuthenticationError";class J3 extends Error{errors;constructor($,X){let J=$.join(`
`);super(`${X}
${J}`);this.errors=$,this.name=IR}}var aD="4.13.0";var Z3;(function($){$.AzureChina="https://login.chinacloudapi.cn",$.AzureGermany="https://login.microsoftonline.de",$.AzureGovernment="https://login.microsoftonline.us",$.AzurePublicCloud="https://login.microsoftonline.com"})(Z3||(Z3={}));var lt=Z3.AzurePublicCloud;var sD=s4({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:aD});var Q3=W9("ChainedTokenCredential");class Y3{_sources=[];constructor(...$){this._sources=$}async getToken($,X={}){let{token:J}=await this.getTokenInternal($,X);return J}async getTokenInternal($,X={}){let J=null,Z,Q=[];return sD.withSpan("ChainedTokenCredential.getToken",X,async(Y)=>{for(let G=0;G<this._sources.length&&J===null;G++)try{J=await this._sources[G].getToken($,Y),Z=this._sources[G]}catch(K){if(K.name==="CredentialUnavailableError"||K.name==="AuthenticationRequiredError")Q.push(K);else throw Q3.getToken.info(A5($,K)),K}if(!J&&Q.length>0){let G=new J3(Q,"ChainedTokenCredential authentication failed.");throw Q3.getToken.info(A5($,G)),G}if(Q3.getToken.info(`Result for ${Z.constructor.name}: ${rD($)}`),J===null)throw new X3("Failed to retrieve a valid token");return{token:J,successfulCredential:Z}})}}var H9=Error("DefaultAzureCredential is not supported in the browser. Use InteractiveBrowserCredential instead."),tD=W9("DefaultAzureCredential");class z9 extends Y3{constructor($){super();throw tD.info(A5("",H9)),H9}getToken(){throw tD.getToken.info(A5("",H9)),H9}}var G3=($)=>typeof $==="function",W=function($,X){if(typeof $==="function")return function(){if($(arguments))return X.apply(this,arguments);return(J)=>X(J,...arguments)};switch($){case 0:case 1:throw RangeError(`Invalid arity ${$}`);case 2:return function(J,Z){if(arguments.length>=2)return X(J,Z);return function(Q){return X(Q,J)}};case 3:return function(J,Z,Q){if(arguments.length>=3)return X(J,Z,Q);return function(Y){return X(Y,J,Z)}};case 4:return function(J,Z,Q,Y){if(arguments.length>=4)return X(J,Z,Q,Y);return function(G){return X(G,J,Z,Q)}};case 5:return function(J,Z,Q,Y,G){if(arguments.length>=5)return X(J,Z,Q,Y,G);return function(K){return X(K,J,Z,Q,Y)}};default:return function(){if(arguments.length>=$)return X.apply(this,arguments);let J=arguments;return function(Z){return X(Z,...J)}}}};var y=($)=>$;var t7=($)=>()=>$,b8=t7(!0),T8=t7(!1);var D9=t7(void 0),x$=D9;function D($,X,J,Z,Q,Y,G,K,B){switch(arguments.length){case 1:return $;case 2:return X($);case 3:return J(X($));case 4:return Z(J(X($)));case 5:return Q(Z(J(X($))));case 6:return Y(Q(Z(J(X($)))));case 7:return G(Y(Q(Z(J(X($))))));case 8:return K(G(Y(Q(Z(J(X($)))))));case 9:return B(K(G(Y(Q(Z(J(X($))))))));default:{let H=arguments[0];for(let z=1;z<arguments.length;z++)H=arguments[z](H);return H}}}var V9=($)=>(X,J)=>X===J||$(X,J);var eD=W(2,($,X)=>V9((J,Z)=>$(X(J),X(Z))));var $V=($)=>V9((X,J)=>{if(X.length!==J.length)return!1;for(let Z=0;Z<X.length;Z++)if(!$(X[Z],J[Z]))return!1;return!0});var XV=($)=>W(3,(X,J,Z)=>$(X,(Q)=>({...Q,[J]:Z(Q)}))),JV=($)=>W(2,(X,J)=>$(X,(Z)=>({[J]:Z}))),ZV=($,X)=>W(3,(J,Z,Q)=>X(J,(Y)=>$(Q(Y),(G)=>({...Y,[Z]:G}))));var e7,j=($,X)=>{if(!e7)globalThis["effect/GlobalValue"]??=new Map,e7=globalThis["effect/GlobalValue"];if(!e7.has($))e7.set($,X());return e7.get($)};var t4=($)=>typeof $==="string",e4=($)=>typeof $==="number",QV=($)=>typeof $==="boolean",N9=($)=>typeof $==="bigint",YV=($)=>typeof $==="symbol";var w$=G3;var jR=($)=>typeof $==="object"&&$!==null,N6=($)=>jR($)||w$($),P=W(2,($,X)=>N6($)&&(X in $)),k$=W(2,($,X)=>P($,"_tag")&&$._tag===X),$X=($)=>$===null||$===void 0,GV=($)=>$!==null&&$!==void 0;var KV=($)=>$ instanceof Date,e8=($)=>typeof $==="string"||P($,Symbol.iterator);var K3=($)=>P($,"then")&&w$($.then);var JX=($)=>`BUG: ${$} - please report an issue at https://github.com/Effect-TS/effect/issues`;class O5{self;called=!1;constructor($){this.self=$}next($){return this.called?{value:$,done:!0}:(this.called=!0,{value:this.self,done:!1})}return($){return{value:$,done:!0}}throw($){throw $}[Symbol.iterator](){return new O5(this.self)}}var xR=335903614,kR=4150755663,vR=1481765933,yR=1284865837,bR=9007199254740992,gR=134217728;class W3{_state;constructor($,X,J,Z){if($X(X)&&$X($))X=Math.random()*4294967295>>>0,$=0;else if($X(X))X=$,$=0;if($X(Z)&&$X(J))Z=this._state?this._state[3]:kR,J=this._state?this._state[2]:xR;else if($X(Z))Z=J,J=0;return this._state=new Int32Array([0,0,J>>>0,((Z||0)|1)>>>0]),this._next(),BV(this._state,this._state[0],this._state[1],$>>>0,X>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState($){this._state[0]=$[0],this._state[1]=$[1],this._state[2]=$[2],this._state[3]=$[3]|1}integer($){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%$}number(){let $=(this._next()&67108863)*1,X=(this._next()&134217727)*1;return($*gR+X)/bR}_next(){let $=this._state[0]>>>0,X=this._state[1]>>>0;hR(this._state,$,X,vR,yR),BV(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let J=$>>>18,Z=(X>>>18|$<<14)>>>0;J=(J^$)>>>0,Z=(Z^X)>>>0;let Q=(Z>>>27|J<<5)>>>0,Y=$>>>27,G=(-Y>>>0&31)>>>0;return(Q>>>Y|Q<<G)>>>0}}function hR($,X,J,Z,Q){let Y=(J>>>16)*(Q&65535)>>>0,G=(J&65535)*(Q>>>16)>>>0,K=(J&65535)*(Q&65535)>>>0,B=(J>>>16)*(Q>>>16)+((G>>>16)+(Y>>>16))>>>0;if(G=G<<16>>>0,K=K+G>>>0,K>>>0<G>>>0)B=B+1>>>0;if(Y=Y<<16>>>0,K=K+Y>>>0,K>>>0<Y>>>0)B=B+1>>>0;B=B+Math.imul(J,Z)>>>0,B=B+Math.imul(X,Q)>>>0,$[0]=B,$[1]=K}function BV($,X,J,Z,Q){let Y=X+Z>>>0,G=J+Q>>>0;if(G>>>0<J>>>0)Y=Y+1|0;$[0]=Y,$[1]=G}var B3=Symbol.for("effect/Utils/YieldWrap");class A6{#$;constructor($){this.#$=$}[B3](){return this.#$}}function H3($){if(typeof $==="object"&&$!==null&&B3 in $)return $[B3]();throw Error(JX("yieldWrapGet"))}var L8=j("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0}));var WV={effect_internal_function:($)=>{return $()}},mR={effect_internal_function:($)=>{try{return $()}finally{}}},dR=WV.effect_internal_function(()=>Error().stack)?.includes("effect_internal_function")===!0,D0=dR?WV.effect_internal_function:mR.effect_internal_function,cR=function*(){}.constructor,HV=($)=>N6($)&&$.constructor===cR;var z3=j(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),R=Symbol.for("effect/Hash"),_=($)=>{if(L8.enabled===!0)return 0;switch(typeof $){case"number":return O9($);case"bigint":return s($.toString(10));case"boolean":return s(String($));case"symbol":return s(String($));case"string":return s($);case"undefined":return s("undefined");case"function":case"object":if($===null)return s("null");else if($ instanceof Date){if(Number.isNaN($.getTime()))return s("Invalid Date");return _($.toISOString())}else if($ instanceof URL)return _($.href);else if(uR($))return $[R]();else return $J($);default:throw Error(`BUG: unhandled typeof ${typeof $} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},$J=($)=>{if(!z3.has($))z3.set($,O9(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)));return z3.get($)},x=($)=>(X)=>X*53^$,A9=($)=>$&3221225471|$>>>1&1073741824,uR=($)=>P($,R),O9=($)=>{if($!==$||$===1/0)return 0;let X=$|0;if(X!==$)X^=$*4294967295;while($>4294967295)X^=$/=4294967295;return A9(X)},s=($)=>{let X=5381,J=$.length;while(J)X=X*33^$.charCodeAt(--J);return A9(X)},fR=($,X)=>{let J=12289;for(let Z=0;Z<X.length;Z++)J^=D(s(X[Z]),x(_($[X[Z]])));return A9(J)},w9=($)=>fR($,Object.keys($)),g8=($)=>{let X=6151;for(let J=0;J<$.length;J++)X=D(X,x(_($[J])));return A9(X)},b=function(){if(arguments.length===1){let J=arguments[0];return function(Z){return Object.defineProperty(J,R,{value(){return Z},enumerable:!1}),Z}}let $=arguments[0],X=arguments[1];return Object.defineProperty($,R,{value(){return X},enumerable:!1}),X};var I=Symbol.for("effect/Equal");function C(){if(arguments.length===1)return($)=>F9($,arguments[0]);return F9(arguments[0],arguments[1])}function F9($,X){if($===X)return!0;let J=typeof $;if(J!==typeof X)return!1;if(J==="object"||J==="function"){if($!==null&&X!==null){if(w5($)&&w5(X))if(_($)===_(X)&&$[I](X))return!0;else return L8.enabled&&L8.tester?L8.tester($,X):!1;else if($ instanceof Date&&X instanceof Date){let Z=$.getTime(),Q=X.getTime();return Z===Q||Number.isNaN(Z)&&Number.isNaN(Q)}else if($ instanceof URL&&X instanceof URL)return $.href===X.href}if(L8.enabled){if(Array.isArray($)&&Array.isArray(X))return $.length===X.length&&$.every((Z,Q)=>F9(Z,X[Q]));if(Object.getPrototypeOf($)===Object.prototype&&Object.getPrototypeOf(X)===Object.prototype){let Z=Object.keys($),Q=Object.keys(X);if(Z.length===Q.length){for(let Y of Z)if(!((Y in X)&&F9($[Y],X[Y])))return L8.tester?L8.tester($,X):!1;return!0}}return L8.tester?L8.tester($,X):!1}}return L8.enabled&&L8.tester?L8.tester($,X):!1}var w5=($)=>P($,I),XJ=()=>C;var g=Symbol.for("nodejs.util.inspect.custom"),u=($)=>{try{if(P($,"toJSON")&&w$($.toJSON)&&$.toJSON.length===0)return $.toJSON();else if(Array.isArray($))return $.map(u)}catch{return{}}return NV($)},D3="[Circular]";function pR($){try{return $.toISOString()}catch{return"Invalid Date"}}function nR($){try{let X=$.toString();return typeof X==="string"?X:String(X)}catch{return"[toString threw]"}}function DV($){return t4($)?JSON.stringify($):String($)}function v$($,X){let J=X?.space??0,Z=new WeakSet,Q=!J?"":e4(J)?" ".repeat(J):J,Y=(H)=>Q.repeat(H),G=(H,z)=>{let V=H?.constructor;return V&&V!==Object.prototype.constructor&&V.name?`${V.name}(${z})`:z},K=(H)=>{try{return Reflect.ownKeys(H)}catch{return["[ownKeys threw]"]}};function B(H,z=0){if(Array.isArray(H)){if(Z.has(H))return D3;if(Z.add(H),!Q||H.length<=1)return`[${H.map((N)=>B(N,z)).join(",")}]`;let V=H.map((N)=>B(N,z+1)).join(`,
`+Y(z+1));return`[
${Y(z+1)}${V}
${Y(z)}]`}if(KV(H))return pR(H);if(!X?.ignoreToString&&P(H,"toString")&&w$(H.toString)&&H.toString!==Object.prototype.toString&&H.toString!==Array.prototype.toString){let V=nR(H);if(H instanceof Error&&H.cause)return`${V} (cause: ${B(H.cause,z)})`;return V}if(t4(H))return JSON.stringify(H);if(e4(H)||H==null||QV(H)||YV(H))return String(H);if(N9(H))return String(H)+"n";if(H instanceof Set||H instanceof Map){if(Z.has(H))return D3;return Z.add(H),`${H.constructor.name}(${B(Array.from(H),z)})`}if(N6(H)){if(Z.has(H))return D3;Z.add(H);let V=K(H);if(!Q||V.length<=1){let A=`{${V.map((F)=>`${DV(F)}:${B(H[F],z)}`).join(",")}}`;return G(H,A)}let N=`{
${V.map((A)=>`${Y(z+1)}${DV(A)}: ${B(H[A],z+1)}`).join(`,
`)}
${Y(z)}}`;return G(H,N)}return String(H)}return B($,0)}var l=($)=>JSON.stringify($,null,2),Le={toJSON(){return u(this)},[g](){return this.toJSON()},toString(){return l(this.toJSON())}};var O6=($,X=2)=>{if(typeof $==="string")return $;try{return typeof $==="object"?T9($,X):String($)}catch{return String($)}},T9=($,X)=>{let J=[],Z=JSON.stringify($,(Q,Y)=>typeof Y==="object"&&Y!==null?J.includes(Y)?void 0:J.push(Y)&&(ZX.fiberRefs!==void 0&&VV(Y)?Y[V3](ZX.fiberRefs):Y):Y,X);return J=void 0,Z},V3=Symbol.for("effect/Inspectable/Redactable"),VV=($)=>typeof $==="object"&&$!==null&&(V3 in $),ZX=j("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),UV=($,X)=>{let J=ZX.fiberRefs;ZX.fiberRefs=$;try{return X()}finally{ZX.fiberRefs=J}},NV=($)=>{if(VV($)&&ZX.fiberRefs!==void 0)return $[V3](ZX.fiberRefs);return $};var M=($,X)=>{switch(X.length){case 0:return $;case 1:return X[0]($);case 2:return X[1](X[0]($));case 3:return X[2](X[1](X[0]($)));case 4:return X[3](X[2](X[1](X[0]($))));case 5:return X[4](X[3](X[2](X[1](X[0]($)))));case 6:return X[5](X[4](X[3](X[2](X[1](X[0]($))))));case 7:return X[6](X[5](X[4](X[3](X[2](X[1](X[0]($)))))));case 8:return X[7](X[6](X[5](X[4](X[3](X[2](X[1](X[0]($))))))));case 9:return X[8](X[7](X[6](X[5](X[4](X[3](X[2](X[1](X[0]($)))))))));default:{let J=$;for(let Z=0,Q=X.length;Z<Q;Z++)J=X[Z](J);return J}}};var QX="Async",YX="Commit",A0="Failure",F5="OnFailure",T5="OnSuccess",L5="OnSuccessAndFailure",O0="Success",q9="Sync",AV="Tag",w6="UpdateRuntimeFlags",q5="While",GX="Iterator",M9="WithRuntime",M5="Yield",JJ="RevertFlags";var oR="3.19.16",QJ=()=>oR;var wV=Symbol.for("effect/Effect"),FV=Symbol.for("effect/Stream"),TV=Symbol.for("effect/Sink"),LV=Symbol.for("effect/Channel"),W4={_R:($)=>$,_E:($)=>$,_A:($)=>$,_V:QJ()},iR={_A:($)=>$,_In:($)=>$,_L:($)=>$,_E:($)=>$,_R:($)=>$},rR={_Env:($)=>$,_InErr:($)=>$,_InElem:($)=>$,_InDone:($)=>$,_OutErr:($)=>$,_OutElem:($)=>$,_OutDone:($)=>$},F6={[wV]:W4,[FV]:W4,[TV]:iR,[LV]:rR,[I]($){return this===$},[R](){return b(this,$J(this))},[Symbol.iterator](){return new O5(new A6(this))},pipe(){return M(this,arguments)}},y$={[R](){return b(this,w9(this))},[I]($){let X=Object.keys(this),J=Object.keys($);if(X.length!==J.length)return!1;for(let Z of X)if(!((Z in $)&&C(this[Z],$[Z])))return!1;return!0}},F$={...F6,_op:YX},U3={...F$,...y$},qV=function(){function $(){}return $.prototype=F$,$}();var MV=Symbol.for("effect/Option"),PV={...F6,[MV]:{_A:($)=>$},[g](){return this.toJSON()},toString(){return l(this.toJSON())}},aR=Object.assign(Object.create(PV),{_tag:"Some",_op:"Some",[I]($){return A3($)&&O3($)&&C(this.value,$.value)},[R](){return b(this,x(_(this._tag))(_(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:u(this.value)}}}),sR=_("None"),tR=Object.assign(Object.create(PV),{_tag:"None",_op:"None",[I]($){return A3($)&&H4($)},[R](){return sR},toJSON(){return{_id:"Option",_tag:this._tag}}}),A3=($)=>P($,MV),H4=($)=>$._tag==="None",O3=($)=>$._tag==="Some",YJ=Object.create(tR),T6=($)=>{let X=Object.create(aR);return X.value=$,X};var w3=Symbol.for("effect/Either"),_V={...F6,[w3]:{_R:($)=>$},[g](){return this.toJSON()},toString(){return l(this.toJSON())}},eR=Object.assign(Object.create(_V),{_tag:"Right",_op:"Right",[I]($){return F3($)&&L3($)&&C(this.right,$.right)},[R](){return x(_(this._tag))(_(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:u(this.right)}}}),$S=Object.assign(Object.create(_V),{_tag:"Left",_op:"Left",[I]($){return F3($)&&T3($)&&C(this.left,$.left)},[R](){return x(_(this._tag))(_(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:u(this.left)}}}),F3=($)=>P($,w3),T3=($)=>$._tag==="Left",L3=($)=>$._tag==="Right",q3=($)=>{let X=Object.create($S);return X.left=$,X},M3=($)=>{let X=Object.create(eR);return X.right=$,X};var CV=W(2,($,X)=>H4($)?q3(X()):M3($.value));var f=M3;var $0=q3;var EV=CV,IV=($)=>{if(w$($))try{return f($())}catch(X){return $0(X)}else try{return f($.try())}catch(X){return $0($.catch(X))}};var B8=T3,b$=L3;var RV=W(2,($,X)=>B8($)?$0(X($.left)):f($.right));var ZS=W(2,($,{onLeft:X,onRight:J})=>B8($)?X($.left):J($.right)),SV=W(3,($,X,J)=>X($)?f($):$0(J($)));var _9=ZS({onLeft:y,onRight:y});var P3=($)=>$.length>0;var jV=($)=>(X,J)=>X===J?0:$(X,J);var xV=jV(($,X)=>$<X?-1:1);var kV=W(2,($,X)=>jV((J,Z)=>$(X(J),X(Z))));var _3=($)=>W(2,(X,J)=>$(X,J)===1);var T=()=>YJ,q=T6;var J0=H4,w0=O3,C0=W(2,($,{onNone:X,onSome:J})=>J0($)?X():J($.value));var S0=W(2,($,X)=>J0($)?X():$.value);var vV=W(2,($,X)=>J0($)?q(X()):$);var z4=($)=>$==null?T():q($);var e0=S0(D9),yV=($)=>(...X)=>{try{return q($(...X))}catch{return T()}},YS=W(2,($,X)=>{if(w0($))return $.value;throw X()}),bV=YS(()=>Error("getOrThrow called on a None")),h$=W(2,($,X)=>J0($)?T():q(X($.value)));var KX=W(2,($,X)=>J0($)?T():X($.value));var gV=($)=>{if(Symbol.iterator in $){let J=[];for(let Z of $){if(J0(Z))return T();J.push(Z.value)}return q(J)}let X={};for(let J of Object.keys($)){let Z=$[J];if(J0(Z))return T();X[J]=Z.value}return q(X)};var GS=($)=>W(2,(X,J)=>J0(X)?!1:$(X.value,J)),KS=XJ(),hV=GS(KS);var GJ=($)=>(X,J)=>{if(J0(X))return J;else if(J0(J))return X;return q($(X.value,J.value))};var mV=(...$)=>$;var P5=(...$)=>$,KJ=($)=>Array($),E3=W(2,($,X)=>{let J=Math.max(1,Math.floor($)),Z=Array(J);for(let Q=0;Q<J;Q++)Z[Q]=X(Q);return Z});var c=($)=>Array.isArray($)?$:Array.from($),cV=($)=>Array.isArray($)?$:[$];var uV=W(2,($,{onEmpty:X,onNonEmpty:J})=>f0($)?J($):X());var _5=W(2,($,X)=>[X,...$]);var C9=W(2,($,X)=>[...$,X]),I3=W(2,($,X)=>c($).concat(c(X)));var fV=Array.isArray,BS=($)=>$.length===0,R3=BS,E9=P3,f0=P3;var pV=($,X)=>$<0||$>=X.length,WS=($,X)=>Math.floor(Math.min(Math.max(0,$),X.length)),HS=W(2,($,X)=>{let J=Math.floor(X);return pV(J,$)?T():q($[J])}),I9=W(2,($,X)=>{let J=Math.floor(X);if(pV(J,$))throw Error(`Index ${J} out of bounds`);return $[J]});var D4=HS(0),g0=I9(0),nV=($)=>f0($)?q(S3($)):T(),S3=($)=>$[$.length-1];var m$=($)=>$.slice(1);var zS=($,X)=>{let J=0;for(let Z of $){if(!X(Z,J))break;J++}return J},lV=W(2,($,X)=>VS($,zS($,X))),oV=W(2,($,X)=>{let J=c($);return J.slice(WS(X,J),J.length)});var j3=($)=>Array.from($).reverse(),BX=W(2,($,X)=>{let J=Array.from($);return J.sort(X),J});var x3=W(2,($,X)=>iV($,X,mV)),iV=W(3,($,X,J)=>{let Z=c($),Q=c(X);if(f0(Z)&&f0(Q)){let Y=[J(g0(Z),g0(Q))],G=Math.min(Z.length,Q.length);for(let K=1;K<G;K++)Y[K]=J(Z[K],Q[K]);return Y}return[]});var DS=XJ();var VS=W(2,($,X)=>{let J=Array.from($),Z=Math.floor(X);if(f0(J)){if(Z>=1)return US(J,Z);return[[],J]}return[J,[]]}),US=W(2,($,X)=>{let J=Math.max(1,Math.floor(X));return J>=$.length?[NS($),[]]:[_5($.slice(1,J),g0($)),$.slice(J)]});var NS=($)=>$.slice();var AS=W(3,($,X,J)=>{let Z=c($),Q=c(X);if(f0(Z)){if(f0(Q))return aV(J)(I3(Z,Q));return Z}return Q}),T$=W(2,($,X)=>AS($,X,DS));var h8=()=>[],$8=($)=>[$],L$=W(2,($,X)=>$.map(X)),R9=W(2,($,X)=>{if(R3($))return[];let J=[];for(let Z=0;Z<$.length;Z++){let Q=X($[Z],Z);for(let Y=0;Y<Q.length;Y++)J.push(Q[Y])}return J}),S9=R9(y),C5=W(2,($,X)=>{let J=c($),Z=[];for(let Q=0;Q<J.length;Q++){let Y=X(J[Q],Q);if(w0(Y))Z.push(Y.value)}return Z});var k3=W(2,($,X)=>{let J=[],Z=[],Q=c($);for(let Y=0;Y<Q.length;Y++){let G=X(Q[Y],Y);if(B8(G))J.push(G.left);else Z.push(G.right)}return[J,Z]}),rV=C5(y);var L6=W(3,($,X,J)=>c($).reduce((Z,Q,Y)=>J(Z,Q,Y),X)),BJ=W(3,($,X,J)=>c($).reduceRight((Z,Q,Y)=>J(Z,Q,Y),X));var v3=($,X)=>{let J=[],Z=$,Q;while(w0(Q=X(Z))){let[Y,G]=Q.value;J.push(Y),Z=G}return J};var E5=$V;var aV=W(2,($,X)=>{let J=c($);if(f0(J)){let Z=[g0(J)],Q=m$(J);for(let Y of Q)if(Z.every((G)=>!X(Y,G)))Z.push(Y);return Z}return[]}),y3=($)=>aV($,XJ());var d$=W(2,($,X)=>c($).join(X));var V4=xV;var sV=($)=>$.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");var eV=($)=>!$;var RY={};o4(RY,{makeWith:()=>Jb,makeEntryStats:()=>Qb,makeCacheStats:()=>Zb,make:()=>Xb,ConsumerCacheTypeId:()=>$b,CacheTypeId:()=>ey});var q0={};o4(q0,{unsafeMake:()=>IS,unsafeGet:()=>X$,pick:()=>jS,omit:()=>xS,mergeAll:()=>u3,merge:()=>Z$,make:()=>q8,isTag:()=>S5,isReference:()=>RS,isContext:()=>c3,getOrElse:()=>SS,getOption:()=>J$,get:()=>E0,empty:()=>h0,add:()=>t,TagTypeId:()=>CS,Tag:()=>kS,ReferenceTypeId:()=>ES,Reference:()=>c$,GenericTag:()=>x0});var x9=Symbol.for("effect/Context/Tag"),I5=Symbol.for("effect/Context/Reference"),TS="effect/STM",LS=Symbol.for(TS),R5={...F6,_op:"Tag",[LS]:W4,[x9]:{_Service:($)=>$,_Identifier:($)=>$},toString(){return l(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[g](){return this.toJSON()},of($){return $},context($){return m3(this,$)}},qS={...R5,[I5]:I5},XU=($)=>{let X=Error.stackTraceLimit;Error.stackTraceLimit=2;let J=Error();Error.stackTraceLimit=X;let Z=Object.create(R5);return Object.defineProperty(Z,"stack",{get(){return J.stack}}),Z.key=$,Z},JU=($)=>()=>{let X=Error.stackTraceLimit;Error.stackTraceLimit=2;let J=Error();Error.stackTraceLimit=X;function Z(){}return Object.setPrototypeOf(Z,R5),Z.key=$,Object.defineProperty(Z,"stack",{get(){return J.stack}}),Z},ZU=()=>($,X)=>{let J=Error.stackTraceLimit;Error.stackTraceLimit=2;let Z=Error();Error.stackTraceLimit=J;function Q(){}return Object.setPrototypeOf(Q,qS),Q.key=$,Q.defaultValue=X.defaultValue,Object.defineProperty(Q,"stack",{get(){return Z.stack}}),Q},g3=Symbol.for("effect/Context"),MS={[g3]:{_Services:($)=>$},[I]($){if(h3($)){if(this.unsafeMap.size===$.unsafeMap.size){for(let X of this.unsafeMap.keys())if(!$.unsafeMap.has(X)||!C(this.unsafeMap.get(X),$.unsafeMap.get(X)))return!1;return!0}}return!1},[R](){return b(this,O9(this.unsafeMap.size))},pipe(){return M(this,arguments)},toString(){return l(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(u)}},[g](){return this.toJSON()}},$$=($)=>{let X=Object.create(MS);return X.unsafeMap=$,X},PS=($)=>{let X=Error(`Service not found${$.key?`: ${String($.key)}`:""}`);if($.stack){let J=$.stack.split(`
`);if(J.length>2){let Z=J[2].match(/at (.*)/);if(Z)X.message=X.message+` (defined at ${Z[1]})`}}if(X.stack){let J=X.stack.split(`
`);J.splice(1,3),X.stack=J.join(`
`)}return X},h3=($)=>P($,g3),QU=($)=>P($,x9),k9=($)=>P($,I5),_S=$$(new Map),YU=()=>_S,m3=($,X)=>$$(new Map([[$.key,X]])),GU=W(3,($,X,J)=>{let Z=new Map($.unsafeMap);return Z.set(X.key,J),$$(Z)}),b3=j("effect/Context/defaultValueCache",()=>new Map),v9=($)=>{if(b3.has($.key))return b3.get($.key);let X=$.defaultValue();return b3.set($.key,X),X},KU=($,X)=>{return $.unsafeMap.has(X.key)?$.unsafeMap.get(X.key):v9(X)},d3=W(2,($,X)=>{if(!$.unsafeMap.has(X.key)){if(I5 in X)return v9(X);throw PS(X)}return $.unsafeMap.get(X.key)}),BU=d3,WU=W(3,($,X,J)=>{if(!$.unsafeMap.has(X.key))return k9(X)?v9(X):J();return $.unsafeMap.get(X.key)}),HU=W(2,($,X)=>{if(!$.unsafeMap.has(X.key))return k9(X)?T6(v9(X)):YJ;return T6($.unsafeMap.get(X.key))}),zU=W(2,($,X)=>{let J=new Map($.unsafeMap);for(let[Z,Q]of X.unsafeMap)J.set(Z,Q);return $$(J)}),DU=(...$)=>{let X=new Map;for(let J=0;J<$.length;J++)$[J].unsafeMap.forEach((Z,Q)=>{X.set(Q,Z)});return $$(X)},VU=(...$)=>(X)=>{let J=new Set($.map((Q)=>Q.key)),Z=new Map;for(let[Q,Y]of X.unsafeMap.entries())if(J.has(Q))Z.set(Q,Y);return $$(Z)},UU=(...$)=>(X)=>{let J=new Map(X.unsafeMap);for(let Z of $)J.delete(Z.key);return $$(J)};var CS=x9,ES=I5,x0=XU;var IS=$$,c3=h3,S5=QU,RS=k9,h0=YU,q8=m3,t=GU,E0=BU,SS=WU,X$=d3,J$=HU,Z$=zU,u3=DU,jS=VU,xS=UU,kS=JU,c$=ZU;var AU=Symbol.for("effect/Chunk");function vS($,X,J,Z,Q){for(let Y=X;Y<Math.min($.length,X+Q);Y++)J[Z+Y-X]=$[Y];return J}var OU=[],yS=($)=>V9((X,J)=>X.length===J.length&&d8(X).every((Z,Q)=>$(Z,WX(J,Q)))),bS=yS(C),gS={[AU]:{_A:($)=>$},toString(){return l(this.toJSON())},toJSON(){return{_id:"Chunk",values:d8(this).map(u)}},[g](){return this.toJSON()},[I]($){return wU($)&&bS(this,$)},[R](){return b(this,g8(d8(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return OU[Symbol.iterator]();default:return d8(this)[Symbol.iterator]()}},pipe(){return M(this,arguments)}},k0=($)=>{let X=Object.create(gS);switch(X.backing=$,$._tag){case"IEmpty":{X.length=0,X.depth=0,X.left=X,X.right=X;break}case"IConcat":{X.length=$.left.length+$.right.length,X.depth=1+Math.max($.left.depth,$.right.depth),X.left=$.left,X.right=$.right;break}case"IArray":{X.length=$.array.length,X.depth=0,X.left=u$,X.right=u$;break}case"ISingleton":{X.length=1,X.depth=0,X.left=u$,X.right=u$;break}case"ISlice":{X.length=$.length,X.depth=$.chunk.depth+1,X.left=u$,X.right=u$;break}}return X},wU=($)=>P($,AU),u$=k0({_tag:"IEmpty"}),W8=()=>u$,WJ=(...$)=>uS($),V0=($)=>k0({_tag:"ISingleton",a:$}),j5=($)=>wU($)?$:HX(c($)),f3=($,X,J)=>{switch($.backing._tag){case"IArray":{vS($.backing.array,0,X,J,$.length);break}case"IConcat":{f3($.left,X,J),f3($.right,X,J+$.left.length);break}case"ISingleton":{X[J]=$.backing.a;break}case"ISlice":{let Z=0,Q=J;while(Z<$.length)X[Q]=WX($,Z),Z+=1,Q+=1;break}}},hS=($)=>d8($).slice(),FU=hS,mS=($)=>{switch($.backing._tag){case"IEmpty":return OU;case"IArray":return $.backing.array;default:{let X=Array($.length);return f3($,X,0),$.backing={_tag:"IArray",array:X},$.left=u$,$.right=u$,$.depth=0,X}}},d8=mS,dS=($)=>{switch($.backing._tag){case"IEmpty":case"ISingleton":return $;case"IArray":return k0({_tag:"IArray",array:j3($.backing.array)});case"IConcat":return k0({_tag:"IConcat",left:f$($.backing.right),right:f$($.backing.left)});case"ISlice":return HX(j3(d8($)))}},f$=dS,cS=W(2,($,X)=>X<0||X>=$.length?T():q(WX($,X))),HX=($)=>$.length===0?W8():$.length===1?V0($[0]):k0({_tag:"IArray",array:$}),uS=($)=>HX($),WX=W(2,($,X)=>{switch($.backing._tag){case"IEmpty":throw Error("Index out of bounds");case"ISingleton":{if(X!==0)throw Error("Index out of bounds");return $.backing.a}case"IArray":{if(X>=$.length||X<0)throw Error("Index out of bounds");return $.backing.array[X]}case"IConcat":return X<$.left.length?WX($.left,X):WX($.right,X-$.left.length);case"ISlice":return WX($.backing.chunk,X+$.backing.offset)}}),y9=W(2,($,X)=>m8($,V0(X))),m0=W(2,($,X)=>m8(V0(X),$));var p3=W(2,($,X)=>{if(X<=0)return $;else if(X>=$.length)return u$;else switch($.backing._tag){case"ISlice":return k0({_tag:"ISlice",chunk:$.backing.chunk,offset:$.backing.offset+X,length:$.backing.length-X});case"IConcat":{if(X>$.left.length)return p3($.right,X-$.left.length);return k0({_tag:"IConcat",left:p3($.left,X),right:$.right})}default:return k0({_tag:"ISlice",chunk:$,offset:X,length:$.length-X})}});var m8=W(2,($,X)=>{if($.backing._tag==="IEmpty")return X;if(X.backing._tag==="IEmpty")return $;let J=X.depth-$.depth;if(Math.abs(J)<=1)return k0({_tag:"IConcat",left:$,right:X});else if(J<-1)if($.left.depth>=$.right.depth){let Z=m8($.right,X);return k0({_tag:"IConcat",left:$.left,right:Z})}else{let Z=m8($.right.right,X);if(Z.depth===$.depth-3){let Q=k0({_tag:"IConcat",left:$.right.left,right:Z});return k0({_tag:"IConcat",left:$.left,right:Q})}else{let Q=k0({_tag:"IConcat",left:$.left,right:$.right.left});return k0({_tag:"IConcat",left:Q,right:Z})}}else if(X.right.depth>=X.left.depth){let Z=m8($,X.left);return k0({_tag:"IConcat",left:Z,right:X.right})}else{let Z=m8($,X.left.left);if(Z.depth===X.depth-3){let Q=k0({_tag:"IConcat",left:Z,right:X.left.right});return k0({_tag:"IConcat",left:Q,right:X.right})}else{let Q=k0({_tag:"IConcat",left:X.left.right,right:X.right});return k0({_tag:"IConcat",left:Z,right:Q})}}});var n3=($)=>$.length===0,p0=($)=>$.length>0,b9=cS(0),l3=($)=>WX($,0),d0=l3;var X8=($)=>p3($,1);var o3=Symbol.for("effect/Duration"),PU=BigInt(0),TU=BigInt(24),g9=BigInt(60),i3=BigInt(1000),LU=BigInt(1e6),qU=BigInt(1e9),fS=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,F0=($)=>{if(CU($))return $;else if(e4($))return p$($);else if(N9($))return HJ($);else if(Array.isArray($)&&$.length===2&&$.every(e4)){if($[0]===-1/0||$[1]===-1/0||Number.isNaN($[0])||Number.isNaN($[1]))return U4;if($[0]===1/0||$[1]===1/0)return oS;return HJ(BigInt(Math.round($[0]*1e9))+BigInt(Math.round($[1])))}else if(t4($)){let X=fS.exec($);if(X){let[J,Z,Q]=X,Y=Number(Z);switch(Q){case"nano":case"nanos":return HJ(BigInt(Z));case"micro":case"micros":return iS(BigInt(Z));case"milli":case"millis":return p$(Y);case"second":case"seconds":return r3(Y);case"minute":case"minutes":return rS(Y);case"hour":case"hours":return aS(Y);case"day":case"days":return sS(Y);case"week":case"weeks":return tS(Y)}}}throw Error("Invalid DurationInput")},_U=yV(F0),MU={_tag:"Millis",millis:0},pS={_tag:"Infinity"},nS={[o3]:o3,[R](){return b(this,w9(this.value))},[I]($){return CU($)&&Zj(this,$)},toString(){return`Duration(${t3(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:$j(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[g](){return this.toJSON()},pipe(){return M(this,arguments)}},l$=($)=>{let X=Object.create(nS);if(e4($))if(isNaN($)||$<=0)X.value=MU;else if(!Number.isFinite($))X.value=pS;else if(!Number.isInteger($))X.value={_tag:"Nanos",nanos:BigInt(Math.round($*1e6))};else X.value={_tag:"Millis",millis:$};else if($<=PU)X.value=MU;else X.value={_tag:"Nanos",nanos:$};return X},CU=($)=>P($,o3);var lS=($)=>{switch($.value._tag){case"Millis":return $.value.millis===0;case"Nanos":return $.value.nanos===PU;case"Infinity":return!1}},U4=l$(0),oS=l$(1/0),HJ=($)=>l$($),iS=($)=>l$($*i3),p$=($)=>l$($),r3=($)=>l$($*1000),rS=($)=>l$($*60000),aS=($)=>l$($*3600000),sS=($)=>l$($*86400000),tS=($)=>l$($*604800000),n$=($)=>Xj($,{onMillis:(X)=>X,onNanos:(X)=>Number(X)/1e6});var eS=($)=>{let X=F0($);switch(X.value._tag){case"Infinity":throw Error("Cannot convert infinite duration to nanos");case"Nanos":return X.value.nanos;case"Millis":return BigInt(Math.round(X.value.millis*1e6))}},$j=($)=>{let X=F0($);switch(X.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(X.value.nanos/qU),Number(X.value.nanos%qU)];case"Millis":return[Math.floor(X.value.millis/1000),Math.round(X.value.millis%1000*1e6)]}},Xj=W(2,($,X)=>{let J=F0($);switch(J.value._tag){case"Nanos":return X.onNanos(J.value.nanos);case"Infinity":return X.onMillis(1/0);case"Millis":return X.onMillis(J.value.millis)}}),a3=W(3,($,X,J)=>{let Z=F0($),Q=F0(X);if(Z.value._tag==="Infinity"||Q.value._tag==="Infinity")return J.onMillis(n$(Z),n$(Q));else if(Z.value._tag==="Nanos"||Q.value._tag==="Nanos"){let Y=Z.value._tag==="Nanos"?Z.value.nanos:BigInt(Math.round(Z.value.millis*1e6)),G=Q.value._tag==="Nanos"?Q.value.nanos:BigInt(Math.round(Q.value.millis*1e6));return J.onNanos(Y,G)}return J.onMillis(Z.value.millis,Q.value.millis)});var Jj=($,X)=>a3($,X,{onMillis:(J,Z)=>J===Z,onNanos:(J,Z)=>J===Z});var EU=W(2,($,X)=>a3($,X,{onMillis:(J,Z)=>J<=Z,onNanos:(J,Z)=>J<=Z}));var s3=W(2,($,X)=>a3($,X,{onMillis:(J,Z)=>J>=Z,onNanos:(J,Z)=>J>=Z})),Zj=W(2,($,X)=>Jj(F0($),F0(X))),Qj=($)=>{let X=F0($);if(X.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let J=eS(X),Z=J/LU,Q=Z/i3,Y=Q/g9,G=Y/g9,K=G/TU;return{days:Number(K),hours:Number(G%TU),minutes:Number(Y%g9),seconds:Number(Q%g9),millis:Number(Z%i3),nanos:Number(J%LU)}},t3=($)=>{let X=F0($);if(X.value._tag==="Infinity")return"Infinity";if(lS(X))return"0";let J=Qj(X),Z=[];if(J.days!==0)Z.push(`${J.days}d`);if(J.hours!==0)Z.push(`${J.hours}h`);if(J.minutes!==0)Z.push(`${J.minutes}m`);if(J.seconds!==0)Z.push(`${J.seconds}s`);if(J.millis!==0)Z.push(`${J.millis}ms`);if(J.nanos!==0)Z.push(`${J.nanos}ns`);return Z.join(" ")};var N4=5,e3=Math.pow(2,5),IU=e3-1,RU=e3/2,SU=e3/4;function Yj($){return $-=$>>1&1431655765,$=($&858993459)+($>>2&858993459),$=$+($>>4)&252645135,$+=$>>8,$+=$>>16,$&127}function A4($,X){return X>>>$&IU}function O4($){return 1<<$}function h9($,X){return Yj($&X-1)}var jU=($,X)=>({value:$,previous:X});function zX($,X,J,Z){let Q=Z;if(!$){let Y=Z.length;Q=Array(Y);for(let G=0;G<Y;++G)Q[G]=Z[G]}return Q[X]=J,Q}function $2($,X,J){let Z=J.length-1,Q=0,Y=0,G=J;if($)Q=Y=X;else{G=Array(Z);while(Q<X)G[Y++]=J[Q++]}++Q;while(Q<=Z)G[Y++]=J[Q++];if($)G.length=Z;return G}function xU($,X,J,Z){let Q=Z.length;if($){let B=Q;while(B>=X)Z[B--]=Z[B];return Z[X]=J,Z}let Y=0,G=0,K=Array(Q+1);while(Y<X)K[G++]=Z[Y++];K[X]=J;while(Y<Q)K[++G]=Z[Y++];return K}class q6{_tag="EmptyNode";modify($,X,J,Z,Q,Y){let G=J(T());if(J0(G))return new q6;return++Y.value,new DX($,Z,Q,G)}}function Q$($){return k$($,"EmptyNode")}function Kj($){return Q$($)||$._tag==="LeafNode"||$._tag==="CollisionNode"}function m9($,X){return Q$($)?!1:X===$.edit}class DX{edit;hash;key;value;_tag="LeafNode";constructor($,X,J,Z){this.edit=$,this.hash=X,this.key=J,this.value=Z}modify($,X,J,Z,Q,Y){if(C(Q,this.key)){let K=J(this.value);if(K===this.value)return this;else if(J0(K))return--Y.value,new q6;if(m9(this,$))return this.value=K,this;return new DX($,Z,Q,K)}let G=J(T());if(J0(G))return this;return++Y.value,kU($,X,this.hash,this,Z,new DX($,Z,Q,G))}}class X2{edit;hash;children;_tag="CollisionNode";constructor($,X,J){this.edit=$,this.hash=X,this.children=J}modify($,X,J,Z,Q,Y){if(Z===this.hash){let K=m9(this,$),B=this.updateCollisionList(K,$,this.hash,this.children,J,Q,Y);if(B===this.children)return this;return B.length>1?new X2($,this.hash,B):B[0]}let G=J(T());if(J0(G))return this;return++Y.value,kU($,X,this.hash,this,Z,new DX($,Z,Q,G))}updateCollisionList($,X,J,Z,Q,Y,G){let K=Z.length;for(let H=0;H<K;++H){let z=Z[H];if("key"in z&&C(Y,z.key)){let V=z.value,N=Q(V);if(N===V)return Z;if(J0(N))return--G.value,$2($,H,Z);return zX($,H,new DX(X,J,Y,N),Z)}}let B=Q(T());if(J0(B))return Z;return++G.value,zX($,K,new DX(X,J,Y,B),Z)}}class x5{edit;mask;children;_tag="IndexedNode";constructor($,X,J){this.edit=$,this.mask=X,this.children=J}modify($,X,J,Z,Q,Y){let G=this.mask,K=this.children,B=A4(X,Z),H=O4(B),z=h9(G,H),V=G&H,N=m9(this,$);if(!V){let n=new q6().modify($,X+N4,J,Z,Q,Y);if(!n)return this;return K.length>=RU?Wj($,B,n,G,K):new x5($,G|H,xU(N,z,n,K))}let A=K[z],F=A.modify($,X+N4,J,Z,Q,Y);if(A===F)return this;let E=G,d;if(Q$(F)){if(E&=~H,!E)return new q6;if(K.length<=2&&Kj(K[z^1]))return K[z^1];d=$2(N,z,K)}else d=zX(N,z,F,K);if(N)return this.mask=E,this.children=d,this;return new x5($,E,d)}}class J2{edit;size;children;_tag="ArrayNode";constructor($,X,J){this.edit=$,this.size=X,this.children=J}modify($,X,J,Z,Q,Y){let G=this.size,K=this.children,B=A4(X,Z),H=K[B],z=(H||new q6).modify($,X+N4,J,Z,Q,Y);if(H===z)return this;let V=m9(this,$),N;if(Q$(H)&&!Q$(z))++G,N=zX(V,B,z,K);else if(!Q$(H)&&Q$(z)){if(--G,G<=SU)return Bj($,G,B,K);N=zX(V,B,new q6,K)}else N=zX(V,B,z,K);if(V)return this.size=G,this.children=N,this;return new J2($,G,N)}}function Bj($,X,J,Z){let Q=Array(X-1),Y=0,G=0;for(let K=0,B=Z.length;K<B;++K)if(K!==J){let H=Z[K];if(H&&!Q$(H))Q[Y++]=H,G|=1<<K}return new x5($,G,Q)}function Wj($,X,J,Z,Q){let Y=[],G=Z,K=0;for(let B=0;G;++B){if(G&1)Y[B]=Q[K++];G>>>=1}return Y[X]=J,new J2($,K+1,Y)}function Hj($,X,J,Z,Q,Y){if(J===Q)return new X2($,J,[Y,Z]);let G=A4(X,J),K=A4(X,Q);if(G===K)return(B)=>new x5($,O4(G)|O4(K),[B]);else{let B=G<K?[Z,Y]:[Y,Z];return new x5($,O4(G)|O4(K),B)}}function kU($,X,J,Z,Q,Y){let G=void 0,K=X;while(!0){let B=Hj($,K,J,Z,Q,Y);if(typeof B==="function")G=jU(B,G),K=K+N4;else{let H=B;while(G!=null)H=G.value(H),G=G.previous;return H}}}var vU="effect/HashMap",d9=Symbol.for(vU),Dj={[d9]:d9,[Symbol.iterator](){return new u9(this,($,X)=>[$,X])},[R](){let $=_(vU);for(let X of this)$^=D(_(X[0]),x(_(X[1])));return b(this,$)},[I]($){if(hU($)){if($._size!==this._size)return!1;for(let X of this){let J=D($,f9(X[0],_(X[0])));if(J0(J))return!1;else if(!C(X[1],J.value))return!1}return!0}return!1},toString(){return l(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(u)}},[g](){return this.toJSON()},pipe(){return M(this,arguments)}},Z2=($,X,J,Z)=>{let Q=Object.create(Dj);return Q._editable=$,Q._edit=X,Q._root=J,Q._size=Z,Q};class u9{map;f;v;constructor($,X){this.map=$,this.f=X,this.v=yU(this.map._root,this.f,void 0)}next(){if(J0(this.v))return{done:!0,value:void 0};let $=this.v.value;return this.v=c9($.cont),{done:!1,value:$.value}}[Symbol.iterator](){return new u9(this.map,this.f)}}var c9=($)=>$?bU($[0],$[1],$[2],$[3],$[4]):T(),yU=($,X,J=void 0)=>{switch($._tag){case"LeafNode":{if(w0($.value))return q({value:X($.key,$.value.value),cont:J});return c9(J)}case"CollisionNode":case"ArrayNode":case"IndexedNode":{let Z=$.children;return bU(Z.length,Z,0,X,J)}default:return c9(J)}},bU=($,X,J,Z,Q)=>{while(J<$){let Y=X[J++];if(Y&&!Q$(Y))return yU(Y,Z,[$,X,J,Z,Q])}return c9(Q)},Vj=Z2(!1,0,new q6,0),k5=()=>Vj;var gU=($)=>{let X=DJ(k5());for(let J of $)VX(X,J[0],J[1]);return Y2(X)},hU=($)=>P($,d9),mU=($)=>$&&Q$($._root),dU=W(2,($,X)=>f9($,X,_(X))),f9=W(3,($,X,J)=>{let Z=$._root,Q=0;while(!0)switch(Z._tag){case"LeafNode":return C(X,Z.key)?Z.value:T();case"CollisionNode":{if(J===Z.hash){let Y=Z.children;for(let G=0,K=Y.length;G<K;++G){let B=Y[G];if("key"in B&&C(X,B.key))return B.value}}return T()}case"IndexedNode":{let Y=A4(Q,J),G=O4(Y);if(Z.mask&G){Z=Z.children[h9(Z.mask,G)],Q+=N4;break}return T()}case"ArrayNode":{if(Z=Z.children[A4(Q,J)],Z){Q+=N4;break}return T()}default:return T()}});var Q2=W(2,($,X)=>w0(f9($,X,_(X))));var VX=W(3,($,X,J)=>n9($,X,()=>q(J))),Uj=W(3,($,X,J)=>{if($._editable)return $._root=X,$._size=J,$;return X===$._root?$:Z2($._editable,$._edit,X,J)}),p9=($)=>new u9($,(X)=>X);var zJ=($)=>$._size;var DJ=($)=>Z2(!0,$._edit+1,$._root,$._size),Y2=($)=>{return $._editable=!1,$},cU=W(2,($,X)=>{let J=DJ($);return X(J),Y2(J)}),n9=W(3,($,X,J)=>uU($,X,_(X),J)),uU=W(4,($,X,J,Z)=>{let Q={value:$._size},Y=$._root.modify($._editable?$._edit:NaN,0,Z,J,X,Q);return D($,Uj(Y,Q.value))});var l9=W(2,($,X)=>n9($,X,T));var fU=W(2,($,X)=>v5($,k5(),(J,Z,Q)=>VX(J,Q,X(Z,Q))));var o9=W(2,($,X)=>v5($,void 0,(J,Z,Q)=>X(Z,Q))),v5=W(3,($,X,J)=>{let Z=$._root;if(Z._tag==="LeafNode")return w0(Z.value)?J(X,Z.value.value,Z.key):X;if(Z._tag==="EmptyNode")return X;let Q=[Z.children],Y;while(Y=Q.pop())for(let G=0,K=Y.length;G<K;){let B=Y[G++];if(B&&!Q$(B))if(B._tag==="LeafNode"){if(w0(B.value))X=J(X,B.value.value,B.key)}else Q.push(B.children)}return X});var nU="effect/HashSet",i9=Symbol.for(nU),Nj={[i9]:i9,[Symbol.iterator](){return p9(this._keyMap)},[R](){return b(this,x(_(this._keyMap))(_(nU)))},[I]($){if(lU($))return zJ(this._keyMap)===zJ($._keyMap)&&C(this._keyMap,$._keyMap);return!1},toString(){return l(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(u)}},[g](){return this.toJSON()},pipe(){return M(this,arguments)}},r9=($)=>{let X=Object.create(Nj);return X._keyMap=$,X},lU=($)=>P($,i9),Aj=r9(k5()),VJ=()=>Aj,oU=($)=>{let X=a9(VJ());for(let J of $)y5(X,J);return s9(X)},iU=(...$)=>{let X=a9(VJ());for(let J of $)y5(X,J);return s9(X)},rU=W(2,($,X)=>Q2($._keyMap,X));var aU=($)=>zJ($._keyMap),a9=($)=>r9(DJ($._keyMap)),s9=($)=>{return $._keyMap._editable=!1,$},G2=W(2,($,X)=>{let J=a9($);return X(J),s9(J)}),y5=W(2,($,X)=>$._keyMap._editable?(VX(X,!0)($._keyMap),$):r9(VX(X,!0)($._keyMap))),K2=W(2,($,X)=>$._keyMap._editable?(l9(X)($._keyMap),$):r9(l9(X)($._keyMap))),sU=W(2,($,X)=>G2($,(J)=>{for(let Z of X)K2(J,Z)}));var tU=W(2,($,X)=>G2(VJ(),(J)=>{eU($,(Z)=>y5(J,Z));for(let Z of X)y5(J,Z)}));var eU=W(2,($,X)=>o9($._keyMap,(J,Z)=>X(Z))),$N=W(3,($,X,J)=>v5($._keyMap,X,(Z,Q,Y)=>J(Z,Y)));var o$=VJ,UX=oU,NX=iU,XN=rU;var AX=aU;var OX=y5,B2=K2,W2=sU;var i$=tU;var wX=$N;var JN=Symbol.for("effect/MutableRef"),wj={[JN]:JN,toString(){return l(this.toJSON())},toJSON(){return{_id:"MutableRef",current:u(this.current)}},[g](){return this.toJSON()},pipe(){return M(this,arguments)}},a$=($)=>{let X=Object.create(wj);return X.current=$,X},t9=W(3,($,X,J)=>{if(C(X,$.current))return $.current=J,!0;return!1});var s$=($)=>$.current;var M6=W(2,($,X)=>{return $.current=X,$});var $Q="effect/FiberId",w4=Symbol.for($Q),g5="None",H2="Runtime",z2="Composite",Fj=s(`${$Q}-${g5}`);class QN{[w4]=w4;_tag=g5;id=-1;startTimeMillis=-1;[R](){return Fj}[I]($){return JQ($)&&$._tag===g5}toString(){return l(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[g](){return this.toJSON()}}class YN{id;startTimeMillis;[w4]=w4;_tag=H2;constructor($,X){this.id=$,this.startTimeMillis=X}[R](){return b(this,s(`${$Q}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[I]($){return JQ($)&&$._tag===H2&&this.id===$.id&&this.startTimeMillis===$.startTimeMillis}toString(){return l(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[g](){return this.toJSON()}}class GN{left;right;[w4]=w4;_tag=z2;constructor($,X){this.left=$,this.right=X}_hash;[R](){return D(s(`${$Q}-${this._tag}`),x(_(this.left)),x(_(this.right)),b(this))}[I]($){return JQ($)&&$._tag===z2&&C(this.left,$.left)&&C(this.right,$.right)}toString(){return l(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:u(this.left),right:u(this.right)}}[g](){return this.toJSON()}}var XQ=new QN;var JQ=($)=>P($,w4);var KN=W(2,($,X)=>{if($._tag===g5)return X;if(X._tag===g5)return $;return new GN($,X)});var e9=($)=>{switch($._tag){case g5:return o$();case H2:return NX($.id);case z2:return D(e9($.left),i$(e9($.right)))}},ZN=j(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>a$(0));var ZQ=($)=>{return Array.from(e9($)).map((J)=>`#${J}`).join(",")};var BN=()=>{let $=s$(ZN);return D(ZN,M6($+1)),new YN($,Date.now())};var P8=XQ;var D2=KN;var HN=ZQ;var QQ=BN;var FX=k5;var zN=gU,DN=mU,V2=dU;var J8=VX,U2=p9;var VN=cU,UN=n9;var NN=fU;var AN=o9,N2=v5;var UJ=Symbol.for("effect/List"),A2=($)=>c($),Tj=($)=>eD(E5($),A2),Lj=Tj(C),qj={[UJ]:UJ,_tag:"Cons",toString(){return l(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:A2(this).map(u)}},[g](){return this.toJSON()},[I]($){return wN($)&&this._tag===$._tag&&Lj(this,$)},[R](){return b(this,g8(A2(this)))},[Symbol.iterator](){let $=!1,X=this;return{next(){if($)return this.return();if(X._tag==="Nil")return $=!0,this.return();let J=X.head;return X=X.tail,{done:$,value:J}},return(J){if(!$)$=!0;return{done:!0,value:J}}}},pipe(){return M(this,arguments)}},YQ=($,X)=>{let J=Object.create(qj);return J.head=$,J.tail=X,J},Mj=s("Nil"),Pj={[UJ]:UJ,_tag:"Nil",toString(){return l(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[g](){return this.toJSON()},[R](){return Mj},[I]($){return wN($)&&this._tag===$._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return M(this,arguments)}},ON=Object.create(Pj),wN=($)=>P($,UJ),t$=($)=>$._tag==="Nil",O2=($)=>$._tag==="Cons";var _j=()=>ON,P6=($,X)=>YQ($,X),e$=_j,NJ=($)=>YQ($,ON);var FN=W(2,($,X)=>Cj(X,$)),GQ=W(2,($,X)=>P6(X,$)),Cj=W(2,($,X)=>{if(t$($))return X;else if(t$(X))return $;else{let J=YQ(X.head,$),Z=J,Q=X.tail;while(!t$(Q)){let Y=YQ(Q.head,$);Z.tail=Y,Z=Y,Q=Q.tail}return J}});var TN=W(3,($,X,J)=>{let Z=X,Q=$;while(!t$(Q))Z=J(Z,Q.head),Q=Q.tail;return Z});var LN=($)=>{let X=e$(),J=$;while(!t$(J))X=GQ(X,J.head),J=J.tail;return X};var qN=Object.assign(Object.create(Array.prototype),{[R](){return b(this,g8(this))},[I]($){if(Array.isArray($)&&this.length===$.length)return this.every((X,J)=>C(X,$[J]));else return!1}}),_6=function(){function $(X){if(X)Object.assign(this,X)}return $.prototype=y$,$}(),m5=($)=>Object.assign(Object.create(y$),$);var Ej=Symbol.for("effect/DifferContextPatch");function MN($){return $}var wJ={..._6.prototype,[Ej]:{_Value:MN,_Patch:MN}},Ij=Object.assign(Object.create(wJ),{_tag:"Empty"}),Rj=Object.create(Ij),F2=()=>Rj,Sj=Object.assign(Object.create(wJ),{_tag:"AndThen"}),jj=($,X)=>{let J=Object.create(Sj);return J.first=$,J.second=X,J},xj=Object.assign(Object.create(wJ),{_tag:"AddService"}),kj=($,X)=>{let J=Object.create(xj);return J.key=$,J.service=X,J},vj=Object.assign(Object.create(wJ),{_tag:"RemoveService"}),yj=($)=>{let X=Object.create(vj);return X.key=$,X},bj=Object.assign(Object.create(wJ),{_tag:"UpdateService"}),gj=($,X)=>{let J=Object.create(bj);return J.key=$,J.update=X,J},PN=($,X)=>{let J=new Map($.unsafeMap),Z=F2();for(let[Q,Y]of X.unsafeMap.entries())if(J.has(Q)){let G=J.get(Q);if(J.delete(Q),!C(G,Y))Z=OJ(gj(Q,()=>Y))(Z)}else J.delete(Q),Z=OJ(kj(Q,Y))(Z);for(let[Q]of J.entries())Z=OJ(yj(Q))(Z);return Z},OJ=W(2,($,X)=>jj($,X)),_N=W(2,($,X)=>{if($._tag==="Empty")return X;let J=!1,Z=V0($),Q=new Map(X.unsafeMap);while(p0(Z)){let G=d0(Z),K=X8(Z);switch(G._tag){case"Empty":{Z=K;break}case"AddService":{Q.set(G.key,G.service),Z=K;break}case"AndThen":{Z=m0(m0(K,G.second),G.first);break}case"RemoveService":{Q.delete(G.key),Z=K;break}case"UpdateService":{Q.set(G.key,G.update(Q.get(G.key))),J=!0,Z=K;break}}}if(!J)return $$(Q);let Y=new Map;for(let[G]of X.unsafeMap)if(Q.has(G))Y.set(G,Q.get(G)),Q.delete(G);for(let[G,K]of Q)Y.set(G,K);return $$(Y)});var mj=Symbol.for("effect/DifferHashSetPatch");function T2($){return $}var BQ={..._6.prototype,[mj]:{_Value:T2,_Key:T2,_Patch:T2}},dj=Object.assign(Object.create(BQ),{_tag:"Empty"}),cj=Object.create(dj),L2=()=>cj,uj=Object.assign(Object.create(BQ),{_tag:"AndThen"}),fj=($,X)=>{let J=Object.create(uj);return J.first=$,J.second=X,J},pj=Object.assign(Object.create(BQ),{_tag:"Add"}),nj=($)=>{let X=Object.create(pj);return X.value=$,X},lj=Object.assign(Object.create(BQ),{_tag:"Remove"}),oj=($)=>{let X=Object.create(lj);return X.value=$,X},CN=($,X)=>{let[J,Z]=wX([$,L2()],([Q,Y],G)=>{if(XN(G)(Q))return[B2(G)(Q),Y];return[Q,KQ(nj(G))(Y)]})(X);return wX(Z,(Q,Y)=>KQ(oj(Y))(Q))(J)},KQ=W(2,($,X)=>fj($,X)),EN=W(2,($,X)=>{if($._tag==="Empty")return X;let J=X,Z=V0($);while(p0(Z)){let Q=d0(Z),Y=X8(Z);switch(Q._tag){case"Empty":{Z=Y;break}case"AndThen":{Z=m0(Q.first)(m0(Q.second)(Y));break}case"Add":{J=OX(Q.value)(J),Z=Y;break}case"Remove":J=B2(Q.value)(J),Z=Y}}return J});var rj=Symbol.for("effect/DifferReadonlyArrayPatch");function IN($){return $}var TJ={..._6.prototype,[rj]:{_Value:IN,_Patch:IN}},aj=Object.assign(Object.create(TJ),{_tag:"Empty"}),sj=Object.create(aj),q2=()=>sj,tj=Object.assign(Object.create(TJ),{_tag:"AndThen"}),ej=($,X)=>{let J=Object.create(tj);return J.first=$,J.second=X,J},$x=Object.assign(Object.create(TJ),{_tag:"Append"}),Xx=($)=>{let X=Object.create($x);return X.values=$,X},Jx=Object.assign(Object.create(TJ),{_tag:"Slice"}),Zx=($,X)=>{let J=Object.create(Jx);return J.from=$,J.until=X,J},Qx=Object.assign(Object.create(TJ),{_tag:"Update"}),Yx=($,X)=>{let J=Object.create(Qx);return J.index=$,J.patch=X,J},RN=($)=>{let X=0,J=q2();while(X<$.oldValue.length&&X<$.newValue.length){let Z=$.oldValue[X],Q=$.newValue[X],Y=$.differ.diff(Z,Q);if(!C(Y,$.differ.empty))J=FJ(J,Yx(X,Y));X=X+1}if(X<$.oldValue.length)J=FJ(J,Zx(0,X));if(X<$.newValue.length)J=FJ(J,Xx(oV(X)($.newValue)));return J},FJ=W(2,($,X)=>ej($,X)),SN=W(3,($,X,J)=>{if($._tag==="Empty")return X;let Z=X.slice(),Q=$8($);while(E9(Q)){let Y=g0(Q),G=m$(Q);switch(Y._tag){case"Empty":{Q=G;break}case"AndThen":{G.unshift(Y.first,Y.second),Q=G;break}case"Append":{for(let K of Y.values)Z.push(K);Q=G;break}case"Slice":{Z=Z.slice(Y.from,Y.until),Q=G;break}case"Update":{Z[Y.index]=J.patch(Y.patch,Z[Y.index]),Q=G;break}}}return Z});var jN=Symbol.for("effect/Differ"),Kx={[jN]:{_P:y,_V:y},pipe(){return M(this,arguments)}},F4=($)=>{let X=Object.create(Kx);return X.empty=$.empty,X.diff=$.diff,X.combine=$.combine,X.patch=$.patch,X},M2=()=>F4({empty:F2(),combine:($,X)=>OJ(X)($),diff:($,X)=>PN($,X),patch:($,X)=>_N(X)($)});var P2=()=>F4({empty:L2(),combine:($,X)=>KQ(X)($),diff:($,X)=>CN($,X),patch:($,X)=>EN(X)($)});var _2=($)=>F4({empty:q2(),combine:(X,J)=>FJ(X,J),diff:(X,J)=>RN({oldValue:X,newValue:J,differ:$}),patch:(X,J)=>SN(X,J,$)});var WQ=()=>xN(($,X)=>X),xN=($)=>F4({empty:y,combine:(X,J)=>{if(X===y)return J;if(J===y)return X;return(Z)=>J(X(Z))},diff:(X,J)=>{if(C(X,J))return y;return t7(J)},patch:(X,J)=>$(J,X(J))});var LJ=255,kN=8,HQ=($)=>$&LJ,zQ=($)=>$>>kN&LJ,LX=($,X)=>($&LJ)+((X&$&LJ)<<kN),DQ=LX(0,0),vN=($)=>LX($,$),yN=($)=>LX($,0);var bN=W(2,($,X)=>LX(HQ($)&~X,zQ($)));var E2=W(2,($,X)=>$|X);var gN=($)=>~$>>>0&LJ;var Bx=0,M$=1,mN=2,I2=4,VQ=16,R2=32;var dN=($)=>UQ($,R2),S2=W(2,($,X)=>$&~X);var j2=W(2,($,X)=>$|X);var C6=($)=>qJ($)&&!Wx($),qJ=($)=>UQ($,M$);var UQ=W(2,($,X)=>($&X)!==0),x2=(...$)=>$.reduce((X,J)=>X|J,0),cN=x2(Bx);var k2=($)=>UQ($,I2);var Wx=($)=>UQ($,VQ);var Y$=W(2,($,X)=>LX($^X,X)),E6=W(2,($,X)=>$&(gN(HQ(X))|zQ(X))|HQ(X)&zQ(X));var v2=F4({empty:DQ,diff:($,X)=>Y$($,X),combine:($,X)=>E2(X)($),patch:($,X)=>E6(X,$)});var uN=DQ;var y2=vN,b2=yN;var g2=bN;var fN={_tag:"Empty"},d2=($,X)=>({_tag:"Par",left:$,right:X}),NQ=($,X)=>({_tag:"Seq",left:$,right:X}),c2=($,X)=>({_tag:"Single",dataSource:$,blockedRequest:X});var pN=($)=>{let X=NJ($),J=e$();while(!0){let[Z,Q]=TN(X,[lN(),e$()],([Y,G],K)=>{let[B,H]=Hx(K);return[Ox(Y,B),FN(G,H)]});if(J=zx(J,Z),t$(Q))return LN(J);X=Q}throw Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},Hx=($)=>{let X=$,J=lN(),Z=e$(),Q=e$();while(!0)switch(X._tag){case"Empty":{if(t$(Z))return[J,Q];X=Z.head,Z=Z.tail;break}case"Par":{Z=P6(X.right,Z),X=X.left;break}case"Seq":{let{left:Y,right:G}=X;switch(Y._tag){case"Empty":{X=G;break}case"Par":{let{left:K,right:B}=Y;X=d2(NQ(K,G),NQ(B,G));break}case"Seq":{let{left:K,right:B}=Y;X=NQ(K,NQ(B,G));break}case"Single":{X=Y,Q=P6(G,Q);break}}break}case"Single":{if(J=Ax(J,X),t$(Z))return[J,Q];X=Z.head,Z=Z.tail;break}}throw Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},zx=($,X)=>{if(t$($))return NJ(m2(X));if(wx(X))return $;let J=Px($.head),Z=Fx(X);if(J.length===1&&Z.length===1&&C(J[0],Z[0]))return P6(Mx($.head,m2(X)),$.tail);return P6(m2(X),$)},Dx=Symbol.for("effect/RequestBlock/Entry");class nN{request;result;listeners;ownerId;state;[Dx]=Vx;constructor($,X,J,Z,Q){this.request=$,this.result=X,this.listeners=J,this.ownerId=Z,this.state=Q}}var Vx={_R:($)=>$};var u2=($)=>new nN($.request,$.result,$.listeners,$.ownerId,$.state),Ux=Symbol.for("effect/RequestBlock/RequestBlockParallel"),Nx={_R:($)=>$};class AQ{map;[Ux]=Nx;constructor($){this.map=$}}var lN=()=>new AQ(FX());var Ax=($,X)=>new AQ(UN($.map,X.dataSource,(J)=>vV(h$(J,y9(X.blockedRequest)),()=>V0(X.blockedRequest)))),Ox=($,X)=>new AQ(N2($.map,X.map,(J,Z,Q)=>J8(J,Q,C0(V2(J,Q),{onNone:()=>Z,onSome:(Y)=>m8(Z,Y)})))),wx=($)=>DN($.map),Fx=($)=>Array.from(U2($.map)),m2=($)=>qx(NN($.map,(X)=>V0(X))),Tx=Symbol.for("effect/RequestBlock/RequestBlockSequential"),Lx={_R:($)=>$};class f2{map;[Tx]=Lx;constructor($){this.map=$}}var qx=($)=>new f2($),Mx=($,X)=>new f2(N2(X.map,$.map,(J,Z,Q)=>J8(J,Q,C0(V2(J,Q),{onNone:()=>W8(),onSome:(Y)=>m8(Y,Z)}))));var Px=($)=>Array.from(U2($.map)),oN=($)=>Array.from($.map);var qX="Die",T4="Empty",MX="Fail",PX="Interrupt",_X="Parallel",CX="Sequential";var sN="effect/Cause",n2=Symbol.for(sN),Cx={_E:($)=>$},d5={[n2]:Cx,[R](){return D(_(sN),x(_(Ix(this))),b(this))},[I]($){return wQ($)&&Ex(this,$)},pipe(){return M(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:u(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:u(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:u(this.left),right:u(this.right)}}},toString(){return $6(this)},[g](){return this.toJSON()}},H8=(()=>{let $=Object.create(d5);return $._tag=T4,$})(),I6=($)=>{let X=Object.create(d5);return X._tag=MX,X.error=$,X},M0=($)=>{let X=Object.create(d5);return X._tag=qX,X.defect=$,X},c8=($)=>{let X=Object.create(d5);return X._tag=PX,X.fiberId=$,X},z8=($,X)=>{let J=Object.create(d5);return J._tag=_X,J.left=$,J.right=X,J},B0=($,X)=>{let J=Object.create(d5);return J._tag=CX,J.left=$,J.right=X,J},wQ=($)=>P($,n2),l2=($)=>$._tag===T4;var c5=($)=>$._tag===qX;var FQ=($)=>{if($._tag===T4)return!0;return EX($,!0,(X,J)=>{switch(J._tag){case T4:return q(X);case qX:case MX:case PX:return q(!1);default:return T()}})};var TQ=($)=>w0(tN($)),u5=($)=>MQ(void 0,Sx)($),PJ=($)=>f$(EX($,W8(),(X,J)=>J._tag===MX?q(D(X,m0(J.error))):T())),LQ=($)=>f$(EX($,W8(),(X,J)=>J._tag===qX?q(D(X,m0(J.defect))):T())),_J=($)=>EX($,o$(),(X,J)=>J._tag===PX?q(D(X,OX(J.fiberId))):T()),o2=($)=>L4($,(X)=>X._tag===MX?q(X.error):T()),P$=($)=>{let X=o2($);switch(X._tag){case"None":return f($);case"Some":return $0(X.value)}};var tN=($)=>L4($,(X)=>X._tag===PX?q(X.fiberId):T()),i2=($)=>f5($,{onEmpty:T(),onFail:()=>T(),onDie:(X)=>q(M0(X)),onInterrupt:()=>T(),onSequential:GJ(B0),onParallel:GJ(z8)}),eN=($)=>f5($,{onEmpty:T(),onFail:(X)=>q(M0(X)),onDie:(X)=>q(M0(X)),onInterrupt:()=>T(),onSequential:GJ(B0),onParallel:GJ(z8)});var qQ=($)=>f5($,{onEmpty:H8,onFail:()=>H8,onDie:M0,onInterrupt:c8,onSequential:B0,onParallel:z8}),$A=($)=>f5($,{onEmpty:H8,onFail:M0,onDie:M0,onInterrupt:c8,onSequential:B0,onParallel:z8});var XA=W(2,($,X)=>f5($,{onEmpty:H8,onFail:(J)=>X(J),onDie:(J)=>M0(J),onInterrupt:(J)=>c8(J),onSequential:(J,Z)=>B0(J,Z),onParallel:(J,Z)=>z8(J,Z)})),r2=($)=>XA($,y);var Ex=($,X)=>{let J=V0($),Z=V0(X);while(p0(J)&&p0(Z)){let[Q,Y]=D(d0(J),EX([o$(),W8()],([B,H],z)=>{let[V,N]=p2(z);return q([D(B,i$(V)),D(H,m8(N))])})),[G,K]=D(d0(Z),EX([o$(),W8()],([B,H],z)=>{let[V,N]=p2(z);return q([D(B,i$(V)),D(H,m8(N))])}));if(!C(Q,G))return!1;J=Y,Z=K}return!0},Ix=($)=>{return Rx(V0($),W8())},Rx=($,X)=>{while(!0){let[J,Z]=D($,L6([o$(),W8()],([Y,G],K)=>{let[B,H]=p2(K);return[D(Y,i$(B)),D(G,m8(H))]})),Q=AX(J)>0?D(X,m0(J)):X;if(n3(Z))return f$(Q);$=Z,X=Q}throw Error(JX("Cause.flattenCauseLoop"))},L4=W(2,($,X)=>{let J=[$];while(J.length>0){let Z=J.pop(),Q=X(Z);switch(Q._tag){case"None":{switch(Z._tag){case CX:case _X:{J.push(Z.right),J.push(Z.left);break}}break}case"Some":return Q}}return T()});var p2=($)=>{let X=$,J=[],Z=o$(),Q=W8();while(X!==void 0)switch(X._tag){case T4:{if(J.length===0)return[Z,Q];X=J.pop();break}case MX:{if(Z=OX(Z,WJ(X._tag,X.error)),J.length===0)return[Z,Q];X=J.pop();break}case qX:{if(Z=OX(Z,WJ(X._tag,X.defect)),J.length===0)return[Z,Q];X=J.pop();break}case PX:{if(Z=OX(Z,WJ(X._tag,X.fiberId)),J.length===0)return[Z,Q];X=J.pop();break}case CX:{switch(X.left._tag){case T4:{X=X.right;break}case CX:{X=B0(X.left.left,B0(X.left.right,X.right));break}case _X:{X=z8(B0(X.left.left,X.right),B0(X.left.right,X.right));break}default:{Q=m0(Q,X.right),X=X.left;break}}break}case _X:{J.push(X.right),X=X.left;break}}throw Error(JX("Cause.evaluateCauseLoop"))};var Sx={emptyCase:b8,failCase:T8,dieCase:T8,interruptCase:b8,sequentialCase:($,X,J)=>X&&J,parallelCase:($,X,J)=>X&&J};var rN="SequentialCase",aN="ParallelCase",f5=W(2,($,{onDie:X,onEmpty:J,onFail:Z,onInterrupt:Q,onParallel:Y,onSequential:G})=>{return MQ($,void 0,{emptyCase:()=>J,failCase:(K,B)=>Z(B),dieCase:(K,B)=>X(B),interruptCase:(K,B)=>Q(B),sequentialCase:(K,B,H)=>G(B,H),parallelCase:(K,B,H)=>Y(B,H)})}),EX=W(3,($,X,J)=>{let Z=X,Q=$,Y=[];while(Q!==void 0){let G=J(Z,Q);switch(Z=w0(G)?G.value:Z,Q._tag){case CX:{Y.push(Q.right),Q=Q.left;break}case _X:{Y.push(Q.right),Q=Q.left;break}default:{Q=void 0;break}}if(Q===void 0&&Y.length>0)Q=Y.pop()}return Z}),MQ=W(3,($,X,J)=>{let Z=[$],Q=[];while(Z.length>0){let G=Z.pop();switch(G._tag){case T4:{Q.push(f(J.emptyCase(X)));break}case MX:{Q.push(f(J.failCase(X,G.error)));break}case qX:{Q.push(f(J.dieCase(X,G.defect)));break}case PX:{Q.push(f(J.interruptCase(X,G.fiberId)));break}case CX:{Z.push(G.right),Z.push(G.left),Q.push($0({_tag:rN}));break}case _X:{Z.push(G.right),Z.push(G.left),Q.push($0({_tag:aN}));break}}}let Y=[];while(Q.length>0){let G=Q.pop();switch(G._tag){case"Left":{switch(G.left._tag){case rN:{let K=Y.pop(),B=Y.pop(),H=J.sequentialCase(X,K,B);Y.push(H);break}case aN:{let K=Y.pop(),B=Y.pop(),H=J.parallelCase(X,K,B);Y.push(H);break}}break}case"Right":{Y.push(G.right);break}}}if(Y.length===0)throw Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return Y.pop()}),$6=($,X)=>{if(u5($))return"All fibers interrupted without errors.";return PQ($).map(function(J){if(X?.renderErrorCause!==!0||J.cause===void 0)return J.stack;return`${J.stack} {
${JA(J.cause,"  ")}
}`}).join(`
`)},JA=($,X)=>{let J=$.stack.split(`
`),Z=`${X}[cause]: ${J[0]}`;for(let Q=1,Y=J.length;Q<Y;Q++)Z+=`
${X}${J[Q]}`;if($.cause)Z+=` {
${JA($.cause,`${X}  `)}
${X}}`;return Z};class OQ extends globalThis.Error{span=void 0;constructor($){let X=typeof $==="object"&&$!==null,J=Error.stackTraceLimit;Error.stackTraceLimit=1;super(jx($),X&&"cause"in $&&typeof $.cause<"u"?{cause:new OQ($.cause)}:void 0);if(this.message==="")this.message="An error has occurred";if(Error.stackTraceLimit=J,this.name=$ instanceof Error?$.name:"Error",X){if(IX in $)this.span=$[IX];Object.keys($).forEach((Z)=>{if(!(Z in this))this[Z]=$[Z]})}this.stack=kx(`${this.name}: ${this.message}`,$ instanceof Error&&$.stack?$.stack:"",this.span)}}var jx=($)=>{if(typeof $==="string")return $;if(typeof $==="object"&&$!==null&&$ instanceof Error)return $.message;try{if(P($,"toString")&&w$($.toString)&&$.toString!==Object.prototype.toString&&$.toString!==globalThis.Array.prototype.toString)return $.toString()}catch{}return T9($)},xx=/\((.*)\)/g,CJ=j("effect/Tracer/spanToTrace",()=>new WeakMap),kx=($,X,J)=>{let Z=[$],Q=X.startsWith($)?X.slice($.length).split(`
`):X.split(`
`);for(let Y=1;Y<Q.length;Y++){if(Q[Y].includes(" at new BaseEffectError")||Q[Y].includes(" at new YieldableError")){Y++;continue}if(Q[Y].includes("Generator.next"))break;if(Q[Y].includes("effect_internal_function"))break;Z.push(Q[Y].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(J){let Y=J,G=0;while(Y&&Y._tag==="Span"&&G<10){let K=CJ.get(Y);if(typeof K==="function"){let B=K();if(typeof B==="string"){let H=B.matchAll(xx),z=!1;for(let[,V]of H)z=!0,Z.push(`    at ${Y.name} (${V})`);if(!z)Z.push(`    at ${Y.name} (${B.replace(/^at /,"")})`)}else Z.push(`    at ${Y.name}`)}else Z.push(`    at ${Y.name}`);Y=e0(Y.parent),G++}}return Z.join(`
`)},IX=Symbol.for("effect/SpanAnnotation"),PQ=($)=>MQ($,void 0,{emptyCase:()=>[],dieCase:(X,J)=>{return[new OQ(J)]},failCase:(X,J)=>{return[new OQ(J)]},interruptCase:()=>[],parallelCase:(X,J,Z)=>[...J,...Z],sequentialCase:(X,J,Z)=>[...J,...Z]});var RX="Pending",EJ="Done";var vx="effect/Deferred",QA=Symbol.for(vx),YA={_E:($)=>$,_A:($)=>$},GA=($)=>{return{_tag:RX,joiners:$}},a2=($)=>{return{_tag:EJ,effect:$}};class p5{self;called=!1;constructor($){this.self=$}next($){return this.called?{value:$,done:!0}:(this.called=!0,{value:this.self,done:!1})}return($){return{value:$,done:!0}}throw($){throw $}[Symbol.iterator](){return new p5(this.self)}}var R6=($,X)=>{let J=new T0("Blocked");return J.effect_instruction_i0=$,J.effect_instruction_i1=X,J},CQ=($)=>{let X=new T0("RunBlocked");return X.effect_instruction_i0=$,X},S6=Symbol.for("effect/Effect");class e2{patch;op;_op=JJ;constructor($,X){this.patch=$,this.op=X}}class T0{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[S6]=W4;constructor($){this._op=$}[I]($){return this===$}[R](){return b(this,$J(this))}pipe(){return M(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:u(this.effect_instruction_i0),effect_instruction_i1:u(this.effect_instruction_i1),effect_instruction_i2:u(this.effect_instruction_i2)}}toString(){return l(this.toJSON())}[g](){return this.toJSON()}[Symbol.iterator](){return new p5(new A6(this))}}class $K{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[S6]=W4;constructor($){this._op=$,this._tag=$}[I]($){return a5($)&&$._op==="Failure"&&C(this.effect_instruction_i0,$.effect_instruction_i0)}[R](){return D(s(this._tag),x(_(this.effect_instruction_i0)),b(this))}get cause(){return this.effect_instruction_i0}pipe(){return M(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return l(this.toJSON())}[g](){return this.toJSON()}[Symbol.iterator](){return new p5(new A6(this))}}class XK{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[S6]=W4;constructor($){this._op=$,this._tag=$}[I]($){return a5($)&&$._op==="Success"&&C(this.effect_instruction_i0,$.effect_instruction_i0)}[R](){return D(s(this._tag),x(_(this.effect_instruction_i0)),b(this))}get value(){return this.effect_instruction_i0}pipe(){return M(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:u(this.value)}}toString(){return l(this.toJSON())}[g](){return this.toJSON()}[Symbol.iterator](){return new p5(new A6(this))}}var o=($)=>P($,S6),m=($)=>{let X=new T0(M9);return X.effect_instruction_i0=$,X},EQ=W(3,($,X,J)=>N0((Z)=>U($,(Q)=>U(W0(S(()=>Z(X(Q)))),(Y)=>{return S(()=>J(Q,Y)).pipe(Q0({onFailure:(G)=>{switch(Y._tag){case A0:return h(B0(Y.effect_instruction_i0,G));case O0:return h(G)}},onSuccess:()=>Y}))})))),e=W(2,($,X)=>U($,()=>O(X))),U0=($)=>e($,void 0),SJ=function(){let $=new T0(YX);switch(arguments.length){case 2:{$.effect_instruction_i0=arguments[0],$.commit=arguments[1];break}case 3:{$.effect_instruction_i0=arguments[0],$.effect_instruction_i1=arguments[1],$.commit=arguments[2];break}case 4:{$.effect_instruction_i0=arguments[0],$.effect_instruction_i1=arguments[1],$.effect_instruction_i2=arguments[2],$.commit=arguments[3];break}default:throw Error(JX("you're not supposed to end up here"))}return $},n5=($,X=P8)=>{let J=new T0(QX),Z=void 0;return J.effect_instruction_i0=(Q)=>{Z=$(Q)},J.effect_instruction_i1=X,Z6(J,(Q)=>o(Z)?Z:k)},jJ=($,X=P8)=>S(()=>n5($,X)),Z8=($,X=P8)=>{return SJ($,function(){let J=void 0,Z=void 0;function Q(B){if(J)J(B);else if(Z===void 0)Z=B}let Y=new T0(QX);Y.effect_instruction_i0=(B)=>{if(J=B,Z)B(Z)},Y.effect_instruction_i1=X;let G=void 0,K=void 0;if(this.effect_instruction_i0.length!==1)K=new AbortController,G=D0(()=>this.effect_instruction_i0(Q,K.signal));else G=D0(()=>this.effect_instruction_i0(Q));return G||K?Z6(Y,(B)=>{if(K)K.abort();return G??k}):Y})};var X6=W(2,($,X)=>{let J=new T0(F5);return J.effect_instruction_i0=$,J.effect_instruction_i1=X,J}),u8=W(2,($,X)=>I0($,{onFailure:X,onSuccess:O})),xJ=W(3,($,X,J)=>X6($,(Z)=>{let Q=P$(Z);switch(Q._tag){case"Left":return X(Q.left)?J(Q.left):h(Z);case"Right":return h(Q.right)}})),UA=W(2,($,X)=>X6($,(J)=>{let Z=P$(J);switch(Z._tag){case"Left":return D(X(Z.left),S0(()=>h(J)));case"Right":return h(Z.right)}})),NA=($)=>m((X,J)=>$(qJ(J.runtimeFlags))),KA=Symbol.for("effect/OriginalAnnotation");var IQ=($,X)=>{if(w0(X))return new Proxy($,{has(J,Z){return Z===IX||Z===KA||Z in J},get(J,Z){if(Z===IX)return X.value;if(Z===KA)return $;return J[Z]}});return $},Q8=($)=>N6($)&&!(IX in $)?m((X)=>h(M0(IQ($,eQ(X))))):h(M0($)),M4=($)=>j6(()=>M0(new px($))),P4=($)=>U(w($),Q8),_8=($)=>I0($,{onFailure:(X)=>O($0(X)),onSuccess:(X)=>O(f(X))}),W0=($)=>kJ($,{onFailure:r,onSuccess:Z0}),v=($)=>N6($)&&!(IX in $)?m((X)=>h(I6(IQ($,eQ(X))))):h(I6($)),G$=($)=>U(w($),v),h=($)=>{let X=new $K(A0);return X.effect_instruction_i0=$,X},j6=($)=>U(w($),h),x6=m(($)=>O($.id())),C8=($)=>m((X)=>$(X.id())),U=W(2,($,X)=>{let J=new T0(T5);return J.effect_instruction_i0=$,J.effect_instruction_i1=X,J}),_4=W(2,($,X)=>U($,(J)=>{let Z=typeof X==="function"?X(J):X;if(o(Z))return Z;else if(K3(Z))return n5((Q)=>{Z.then((Y)=>Q(O(Y)),(Y)=>Q(v(new dJ(Y,"An unknown error occurred in Effect.andThen"))))});return O(Z)})),RQ=($)=>{let X=new T0("OnStep");return X.effect_instruction_i0=$,X},E8=($)=>U($,y),C4=($)=>I0($,{onFailure:O,onSuccess:v}),kJ=W(2,($,X)=>Q0($,{onFailure:(J)=>O(X.onFailure(J)),onSuccess:(J)=>O(X.onSuccess(J))})),Q0=W(2,($,X)=>{let J=new T0(L5);return J.effect_instruction_i0=$,J.effect_instruction_i1=X.onFailure,J.effect_instruction_i2=X.onSuccess,J}),I0=W(2,($,X)=>Q0($,{onFailure:(J)=>{if(LQ(J).length>0)return h($A(J));let Q=PJ(J);if(Q.length>0)return X.onFailure(l3(Q));return h(J)},onSuccess:X.onSuccess})),n0=W(2,($,X)=>S(()=>{let J=c($),Z=KJ(J.length),Q=0;return e(I4({while:()=>Q<J.length,body:()=>X(J[Q],Q),step:(Y)=>{Z[Q++]=Y}}),Z)})),f8=W(2,($,X)=>S(()=>{let J=c($),Z=0;return I4({while:()=>Z<J.length,body:()=>X(J[Z],Z),step:()=>{Z++}})})),SQ=W(($)=>typeof $[0]==="boolean"||o($[0]),($,X)=>o($)?U($,(J)=>J?X.onTrue():X.onFalse()):$?X.onTrue():X.onFalse()),jQ=U(x6,($)=>xQ($)),xQ=($)=>h(c8($)),k6=($)=>{let X=new T0(w6);return X.effect_instruction_i0=y2(M$),X.effect_instruction_i1=()=>$,X},AA=($)=>SJ($,function(){let X=new T0(w6);return X.effect_instruction_i0=y2(M$),X.effect_instruction_i1=(J)=>qJ(J)?D0(()=>this.effect_instruction_i0(k6)):D0(()=>this.effect_instruction_i0(y6)),X}),J6=W(2,($,X)=>N0((J)=>U(W0(J($)),(Z)=>UK(X,Z)))),L=W(2,($,X)=>U($,(J)=>w(()=>X(J)))),vJ=W(2,($,X)=>I0($,{onFailure:(J)=>G$(()=>X.onFailure(J)),onSuccess:(J)=>w(()=>X.onSuccess(J))})),v6=W(2,($,X)=>Q0($,{onFailure:(J)=>{let Z=P$(J);switch(Z._tag){case"Left":return G$(()=>X(Z.left));case"Right":return h(Z.right)}},onSuccess:O})),kQ=W(2,($,X)=>D8($,(J)=>aQ(J)?k:X(J.effect_instruction_i0))),D8=W(2,($,X)=>N0((J)=>Q0(J($),{onFailure:(Z)=>{let Q=r(Z);return Q0(X(Q),{onFailure:(Y)=>r(B0(Z,Y)),onSuccess:()=>Q})},onSuccess:(Z)=>{let Q=Z0(Z);return p(X(Q),Q)}}))),Z6=W(2,($,X)=>D8($,s5({onFailure:(J)=>u5(J)?U0(X(_J(J))):k,onSuccess:()=>k}))),jX=W(2,($,X)=>hx($,X,O)),xX=($)=>JK($,y),JK=W(2,($,X)=>I0($,{onFailure:(J)=>Q8(X(J)),onSuccess:O})),OA=k3,l5=m(($,X)=>O(X.runtimeFlags)),O=($)=>{let X=new XK(O0);return X.effect_instruction_i0=$,X},S=($)=>{let X=new T0(YX);return X.commit=$,X},w=($)=>{let X=new T0(q9);return X.effect_instruction_i0=$,X},V8=W(($)=>$.length===3||$.length===2&&!(N6($[1])&&("onlyEffect"in $[1])),($,X)=>U($,(J)=>{let Z=typeof X==="function"?X(J):X;if(o(Z))return e(Z,J);else if(K3(Z))return n5((Q)=>{Z.then((Y)=>Q(O(J)),(Y)=>Q(v(new dJ(Y,"An unknown error occurred in Effect.tap"))))});return O(J)})),vQ=($)=>m((X)=>{let J=X.getFiberRef(RJ),Z=D(J,S0(()=>X.scope()));return $(H0(RJ,q(Z)))}),hx=W(3,($,X,J)=>Q0($,{onFailure:(Z)=>{if(LQ(Z).length>0)return h(bV(eN(Z)));return X()},onSuccess:J})),y6=($)=>{let X=new T0(w6);return X.effect_instruction_i0=b2(M$),X.effect_instruction_i1=()=>$,X},N0=($)=>SJ($,function(){let X=new T0(w6);return X.effect_instruction_i0=b2(M$),X.effect_instruction_i1=(J)=>qJ(J)?D0(()=>this.effect_instruction_i0(k6)):D0(()=>this.effect_instruction_i0(y6)),X}),k=O(void 0);var E4=($)=>{let X=new T0(w6);return X.effect_instruction_i0=$,X.effect_instruction_i1=void 0,X},o5=W(2,($,X)=>U(X,(J)=>{if(J)return D($,L(q));return O(T())})),I4=($)=>{let X=new T0(q5);return X.effect_instruction_i0=$.while,X.effect_instruction_i1=$.body,X.effect_instruction_i2=$.step,X},IJ=($)=>S(()=>{let X=new T0(GX);return X.effect_instruction_i0=$(),X}),yQ=function(){let $=arguments.length===1?arguments[0]:arguments[1].bind(arguments[0]);return IJ(()=>$(D))},i5=($,...X)=>Object.defineProperty(X.length===0?function(...J){return IJ(()=>$.apply(this,J))}:function(...J){let Z=IJ(()=>$.apply(this,J));for(let Q of X)Z=Q(Z,...J);return Z},"length",{value:$.length,configurable:!0}),wA=W(2,($,X)=>H0($,fQ,X)),FA=W(2,($,X)=>H0($,bJ,X)),bQ=W(2,($,X)=>{let J=new T0(w6);return J.effect_instruction_i0=X,J.effect_instruction_i1=()=>$,J}),TA=W(2,($,X)=>H0($,hJ,X)),LA=W(2,($,X)=>H0($,S4,X)),Q6=($)=>{let X=new T0(M5);return typeof $?.priority<"u"?HK(X,$.priority):X},kX=W(2,($,X)=>U($,(J)=>L(X,(Z)=>[J,Z])));var vX=W(2,($,X)=>U($,(J)=>e(X,J))),p=W(2,($,X)=>U($,()=>X)),Y6=W(3,($,X,J)=>U($,(Z)=>L(X,(Q)=>J(Z,Q)))),R4=jJ(()=>{let $=setInterval(()=>{},2147483647);return w(()=>clearInterval($))}),yJ=($)=>U(x6,(X)=>D($,I8(X))),I8=W(2,($,X)=>U($.interruptAsFork(X),()=>$.await)),ZK={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return M(this,arguments)}},QK={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:50000,pipe(){return M(this,arguments)}},YK={_tag:"Error",syslog:3,label:"ERROR",ordinal:40000,pipe(){return M(this,arguments)}},gQ={_tag:"Warning",syslog:4,label:"WARN",ordinal:30000,pipe(){return M(this,arguments)}},hQ={_tag:"Info",syslog:6,label:"INFO",ordinal:20000,pipe(){return M(this,arguments)}},mQ={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return M(this,arguments)}},GK={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return M(this,arguments)}},KK={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return M(this,arguments)}},BK=[ZK,GK,mQ,hQ,gQ,YK,QK,KK],mx="effect/FiberRef",dx=Symbol.for(mx),cx={_A:($)=>$},p8=($)=>m((X)=>Z0(X.getFiberRef($)));var l0=W(2,($,X)=>U(p8($),X)),SX=W(2,($,X)=>ux($,()=>[void 0,X]));var ux=W(2,($,X)=>m((J)=>{let[Z,Q]=X(J.getFiberRef($));return J.setFiberRef($,Q),O(Z)}));var H0=W(3,($,X,J)=>EQ(vX(p8(X),SX(X,J)),()=>$,(Z)=>SX(X,Z))),R0=W(3,($,X,J)=>l0(X,(Z)=>H0($,X,J(Z)))),z0=($,X)=>yX($,{differ:WQ(),fork:X?.fork??y,join:X?.join}),qA=($)=>{let X=P2();return yX($,{differ:X,fork:X.empty})},fx=($)=>{let X=_2(WQ());return yX($,{differ:X,fork:X.empty})},dQ=($)=>{let X=M2();return yX($,{differ:X,fork:X.empty})},yX=($,X)=>{return{...F$,[dx]:cx,initial:$,commit(){return p8(this)},diff:(Z,Q)=>X.differ.diff(Z,Q),combine:(Z,Q)=>X.differ.combine(Z,Q),patch:(Z)=>(Q)=>X.differ.patch(Z,Q),fork:X.fork,join:X.join??((Z,Q)=>Q)}},MA=($)=>yX($,{differ:v2,fork:v2.empty}),R8=j(Symbol.for("effect/FiberRef/currentContext"),()=>dQ(h0())),b6=j(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>z0(0)),cQ=j(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>z0(2048)),g6=j(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>z0(FX())),WK=j(Symbol.for("effect/FiberRef/currentLogLevel"),()=>z0(hQ)),uQ=j(Symbol.for("effect/FiberRef/currentLogSpan"),()=>z0(e$())),HK=W(2,($,X)=>H0($,b6,X)),PA=W(2,($,X)=>H0($,cQ,X)),fQ=j(Symbol.for("effect/FiberRef/currentConcurrency"),()=>z0("unbounded")),bJ=j(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>z0(!0)),gJ=j(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>z0(q(mQ))),pQ=j(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>z0(q(gQ))),_A=W(2,($,X)=>H0($,gJ,X)),h6=j(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>fx(h8())),CA=p8(h6),RJ=j(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>z0(T(),{fork:()=>T(),join:($,X)=>$})),bX=j(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>z0(H8,{fork:()=>H8,join:($,X)=>$})),hJ=j(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>z0(!0)),S4=j(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>z0(!0)),r5=j(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>z0(FX())),nQ=j(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>z0(W8())),lQ=Symbol.for("effect/Scope"),oQ=Symbol.for("effect/CloseableScope"),iQ=($,X)=>$.addFinalizer(()=>U0(X)),gX=($,X)=>$.addFinalizer(X),hX=($,X)=>$.close(X),n8=($,X)=>$.fork(X);var rQ=function(){class $ extends globalThis.Error{commit(){return v(this)}toJSON(){let X={...this};if(this.message)X.message=this.message;if(this.cause)X.cause=this.cause;return X}[g](){if(this.toString!==globalThis.Error.prototype.toString)return this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString();else if("Bun"in globalThis)return $6(I6(this),{renderErrorCause:!0});return this}}return Object.assign($.prototype,U3),$}(),mX=($,X)=>{class J extends rQ{_tag=X}return Object.assign(J.prototype,$),J.prototype.name=X,J},BA=Symbol.for("effect/Cause/errors/RuntimeException"),px=mX({[BA]:BA},"RuntimeException");var s2=Symbol.for("effect/Cause/errors/InterruptedException"),O$0=mX({[s2]:s2},"InterruptedException"),EA=($)=>P($,s2),WA=Symbol.for("effect/Cause/errors/IllegalArgument"),mJ=mX({[WA]:WA},"IllegalArgumentException");var t2=Symbol.for("effect/Cause/errors/NoSuchElement"),l8=mX({[t2]:t2},"NoSuchElementException"),IA=($)=>P($,t2),HA=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),w$0=mX({[HA]:HA},"InvalidPubSubCapacityException"),zA=Symbol.for("effect/Cause/errors/ExceededCapacityException"),F$0=mX({[zA]:zA},"ExceededCapacityException");var DA=Symbol.for("effect/Cause/errors/Timeout"),nx=mX({[DA]:DA},"TimeoutException"),RA=($)=>new nx(`Operation timed out after '${t3($)}'`);var VA=Symbol.for("effect/Cause/errors/UnknownException"),dJ=function(){class $ extends rQ{_tag="UnknownException";error;constructor(X,J){super(J??"An unknown error occurred",{cause:X});this.error=X}}return Object.assign($.prototype,{[VA]:VA,name:"UnknownException"}),$}();var a5=($)=>o($)&&("_tag"in $)&&($._tag==="Success"||$._tag==="Failure"),zK=($)=>$._tag==="Failure",aQ=($)=>$._tag==="Success";var SA=W(2,($,X)=>{switch($._tag){case A0:return r($.effect_instruction_i0);case O0:return Z0(X)}}),cJ=($)=>SA($,void 0);var dX=($,X)=>lx($,X?.parallel?z8:B0),DK=($)=>r(M0($));var uJ=($)=>r(I6($)),r=($)=>{let X=new $K(A0);return X.effect_instruction_i0=$,X},jA=W(2,($,X)=>{switch($._tag){case A0:return r($.effect_instruction_i0);case O0:return X($.effect_instruction_i0)}});var xA=($)=>D($,jA(y));var sQ=($)=>r(c8($)),_Q=W(2,($,X)=>{switch($._tag){case A0:return r($.effect_instruction_i0);case O0:return Z0(X($.effect_instruction_i0))}});var s5=W(2,($,{onFailure:X,onSuccess:J})=>{switch($._tag){case A0:return X($.effect_instruction_i0);case O0:return J($.effect_instruction_i0)}}),t5=W(2,($,{onFailure:X,onSuccess:J})=>{switch($._tag){case A0:return X($.effect_instruction_i0);case O0:return J($.effect_instruction_i0)}}),Z0=($)=>{let X=new XK(O0);return X.effect_instruction_i0=$,X},U8=Z0(void 0);var fJ=W(3,($,X,{onFailure:J,onSuccess:Z})=>{switch($._tag){case A0:switch(X._tag){case O0:return r($.effect_instruction_i0);case A0:return r(J($.effect_instruction_i0,X.effect_instruction_i0))}case O0:switch(X._tag){case O0:return Z0(Z($.effect_instruction_i0,X.effect_instruction_i0));case A0:return r(X.effect_instruction_i0)}}}),lx=($,X)=>{let J=j5($);if(!p0(J))return T();return D(X8(J),L6(D(d0(J),_Q(V0)),(Z,Q)=>D(Z,fJ(Q,{onSuccess:(Y,G)=>D(Y,m0(G)),onFailure:X}))),_Q(f$),_Q((Z)=>d8(Z)),q)},pJ=($)=>{return{...F$,[QA]:YA,state:a$(GA([])),commit(){return v0(this)},blockingOn:$}},o8=()=>U(x6,($)=>kA($)),kA=($)=>w(()=>pJ($)),v0=($)=>jJ((X)=>{let J=s$($.state);switch(J._tag){case EJ:return X(J.effect);case RX:return J.joiners.push(X),ox($,X)}},$.blockingOn),VK=W(2,($,X)=>J6(X,$)),nJ=W(2,($,X)=>w(()=>{let J=s$($.state);switch(J._tag){case EJ:return!1;case RX:{M6($.state,a2(X));for(let Z=0,Q=J.joiners.length;Z<Q;Z++)J.joiners[Z](X);return!0}}})),UK=W(2,($,X)=>nJ($,X));var lJ=W(2,($,X)=>nJ($,h(X)));var vA=($)=>U(x6,(X)=>nJ($,xQ(X)));var NK=W(2,($,X)=>nJ($,O(X)));var oJ=($,X)=>{let J=s$($.state);if(J._tag===RX){M6($.state,a2(X));for(let Z=0,Q=J.joiners.length;Z<Q;Z++)J.joiners[Z](X)}},ox=($,X)=>w(()=>{let J=s$($.state);if(J._tag===RX){let Z=J.joiners.indexOf(X);if(Z>=0)J.joiners.splice(Z,1)}}),ix=m(($)=>Z0($.currentContext)),S8=()=>ix;var K$=($)=>U(S8(),$),i8=W(2,($,X)=>H0(R8,X)($)),tQ=W(2,($,X)=>R0(R8,(J)=>Z$(J,X))($)),cX=W(2,($,X)=>K$((J)=>i8($,X(J)))),AK=W(2,($,X)=>U($,(J)=>U(X.predicate(J),(Z)=>Z?O(J):X.orElse(J)))),yA=W(2,($,X)=>AK($,{predicate:X.predicate,orElse:(J)=>v(X.orFailWith(J))})),eQ=($)=>{let X=$.currentSpan;return X!==void 0&&X._tag==="Span"?q(X):T()},rx={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:U8},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},bA=($)=>Object.assign(Object.create(rx),$);var iJ=v0;var gA=UK;var hA=vA;var OK=pJ;var dA=xA;var cA=Z0;var uA=Symbol.for("effect/MutableHashMap"),ax={[uA]:uA,[Symbol.iterator](){return new FK(this)},toString(){return l(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(u)}},[g](){return this.toJSON()},pipe(){return M(this,arguments)}};class FK{self;referentialIterator;bucketIterator;constructor($){this.self=$,this.referentialIterator=$.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();let $=this.referentialIterator.next();if($.done)return this.bucketIterator=new fA(this.self.buckets.values()),this.next();return $}[Symbol.iterator](){return new FK(this.self)}}class fA{backing;constructor($){this.backing=$}currentBucket;next(){if(this.currentBucket===void 0){let X=this.backing.next();if(X.done)return X;this.currentBucket=X.value[Symbol.iterator]()}let $=this.currentBucket.next();if($.done)return this.currentBucket=void 0,this.next();return $}}var uX=()=>{let $=Object.create(ax);return $.referential=new Map,$.buckets=new Map,$.bucketsSize=0,$};var P0=W(2,($,X)=>{if(w5(X)===!1)return $.referential.has(X)?q($.referential.get(X)):T();let J=X[R](),Z=$.buckets.get(J);if(Z===void 0)return T();return sx($,Z,X)});var sx=($,X,J,Z=!1)=>{for(let Q=0,Y=X.length;Q<Y;Q++)if(J[I](X[Q][0])){let G=X[Q][1];if(Z)X.splice(Q,1),$.bucketsSize--;return q(G)}return T()},_$=W(2,($,X)=>w0(P0($,X))),j8=W(3,($,X,J)=>{if(w5(X)===!1)return $.referential.set(X,J),$;let Z=X[R](),Q=$.buckets.get(Z);if(Q===void 0)return $.buckets.set(Z,[[X,J]]),$.bucketsSize++,$;return pA($,Q,X),Q.push([X,J]),$.bucketsSize++,$}),pA=($,X,J)=>{for(let Z=0,Q=X.length;Z<Q;Z++)if(J[I](X[Z][0])){X.splice(Z,1),$.bucketsSize--;return}};var fX=W(2,($,X)=>{if(w5(X)===!1)return $.referential.delete(X),$;let J=X[R](),Z=$.buckets.get(J);if(Z===void 0)return $;if(pA($,Z,X),Z.length===0)$.buckets.delete(J);return $});var $1=($)=>{return $.referential.size+$.bucketsSize};var nA=Symbol.for("effect/MutableList"),tx={[nA]:nA,[Symbol.iterator](){let $=!1,X=this.head;return{next(){if($)return this.return();if(X==null)return $=!0,this.return();let J=X.value;return X=X.next,{done:$,value:J}},return(J){if(!$)$=!0;return{done:!0,value:J}}}},toString(){return l(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(u)}},[g](){return this.toJSON()},pipe(){return M(this,arguments)}},ex=($)=>({value:$,removed:!1,prev:void 0,next:void 0}),lA=()=>{let $=Object.create(tx);return $.head=void 0,$.tail=void 0,$._length=0,$};var oA=($)=>TK($)===0,TK=($)=>$._length;var iA=W(2,($,X)=>{let J=ex(X);if($.head===void 0)$.head=J;if($.tail===void 0)$.tail=J;else $.tail.next=J,J.prev=$.tail,$.tail=J;return $._length+=1,$}),rA=($)=>{let X=$.head;if(X!==void 0)return $k($,X),X.value;return};var $k=($,X)=>{if(X.removed)return;if(X.removed=!0,X.prev!==void 0&&X.next!==void 0)X.prev.next=X.next,X.next.prev=X.prev;else if(X.prev!==void 0)$.tail=X.prev,X.prev.next=void 0;else if(X.next!==void 0)$.head=X.next,X.next.prev=void 0;else $.tail=void 0,$.head=void 0;if($._length>0)$._length-=1};var sA=Symbol.for("effect/MutableQueue"),LK=Symbol.for("effect/mutable/MutableQueue/Empty"),Xk={[sA]:sA,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return l(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(u)}},[g](){return this.toJSON()},pipe(){return M(this,arguments)}},Jk=($)=>{let X=Object.create(Xk);return X.queue=lA(),X.capacity=$,X};var tA=()=>Jk(void 0);var eA=W(2,($,X)=>{let J=TK($.queue);if($.capacity!==void 0&&J===$.capacity)return!1;return iA(X)($.queue),!0});var $O=W(2,($,X)=>{if(oA($.queue))return X;return rA($.queue)});var Zk="effect/Clock",qK=Symbol.for(Zk),N8=x0("effect/Clock"),Qk=2147483647,JO={unsafeSchedule($,X){let J=n$(X);if(J>Qk)return T8;let Z=!1,Q=setTimeout(()=>{Z=!0,$()},J);return()=>{return clearTimeout(Q),!Z}}},ZO=function(){let $=BigInt(1e6);if(typeof performance>"u"||typeof performance.now!=="function")return()=>BigInt(Date.now())*$;let X;return()=>{if(X===void 0)X=BigInt(Date.now())*$-BigInt(Math.round(performance.now()*1e6));return X+BigInt(Math.round(performance.now()*1e6))}}(),Yk=function(){let $=typeof process==="object"&&"hrtime"in process&&typeof process.hrtime.bigint==="function"?process.hrtime:void 0;if(!$)return ZO;let X=ZO()-$.bigint();return()=>X+$.bigint()}();class QO{[qK]=qK;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return Yk()}currentTimeMillis=w(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=w(()=>this.unsafeCurrentTimeNanos());scheduler(){return O(JO)}sleep($){return Z8((X)=>{let J=JO.unsafeSchedule(()=>X(k),$);return U0(w(J))})}}var MK=()=>new QO;var J1="And",Z1="Or",Q1="InvalidData",Y1="MissingData",G1="SourceUnavailable",K1="Unsupported";var Kk="effect/ConfigError",_K=Symbol.for(Kk),e5={_tag:"ConfigError",[_K]:_K},rJ=($,X)=>{let J=Object.create(e5);return J._op=J1,J.left=$,J.right=X,Object.defineProperty(J,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(J,"message",{enumerable:!1,get(){return this.toString()}}),J},aJ=($,X)=>{let J=Object.create(e5);return J._op=Z1,J.left=$,J.right=X,Object.defineProperty(J,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(J,"message",{enumerable:!1,get(){return this.toString()}}),J},A8=($,X,J={pathDelim:"."})=>{let Z=Object.create(e5);return Z._op=Q1,Z.path=$,Z.message=X,Object.defineProperty(Z,"toString",{enumerable:!1,value(){return`(Invalid data at ${D(this.path,d$(J.pathDelim))}: "${this.message}")`}}),Z},r8=($,X,J={pathDelim:"."})=>{let Z=Object.create(e5);return Z._op=Y1,Z.path=$,Z.message=X,Object.defineProperty(Z,"toString",{enumerable:!1,value(){return`(Missing data at ${D(this.path,d$(J.pathDelim))}: "${this.message}")`}}),Z},YO=($,X,J,Z={pathDelim:"."})=>{let Q=Object.create(e5);return Q._op=G1,Q.path=$,Q.message=X,Q.cause=J,Object.defineProperty(Q,"toString",{enumerable:!1,value(){return`(Source unavailable at ${D(this.path,d$(Z.pathDelim))}: "${this.message}")`}}),Q},B1=($,X,J={pathDelim:"."})=>{let Z=Object.create(e5);return Z._op=K1,Z.path=$,Z.message=X,Object.defineProperty(Z,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${D(this.path,d$(J.pathDelim))}: "${this.message}")`}}),Z};var m6=W(2,($,X)=>{switch($._op){case J1:return rJ(m6($.left,X),m6($.right,X));case Z1:return aJ(m6($.left,X),m6($.right,X));case Q1:return A8([...X,...$.path],$.message);case Y1:return r8([...X,...$.path],$.message);case G1:return YO([...X,...$.path],$.message,$.cause);case K1:return B1([...X,...$.path],$.message)}}),Bk={andCase:($,X,J)=>X&&J,orCase:($,X,J)=>X&&J,invalidDataCase:T8,missingDataCase:b8,sourceUnavailableCase:T8,unsupportedCase:T8},GO=W(3,($,X,J)=>{let Z=[$],Q=[];while(Z.length>0){let G=Z.pop();switch(G._op){case J1:{Z.push(G.right),Z.push(G.left),Q.push($0({_op:"AndCase"}));break}case Z1:{Z.push(G.right),Z.push(G.left),Q.push($0({_op:"OrCase"}));break}case Q1:{Q.push(f(J.invalidDataCase(X,G.path,G.message)));break}case Y1:{Q.push(f(J.missingDataCase(X,G.path,G.message)));break}case G1:{Q.push(f(J.sourceUnavailableCase(X,G.path,G.message,G.cause)));break}case K1:{Q.push(f(J.unsupportedCase(X,G.path,G.message)));break}}}let Y=[];while(Q.length>0){let G=Q.pop();switch(G._op){case"Left":{switch(G.left._op){case"AndCase":{let K=Y.pop(),B=Y.pop(),H=J.andCase(X,K,B);Y.push(H);break}case"OrCase":{let K=Y.pop(),B=Y.pop(),H=J.orCase(X,K,B);Y.push(H);break}}break}case"Right":{Y.push(G.right);break}}}if(Y.length===0)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return Y.pop()}),KO=($)=>GO($,void 0,Bk);var H1={_tag:"Empty"},CK=W(2,($,X)=>({_tag:"AndThen",first:$,second:X})),BO=W(2,($,X)=>CK($,{_tag:"MapName",f:X})),WO=W(2,($,X)=>CK($,{_tag:"Nested",name:X})),HO=W(2,($,X)=>CK($,{_tag:"Unnested",name:X})),j4=W(2,($,X)=>{let J=NJ(X),Z=$;while(O2(J)){let Q=J.head;switch(Q._tag){case"Empty":{J=J.tail;break}case"AndThen":{J=P6(Q.first,P6(Q.second,J.tail));break}case"MapName":{Z=L$(Z,Q.f),J=J.tail;break}case"Nested":{Z=_5(Z,Q.name),J=J.tail;break}case"Unnested":{if(D(D4(Z),hV(Q.name)))Z=m$(Z),J=J.tail;else return $0(r8(Z,`Expected ${Q.name} to be in path in ConfigProvider#unnested`));break}}}return f(Z)});var z1="Constant",D1="Fail",sJ="Fallback",V1="Described",U1="Lazy",N1="MapOrFail",A1="Nested",O1="Primitive",w1="Sequence",F1="HashMap",T1="ZipWith";var EK=($)=>$.toLowerCase(),IK=($)=>$.toUpperCase(),DO=($,X,J)=>X instanceof RegExp?$.replace(X,J):X.reduce((Z,Q)=>Z.replace(Q,J),$),Hk=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],zk=/[^A-Z0-9]+/gi,RK=($,X={})=>{let{delimiter:J=" ",splitRegexp:Z=Hk,stripRegexp:Q=zk,transform:Y=EK}=X,G=DO(DO($,Z,"$1\x00$2"),Q,"\x00"),K=0,B=G.length;while(G.charAt(K)==="\x00")K++;while(G.charAt(B-1)==="\x00")B--;return G.slice(K,B).split("\x00").map(Y).join(J)};var VO=($,X)=>RK($,{delimiter:"_",transform:IK,...X}),UO=($,X)=>RK($,{delimiter:"-",...X}),NO=($,X)=>RK($,{delimiter:"_",...X});var L1=($,X)=>[...$,...X],Vk="effect/ConfigProvider",q1=Symbol.for(Vk),x4=x0("effect/ConfigProvider"),Uk="effect/ConfigProviderFlat",M1=Symbol.for(Uk),SK=($)=>({[q1]:q1,pipe(){return M(this,arguments)},...$}),k4=($)=>({[M1]:M1,patch:$.patch,load:(X,J,Z=!0)=>$.load(X,J,Z),enumerateChildren:$.enumerateChildren}),v4=($)=>SK({load:(X)=>U(B$($,h8(),X,!1),(J)=>C0(D4(J),{onNone:()=>v(r8(h8(),`Expected a single value having structure: ${X}`)),onSome:O})),flattened:$}),P1=($)=>{let{pathDelim:X,seqDelim:J}=Object.assign({},{pathDelim:"_",seqDelim:","},$),Z=(B)=>D(B,d$(X)),Q=(B)=>B.split(X),Y=()=>typeof process<"u"&&("env"in process)&&typeof process.env==="object"?process.env:{};return v4(k4({load:(B,H,z=!0)=>{let V=Z(B),N=Y(),A=V in N?q(N[V]):T();return D(A,v6(()=>r8(B,`Expected ${V} to exist in the process context`)),U((F)=>qO(F,B,H,J,z)))},enumerateChildren:(B)=>w(()=>{let H=Y(),N=Object.keys(H).map((A)=>Q(A.toUpperCase())).filter((A)=>{for(let F=0;F<B.length;F++){let E=D(B,I9(F)),d=A[F];if(d===void 0||E!==d)return!1}return!0}).flatMap((A)=>A.slice(B.length,B.length+1));return UX(N)}),patch:H1}))},jK=($,X)=>{let{pathDelim:J,seqDelim:Z}=Object.assign({seqDelim:",",pathDelim:"."},X),Q=(H)=>D(H,d$(J)),Y=(H)=>H.split(J),G=Ck($,(H)=>Y(H),Q);return v4(k4({load:(H,z,V=!0)=>{let N=Q(H),A=G.has(N)?q(G.get(N)):T();return D(A,v6(()=>r8(H,`Expected ${N} to exist in the provided map`)),U((F)=>qO(F,H,z,Z,V)))},enumerateChildren:(H)=>w(()=>{let V=c(G.keys()).map(Y).filter((N)=>{for(let A=0;A<H.length;A++){let F=D(H,I9(A)),E=N[A];if(E===void 0||F!==E)return!1}return!0}).flatMap((N)=>N.slice(H.length,H.length+1));return UX(V)}),patch:H1}))},Nk=($,X,J,Z)=>{let Q=v3(J.length,(B)=>B>=Z.length?T():q([$(B),B+1])),Y=v3(Z.length,(B)=>B>=J.length?T():q([X(B),B+1])),G=L1(J,Q),K=L1(Z,Y);return[G,K]},Ak=($,X)=>{let J=X;if(J._tag==="Nested"){let Z=$.slice();while(J._tag==="Nested")Z.push(J.name),J=J.config;return Z}return $},B$=($,X,J,Z)=>{let Q=J;switch(Q._tag){case z1:return O($8(Q.value));case V1:return S(()=>B$($,X,Q.config,Z));case D1:return v(r8(X,Q.message));case sJ:return D(S(()=>B$($,X,Q.first,Z)),u8((Y)=>{if(Q.condition(Y))return D(B$($,X,Q.second,Z),u8((G)=>v(aJ(Y,G))));return v(Y)}));case U1:return S(()=>B$($,X,Q.config(),Z));case N1:return S(()=>D(B$($,X,Q.original,Z),U(n0((Y)=>D(Q.mapOrFail(Y),v6(m6(Ak(X,Q.original))))))));case A1:return S(()=>B$($,L1(X,$8(Q.name)),Q.config,Z));case O1:return D(j4(X,$.patch),U((Y)=>D($.load(Y,Q,Z),U((G)=>{if(G.length===0){let K=D(nV(Y),S0(()=>"<n/a>"));return v(r8([],`Expected ${Q.description} with name ${K}`))}return O(G)}))));case w1:return D(j4(X,$.patch),U((Y)=>D($.enumerateChildren(Y),U(qk),U((G)=>{if(G.length===0)return S(()=>L(B$($,X,Q.config,!0),$8));return D(n0(G,(K)=>B$($,C9(X,`[${K}]`),Q.config,!0)),L((K)=>{let B=S9(K);if(B.length===0)return $8(h8());return $8(B)}))}))));case F1:return S(()=>D(j4(X,$.patch),U((Y)=>D($.enumerateChildren(Y),U((G)=>{return D(G,n0((K)=>B$($,L1(Y,$8(K)),Q.valueConfig,Z)),L((K)=>{if(K.length===0)return $8(FX());return D(Lk(K),L$((B)=>zN(x3(c(G),B))))}))})))));case T1:return S(()=>D(B$($,X,Q.left,Z),_8,U((Y)=>D(B$($,X,Q.right,Z),_8,U((G)=>{if(B8(Y)&&B8(G))return v(rJ(Y.left,G.left));if(B8(Y)&&b$(G))return v(Y.left);if(b$(Y)&&B8(G))return v(G.left);if(b$(Y)&&b$(G)){let K=D(X,d$(".")),B=Ok(X,K),[H,z]=Nk(B,B,D(Y.right,L$(f)),D(G.right,L$(f)));return D(H,x3(z),n0(([V,N])=>D(kX(V,N),L(([A,F])=>Q.zip(A,F)))))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},Ok=($,X)=>(J)=>$0(r8($,`The element at index ${J} in a sequence at path "${X}" was missing`)),pX=W(2,($,X)=>v4(wk($.flattened,X))),wk=($,X)=>k4({load:(J,Z,Q=!0)=>$.load(J,Z,Q),enumerateChildren:(J)=>$.enumerateChildren(J),patch:BO($.patch,X)}),xK=W(2,($,X)=>v4(k4({load:(J,Z)=>$.flattened.load(J,Z,!0),enumerateChildren:(J)=>$.flattened.enumerateChildren(J),patch:WO($.flattened.patch,X)}))),kK=W(2,($,X)=>v4(k4({load:(J,Z)=>$.flattened.load(J,Z,!0),enumerateChildren:(J)=>$.flattened.enumerateChildren(J),patch:HO($.flattened.patch,X)}))),vK=W(2,($,X)=>v4(Fk($.flattened,()=>X().flattened))),Fk=($,X)=>k4({load:(J,Z,Q)=>D(j4(J,$.patch),U((Y)=>$.load(Y,Z,Q)),u8((Y)=>D(w(X),U((G)=>D(j4(J,G.patch),U((K)=>G.load(K,Z,Q)),u8((K)=>v(aJ(Y,K)))))))),enumerateChildren:(J)=>D(j4(J,$.patch),U((Z)=>$.enumerateChildren(Z)),_8,U((Z)=>D(w(X),U((Q)=>D(j4(J,Q.patch),U((Y)=>Q.enumerateChildren(Y)),_8,U((Y)=>{if(B8(Z)&&B8(Y))return v(rJ(Z.left,Y.left));if(B8(Z)&&b$(Y))return O(Y.right);if(b$(Z)&&B8(Y))return O(Z.right);if(b$(Z)&&b$(Y))return O(D(Z.right,i$(Y.right)));throw Error("BUG: ConfigProvider.orElseFlat - please report an issue at https://github.com/Effect-TS/effect/issues")})))))),patch:H1}),AO=($)=>pX($,VO),OO=($)=>pX($,UO),wO=($)=>pX($,EK),FO=($)=>pX($,NO),TO=($)=>pX($,IK),LO=W(3,($,X,J)=>{let Z=L6(X,$,(Y,G)=>kK(Y,G)),Q=BJ(X,J(Z),(Y,G)=>xK(Y,G));return vK(Q,()=>$)}),Tk=($,X)=>{return $.split(new RegExp(`\\s*${sV(X)}\\s*`))},qO=($,X,J,Z,Q)=>{if(!Q)return D(J.parse($),vJ({onFailure:m6(X),onSuccess:$8}));return D(Tk($,Z),n0((Y)=>J.parse(Y.trim())),v6(m6(X)))},Lk=($)=>{return Object.keys($[0]).map((X)=>$.map((J)=>J[X]))},qk=($)=>D(n0($,_k),vJ({onFailure:()=>h8(),onSuccess:BX(V4)}),_8,L(_9)),Mk=/(^.+)(\[(\d+)\])$/,Pk=/^(\[(\d+)\])$/,_k=($)=>{let X=$.match(Pk);if(X!==null){let J=X[2];return D(J!==void 0&&J.length>0?q(J):T(),KX(MO))}return T()},Ck=($,X,J)=>{let Z=new Map;for(let[Q,Y]of $){let G=D(X(Q),R9((K)=>C0(Ek(K),{onNone:()=>$8(K),onSome:([B,H])=>P5(B,`[${H}]`)})));Z.set(J(G),Y)}return Z},Ek=($)=>{let X=$.match(Mk);if(X!==null){let J=X[1],Z=X[3],Q=J!==void 0&&J.length>0?q(J):T(),Y=D(Z!==void 0&&Z.length>0?q(Z):T(),KX(MO));return gV([Q,Y])}return T()},MO=($)=>{let X=Number.parseInt($);return Number.isNaN(X)?T():q(X)},Ik=($)=>({_tag:"KeyName",name:$}),Rk=($)=>({_tag:"KeyIndex",index:$}),PO=($)=>{let J=L$(jk($),([Z,Q])=>[Sk(Z).join("\uFEFF"),Q]);return jK(new Map(J),{pathDelim:"\uFEFF",seqDelim:"\uFEFF"})},Sk=($)=>{let X=[],J=0;while(J<$.length){let Z=$[J];if(Z._tag==="KeyName")if(J+1<$.length){let Q=$[J+1];if(Q._tag==="KeyIndex")X.push(`${Z.name}[${Q.index}]`),J+=2;else X.push(Z.name),J+=1}else X.push(Z.name),J+=1}return X},jk=($)=>{let X=(Q,Y)=>{if(typeof Y==="string")return P5([Q,Y]);if(typeof Y==="number"||typeof Y==="boolean")return P5([Q,String(Y)]);if(fV(Y))return J(Q,Y);if(typeof Y==="object"&&Y!==null)return Z(Q,Y);return h8()},J=(Q,Y)=>uV(Y,{onEmpty:()=>P5([Q,"<nil>"]),onNonEmpty:R9((G,K)=>X(C9(Q,Rk(K)),G))}),Z=(Q,Y)=>Object.entries(Y).filter(([,G])=>GV(G)).flatMap(([G,K])=>{let B=C9(Q,Ik(G)),H=X(B,K);if(R3(H))return P5([B,""]);return H});return Z(h8(),$)};var CO=Symbol.for("effect/Console"),d6=x0("effect/Console"),EO={[CO]:CO,assert($,...X){return w(()=>{console.assert($,...X)})},clear:w(()=>{console.clear()}),count($){return w(()=>{console.count($)})},countReset($){return w(()=>{console.countReset($)})},debug(...$){return w(()=>{console.debug(...$)})},dir($,X){return w(()=>{console.dir($,X)})},dirxml(...$){return w(()=>{console.dirxml(...$)})},error(...$){return w(()=>{console.error(...$)})},group($){return $?.collapsed?w(()=>console.groupCollapsed($?.label)):w(()=>console.group($?.label))},groupEnd:w(()=>{console.groupEnd()}),info(...$){return w(()=>{console.info(...$)})},log(...$){return w(()=>{console.log(...$)})},table($,X){return w(()=>{console.table($,X)})},time($){return w(()=>console.time($))},timeEnd($){return w(()=>console.timeEnd($))},timeLog($,...X){return w(()=>{console.timeLog($,...X)})},trace(...$){return w(()=>{console.trace(...$)})},warn(...$){return w(()=>{console.warn(...$)})},unsafe:console};var xk="effect/Random",tJ=Symbol.for(xk),c6=x0("effect/Random");class RO{seed;[tJ]=tJ;PRNG;constructor($){this.seed=$,this.PRNG=new W3($)}get next(){return w(()=>this.PRNG.number())}get nextBoolean(){return L(this.next,($)=>$>0.5)}get nextInt(){return w(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange($,X){return L(this.next,(J)=>(X-$)*J+$)}nextIntBetween($,X){return w(()=>this.PRNG.integer(X-$)+$)}shuffle($){return SO($,(X)=>this.nextIntBetween(0,X))}}var SO=($,X)=>{return S(()=>D(w(()=>Array.from($)),U((J)=>{let Z=[];for(let Q=J.length;Q>=2;Q=Q-1)Z.push(Q);return D(Z,f8((Q)=>D(X(Q),L((Y)=>kk(J,Q-1,Y)))),e(j5(J)))})))},kk=($,X,J)=>{let Z=$[X];return $[X]=$[J],$[J]=Z,$},yK=($)=>new RO(_($));class jO{values;[tJ]=tJ;index=0;constructor($){if(this.values=$,$.length===0)throw Error("Requires at least one value")}getNextValue(){let $=this.values[this.index];return this.index=(this.index+1)%this.values.length,$}get next(){return w(()=>{let $=this.getNextValue();if(typeof $==="number")return Math.max(0,Math.min(1,$));return _($)/2147483647})}get nextBoolean(){return w(()=>{let $=this.getNextValue();if(typeof $==="boolean")return $;return _($)%2===0})}get nextInt(){return w(()=>{let $=this.getNextValue();if(typeof $==="number"&&Number.isFinite($))return Math.round($);return Math.abs(_($))})}nextRange($,X){return L(this.next,(J)=>(X-$)*J+$)}nextIntBetween($,X){return w(()=>{let J=this.getNextValue();if(typeof J==="number"&&Number.isFinite(J))return Math.max($,Math.min(X-1,Math.round(J)));let Z=Math.abs(_(J));return $+Z%(X-$)})}shuffle($){return SO($,(X)=>this.nextIntBetween(0,X))}}var xO=($)=>new jO($);var vO=Symbol.for("effect/Tracer"),vk=($)=>({[vO]:vO,...$}),u6=x0("effect/Tracer"),O8=x0("effect/ParentSpan"),yO=function(){return function(J){let Z="";for(let Q=0;Q<J;Q++)Z+="abcdef0123456789".charAt(Math.floor(Math.random()*16));return Z}}();class bO{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor($,X,J,Z,Q,Y){this.name=$,this.parent=X,this.context=J,this.startTime=Q,this.kind=Y,this.status={_tag:"Started",startTime:Q},this.attributes=new Map,this.traceId=X._tag==="Some"?X.value.traceId:yO(32),this.spanId=yO(16),this.links=Array.from(Z)}end($,X){this.status={_tag:"Ended",endTime:$,exit:X,startTime:this.status.startTime}}attribute($,X){this.attributes.set($,X)}event($,X,J){this.events.push([$,X,J??{}])}addLinks($){this.links.push(...$)}}var gO=vk({span:($,X,J,Z,Q,Y)=>new bO($,X,J,Z,Q,Y),context:($)=>$()});var a8=($)=>{if($?.captureStackTrace===!1)return $;else if($?.captureStackTrace!==void 0&&typeof $.captureStackTrace!=="boolean")return $;let X=Error.stackTraceLimit;Error.stackTraceLimit=3;let J=Error();Error.stackTraceLimit=X;let Z=!1;return{...$,captureStackTrace:()=>{if(Z!==!1)return Z;if(J.stack!==void 0){let Q=J.stack.split(`
`);if(Q[3]!==void 0)return Z=Q[3].trim(),Z}}}},$7=c$()("effect/Tracer/DisablePropagation",{defaultValue:T8});var yk=D(h0(),t(N8,MK()),t(d6,EO),t(c6,yK(Math.random())),t(x4,P1()),t(u6,gO)),G0=j(Symbol.for("effect/DefaultServices/currentServices"),()=>dQ(yk)),hO=($)=>{let X=F0($);return eJ((J)=>J.sleep(X))},_1=($)=>m((X)=>$(X.currentDefaultServices)),eJ=($)=>_1((X)=>$(X.unsafeMap.get(N8.key))),mO=eJ(($)=>$.currentTimeMillis),dO=eJ(($)=>$.currentTimeNanos),cO=W(2,($,X)=>R0(G0,t(N8,X))($)),uO=W(2,($,X)=>R0(G0,t(x4,X))($)),bK=($)=>_1((X)=>$(X.unsafeMap.get(x4.key))),fO=($)=>bK((X)=>X.load($));var C1=($)=>_1((X)=>$(X.unsafeMap.get(c6.key))),pO=W(2,($,X)=>R0(G0,t(c6,X))($));var E1=($)=>_1((X)=>$(X.unsafeMap.get(u6.key))),nO=W(2,($,X)=>R0(G0,t(u6,X))($));var $Z=hO,J7=mO,lO=dO,oO=eJ,iO=N8;function rO($){return new f6($)}function aO(){return rO(new Map)}var gK=Symbol.for("effect/FiberRefs");class f6{locals;[gK]=gK;constructor($){this.locals=$}pipe(){return M(this,arguments)}}var bk=($,X,J,Z=!1)=>{let Q=$,Y=X,G=J,K=Z,B=void 0;while(B===void 0)if(f0(Y)&&f0(G)){let H=g0(Y)[0],z=m$(Y),V=g0(G)[0],N=g0(G)[1],A=m$(G);if(H.startTimeMillis<V.startTimeMillis)G=A,K=!0;else if(H.startTimeMillis>V.startTimeMillis)Y=z;else if(H.id<V.id)G=A,K=!0;else if(H.id>V.id)Y=z;else B=[N,K]}else B=[Q.initial,!0];return B},R1=W(3,($,X,J)=>{let Z=new Map($.locals);return J.locals.forEach((Q,Y)=>{let G=Q[0][1];if(!Q[0][0][I](X)){if(!Z.has(Y)){if(C(G,Y.initial))return;Z.set(Y,[[X,Y.join(Y.initial,G)]]);return}let K=Z.get(Y),[B,H]=bk(Y,K,Q);if(H){let z=Y.diff(B,G),V=K[0][1],N=Y.join(V,Y.patch(z)(V));if(!C(V,N)){let A,F=K[0][0];if(F[I](X))A=[[F,N],...K.slice(1)];else A=[[X,N],...K];Z.set(Y,A)}}}}),new f6(Z)}),mK=W(2,($,X)=>{let J=new Map;return sO($,J,X),new f6(J)}),sO=($,X,J)=>{$.locals.forEach((Z,Q)=>{let Y=Z[0][1],G=Q.patch(Q.fork)(Y);if(C(Y,G))X.set(Q,Z);else X.set(Q,[[J,G],...Z])})},tO=($)=>UX($.locals.keys()),eO=($)=>f8(tO($),(X)=>SX(X,p6($,X))),XZ=W(2,($,X)=>{let J=new Map($.locals);return J.delete(X),new f6(J)}),S1=W(2,($,X)=>{if(!$.locals.has(X))return T();return q(g0($.locals.get(X))[1])}),p6=W(2,($,X)=>D(S1($,X),S0(()=>X.initial))),Z7=W(2,($,{fiberId:X,fiberRef:J,value:Z})=>{if($.locals.size===0)return new f6(new Map([[J,[[X,Z]]]]));let Q=new Map($.locals);return hK(Q,X,J,Z),new f6(Q)}),hK=($,X,J,Z)=>{let Q=$.get(J)??[],Y;if(f0(Q)){let[G,K]=g0(Q);if(G[I](X))if(C(K,Z))return;else Y=[[X,Z],...Q.slice(1)];else Y=[[X,Z],...Q]}else Y=[[X,Z]];$.set(J,Y)},$w=W(2,($,{entries:X,forkAs:J})=>{if($.locals.size===0)return new f6(new Map(X));let Z=new Map($.locals);if(J!==void 0)sO($,Z,J);return X.forEach(([Q,Y])=>{if(Y.length===1)hK(Z,Y[0][0],Q,Y[0][1]);else Y.forEach(([G,K])=>{hK(Z,G,Q,K)})}),new f6(Z)});var cK=S1,Xw=p6,Jw=R1,Zw=eO;var Qw=$w;var Yw=aO;var gk=ZK,uK=QK,fK=YK,pK=gQ,nK=hQ,lK=mQ,oK=GK,hk=KK;var mk=D(V4,kV(($)=>$.ordinal));var iK=_3(mk);var rK=($)=>{switch($){case"All":return gk;case"Debug":return lK;case"Error":return fK;case"Fatal":return uK;case"Info":return nK;case"Trace":return oK;case"None":return hk;case"Warning":return pK}};var Gw=($,X)=>({label:$,startTime:X}),sK=($)=>$.replace(/[\s="]/g,"_"),tK=($)=>(X)=>{return`${sK(X.label)}=${$-X.startTime}ms`};var Bw=Gw;var Hw=F6,eK=F$;var dk=qV;class b4 extends dk{}var g4=Symbol.for("effect/Readable");var V60={[g4]:g4,pipe(){return M(this,arguments)}};var x1=Symbol.for("effect/Ref"),XB={_A:($)=>$};class zw extends b4{ref;commit(){return this.get}[x1]=XB;[g4]=g4;constructor($){super();this.ref=$,this.get=w(()=>s$(this.ref))}get;modify($){return w(()=>{let X=s$(this.ref),[J,Z]=$(X);if(X!==Z)M6(Z)(this.ref);return J})}}var Q7=($)=>new zw(a$($)),nX=($)=>w(()=>Q7($)),o0=($)=>$.get,G6=W(2,($,X)=>$.modify(()=>[void 0,X])),Dw=W(2,($,X)=>$.modify((J)=>[J,X]));var JB=W(2,($,X)=>$.modify(X));var lX=W(2,($,X)=>$.modify((J)=>[void 0,X(J)]));var v1=nX,y1=o0,Vw=Dw;var Uw=lX;var Nw=E1;var Ow="Empty",ww="Add",Fw="Remove",Tw="Update",Lw="AndThen",qw={_tag:Ow},ZZ=($,X)=>{let J=new Map($.locals),Z=qw;for(let[Q,Y]of X.locals.entries()){let G=g0(Y)[1],K=J.get(Q);if(K!==void 0){let B=g0(K)[1];if(!C(B,G))Z=b1({_tag:Tw,fiberRef:Q,patch:Q.diff(B,G)})(Z)}else Z=b1({_tag:ww,fiberRef:Q,value:G})(Z);J.delete(Q)}for(let[Q]of J.entries())Z=b1({_tag:Fw,fiberRef:Q})(Z);return Z},b1=W(2,($,X)=>({_tag:Lw,first:$,second:X})),g1=W(3,($,X,J)=>{let Z=J,Q=$8($);while(f0(Q)){let Y=g0(Q),G=m$(Q);switch(Y._tag){case Ow:{Q=G;break}case ww:{Z=Z7(Z,{fiberId:X,fiberRef:Y.fiberRef,value:Y.value}),Q=G;break}case Fw:{Z=XZ(Z,Y.fiberRef),Q=G;break}case Tw:{let K=p6(Z,Y.fiberRef);Z=Z7(Z,{fiberId:X,fiberRef:Y.fiberRef,value:Y.fiberRef.patch(Y.patch)(K)}),Q=G;break}case Lw:{Q=_5(Y.first)(_5(Y.second)(G));break}}}return Z});var Pw="effect/MetricLabel",QB=Symbol.for(Pw);class _w{key;value;[QB]=QB;_hash;constructor($,X){this.key=$,this.value=X,this._hash=s(Pw+this.key+this.value)}[R](){return this._hash}[I]($){return ck($)&&this.key===$.key&&this.value===$.value}pipe(){return M(this,arguments)}}var oX=($,X)=>{return new _w($,X)},ck=($)=>P($,QB);var Cw=W(($)=>o($[0]),function(){let $=arguments;return R0($[0],g6,typeof $[1]==="string"?J8($[1],$[2]):(X)=>Object.entries($[1]).reduce((J,[Z,Q])=>J8(J,Z,Q),X))}),Y7=($)=>L($,q),Ew=($)=>v6($,q),GB=($)=>{let X,J=void 0;if(typeof $==="function")X=$;else X=$.try,J=$.catch;return S(()=>{try{return O(D0(X))}catch(Z){return v(J?D0(()=>J(Z)):new dJ(Z,"An unknown error occurred in Effect.try"))}})},Iw=W(3,($,X,J)=>u8($,(Z)=>{if(P(Z,X)&&Z[X]===J.failure)return J.onFailure(Z);return v(Z)})),Rw=W(2,($,X)=>X6($,(J)=>{let Z=L4(J,(Q)=>c5(Q)?q(Q):T());switch(Z._tag){case"None":return h(J);case"Some":return X(Z.value.defect)}})),Sw=W(2,($,X)=>Q0($,{onFailure:(J)=>{let Z=X(J);switch(Z._tag){case"None":return h(J);case"Some":return Z.value}},onSuccess:O})),jw=W(2,($,X)=>X6($,(J)=>{let Z=L4(J,(Q)=>c5(Q)?q(Q):T());switch(Z._tag){case"None":return h(J);case"Some":{let Q=X(Z.value.defect);return Q._tag==="Some"?Q.value:h(J)}}})),xw=W(($)=>o($[0]),($,...X)=>{let J=X[X.length-1],Z;if(X.length===2)Z=k$(X[0]);else Z=(Q)=>{let Y=P(Q,"_tag")?Q._tag:void 0;if(!Y)return!1;for(let G=0;G<X.length-1;G++)if(X[G]===Y)return!0;return!1};return xJ($,Z,J)}),kw=W(2,($,X)=>{let J;return xJ($,(Z)=>{return J??=Object.keys(X),P(Z,"_tag")&&t4(Z._tag)&&J.includes(Z._tag)},(Z)=>X[Z._tag](Z))}),vw=($)=>kJ($,{onFailure:y,onSuccess:()=>H8}),K6=oO,yw=K6(O),bw=W(2,($,X)=>p($Z(X),$)),d1=($)=>m((X,J)=>$({id:X.id(),status:J,interruptors:_J(X.getFiberRef(bX))})),gw=d1(($)=>AX($.interruptors)>0?jQ:k),hw=d1(O),G7=($)=>GZ($,c1,ZZ),uk=($)=>GZ($,kX(c1,l5),([X,J],[Z,Q])=>[ZZ(X,Z),Y$(J,Q)]),mw=O({}),dw=ZV(L,U),cw=JV(L),uw=XV(L),fw=W(2,($,X)=>S(()=>{let J=$[Symbol.iterator](),Z=[],Q,Y=O(!1),G=0;while((Q=J.next())&&!Q.done){let K=Q.value,B=G++;Y=U(Y,(H)=>{if(H)return Z.push(K),O(!0);return X(K,B)})}return L(Y,()=>Z)})),pw=W(2,($,X)=>S(()=>{let J=$[Symbol.iterator](),Z=[],Q,Y=O(!0),G=0;while((Q=J.next())&&!Q.done){let K=Q.value,B=G++;Y=U(Y,(H)=>L(H?X(K,B):O(!1),(z)=>{if(!z)Z.push(K);return z}))}return L(Y,()=>Z)})),nw=($)=>L(S8(),$),KB=($)=>jX($,()=>U(Q6(),()=>KB($))),lw=W(2,($,X)=>L(n0($,y),C5(X))),ow=W(3,($,X,J)=>QZ($,X,(Z)=>P4(()=>J(Z)))),iw=W(3,($,X,J)=>QZ($,X,()=>M4(J))),QZ=W(3,($,X,J)=>U($,(Z)=>X(Z)?O(Z):J(Z))),rw=W(3,($,X,J)=>S(()=>X($)?O($):v(J($)))),aw=W(($)=>o($[0]),($,X,J)=>QZ($,X,(Z)=>J===void 0?v(new l8):G$(()=>J(Z)))),sw=W(2,($,X)=>S(()=>{let J=$[Symbol.iterator](),Z=J.next();if(!Z.done)return tw(J,0,X,Z.value);return O(T())})),tw=($,X,J,Z)=>U(J(Z,X),(Q)=>{if(Q)return O(q(Z));let Y=$.next();if(!Y.done)return tw($,X+1,J,Y.value);return O(T())}),ew=($)=>S(()=>{let X=j5($);if(!p0(X))return P4(()=>new mJ("Received an empty collection of effects"));return D(X8(X),L6(d0(X),(J,Z)=>jX(J,()=>Z)))}),$F=W(2,($,X)=>C4(X(C4($)))),YZ=W(2,($,X)=>I0($,{onFailure:(J)=>O(X.onFailure(J)),onSuccess:(J)=>O(X.onSuccess(J))})),XF=W(2,($,X)=>S(()=>JF($[Symbol.iterator](),0,X))),JF=($,X,J)=>{let Z=$.next();return Z.done?O(!0):U(J(Z.value,X),(Q)=>Q?JF($,X+1,J):O(Q))},BB=($)=>{let X=U(U($,()=>Q6()),()=>X);return X},c1=m(($)=>O($.getFiberRefs())),ZF=($)=>U($,(X)=>{let Z=X[Symbol.iterator]().next();if(Z.done)return v(new l8);return O(Z.value)}),u1=($)=>YZ($,{onFailure:x$,onSuccess:x$}),QF=($)=>Q0($,{onFailure:(X)=>HB(X,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>k}),YF=($)=>n1((X,J)=>Jw(J,X,$)),GF=($)=>YZ($,{onFailure:b8,onSuccess:T8}),KF=($)=>YZ($,{onFailure:T8,onSuccess:b8}),WB=($,X)=>S(()=>{if(X.while($))return U(X.body($),(J)=>WB(J,X));return O($)}),n6=($)=>(...X)=>{let J=z4($),Z=void 0;for(let Q=0,Y=X.length;Q<Y;Q++){let G=X[Q];if(wQ(G)){if(Z!==void 0)Z=B0(Z,G);else Z=G;X=[...X.slice(0,Q),...X.slice(Q+1)],Q--}}if(Z===void 0)Z=H8;return m((Q)=>{return Q.log(X,Z,J),k})},BF=n6(),WF=n6(oK),HB=n6(lK),HF=n6(nK),zF=n6(pK),DF=n6(fK),VF=n6(uK),UF=W(2,($,X)=>U(J7,(J)=>R0($,uQ,GQ(Bw(X,J))))),NF=p8(g6),AF=($,X)=>X.discard?wF($,X.while,X.step,X.body):L(OF($,X.while,X.step,X.body),c),OF=($,X,J,Z)=>S(()=>X($)?U(Z($),(Q)=>L(OF(J($),X,J,Z),GQ(Q))):w(()=>e$())),wF=($,X,J,Z)=>S(()=>X($)?U(Z($),()=>wF(J($),X,J,Z)):k),FF=W(3,($,X,J)=>S(()=>{let Z=$[Symbol.iterator](),Q=[],Y=O(X),G,K=0;while(!(G=Z.next()).done){let B=K++,H=G.value;Y=U(Y,(z)=>L(J(z,H,B),([V,N])=>{return Q.push(N),V}))}return L(Y,(B)=>[B,Q])})),K7=W(2,($,X)=>Q0($,{onFailure:(J)=>j6(()=>X(J)),onSuccess:O})),f1=($)=>D(o8(),U((X)=>D(uk($),J6(X),zB,L((J)=>p(J,D(v0(X),U(([Z,Q])=>e(kX(iX(Z[0]),E4(Z[1])),Q)))))))),TF=($)=>I0($,{onFailure:(X)=>O(X),onSuccess:O}),p1=($)=>L($,(X)=>!X),LF=($)=>U($,(X)=>{switch(X._tag){case"None":return k;case"Some":return v(new l8)}}),zB=($)=>L(v1(!0),(X)=>U0(o5($,Vw(X,!1)))),qF=($)=>I0($,{onFailure:()=>O(T()),onSuccess:(X)=>O(q(X))}),MF=W(2,($,X)=>jX($,()=>G$(X))),PF=W(2,($,X)=>jX($,()=>w(X))),_F=($)=>Q0($,{onFailure:(X)=>{let J=c(PJ(X));return J.length===0?h(X):v(J)},onSuccess:O}),iX=($)=>n1((X,J)=>D($,g1(X,J))),CF=($)=>$.length>=1?Z8((X,J)=>{try{$(J).then((Z)=>X(O(Z)),(Z)=>X(Q8(Z)))}catch(Z){X(Q8(Z))}}):Z8((X)=>{try{$().then((J)=>X(O(J)),(J)=>X(Q8(J)))}catch(J){X(Q8(J))}}),h4=W(3,($,X,J)=>K$((Z)=>i8($,t(Z,X,J)))),m4=W(3,($,X,J)=>K$((Z)=>U(J,(Q)=>i8($,D(Z,t(X,Q)))))),EF=C1(O),IF=W(3,($,X,J)=>c($).reduce((Z,Q,Y)=>U(Z,(G)=>J(G,Q,Y)),O(X))),RF=W(3,($,X,J)=>c($).reduceRight((Z,Q,Y)=>U(Z,(G)=>J(Q,G,Y)),O(X))),SF=W(3,($,X,J)=>U(w(()=>$[Symbol.iterator]()),(Z)=>jF(Z,0,X,J.while,J.body))),jF=($,X,J,Z,Q)=>{let Y=$.next();if(!Y.done&&Z(J))return U(Q(J,Y.value,X),(G)=>jF($,X+1,G,Z,Q));return O(J)},xF=W(2,($,X)=>S(()=>kF($,X))),kF=($,X)=>U($,(J)=>X<=0?O(J):p(Q6(),kF($,X-1))),vF=($)=>Q0($,{onFailure:v,onSuccess:O}),yF=($)=>S(()=>Zw($)),rX=$Z,aX=O(T()),bF=($)=>O(q($)),GZ=W(3,($,X,J)=>U(X,(Z)=>U($,(Q)=>L(X,(Y)=>[J(Z,Y),Q])))),gF=W(($)=>o($[0]),function(){return DB(arguments[0],typeof arguments[1]==="string"?[oX(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(([$,X])=>oX($,X)))}),DB=W(2,($,X)=>R0($,h6,(J)=>T$(J,X))),hF=W(2,($,X)=>S(()=>{let J=$[Symbol.iterator](),Z=[],Q,Y=O(!1),G=0;while((Q=J.next())&&!Q.done){let K=Q.value,B=G++;Y=U(Y,(H)=>{if(H)return O(!0);return Z.push(K),X(K,B)})}return L(Y,()=>Z)})),mF=W(2,($,X)=>S(()=>{let J=$[Symbol.iterator](),Z=[],Q,Y=O(!0),G=0;while((Q=J.next())&&!Q.done){let K=Q.value,B=G++;Y=U(Y,(H)=>D(H?X(K,B):O(!1),L((z)=>{if(z)Z.push(K);return z})))}return L(Y,()=>Z)})),dF=W(2,($,{onFailure:X,onSuccess:J})=>Q0($,{onFailure:(Z)=>{let Q=P$(Z);switch(Q._tag){case"Left":return p(X(Q.left),h(Z));case"Right":return h(Z)}},onSuccess:(Z)=>e(J(Z),Z)})),cF=W(2,($,X)=>X6($,(J)=>C0(i2(J),{onNone:()=>h(J),onSome:(Z)=>p(X(Z),h(J))}))),VB=W(2,($,X)=>Q0($,{onFailure:(J)=>{let Z=P$(J);switch(Z._tag){case"Left":return p(X(Z.left),h(J));case"Right":return h(J)}},onSuccess:O})),uF=W(3,($,X,J)=>VB($,(Z)=>{if(k$(Z,X))return J(Z);return k})),fF=W(2,($,X)=>Q0($,{onFailure:(J)=>p(X(J),h(J)),onSuccess:O})),pF=($)=>UB($,lO),UB=W(2,($,X)=>GZ($,X,(J,Z)=>HJ(Z-J))),fk=Nw,nF=fk(O),NB=($)=>{let X,J=void 0;if(typeof $==="function")X=$;else X=$.try,J=$.catch;let Z=(Q)=>J?G$(()=>J(Q)):v(new dJ(Q,"An unknown error occurred in Effect.tryPromise"));if(X.length>=1)return Z8((Q,Y)=>{try{X(Y).then((G)=>Q(O(G)),(G)=>Q(Z(G)))}catch(G){Q(Z(G))}});return Z8((Q)=>{try{X().then((Y)=>Q(O(Y)),(Y)=>Q(Z(Y)))}catch(Y){Q(Z(Y))}})},lF=W(2,($,X)=>U($,(J)=>GB({try:()=>X.try(J),catch:X.catch}))),oF=W(2,($,X)=>U($,(J)=>NB({try:X.try.length>=1?(Z)=>X.try(J,Z):()=>X.try(J),catch:X.catch}))),iF=W(2,($,X)=>S(()=>X()?aX:Y7($))),rF=W(2,($,X)=>U(X,(J)=>J?aX:Y7($))),aF=($)=>K7($,r2),n1=($)=>m((X)=>{return X.setFiberRefs($(X.id(),X.getFiberRefs())),k}),sF=W(3,($,X,J)=>cX($,(Z)=>t(Z,X,J(X$(Z,X))))),l1=W(2,($,X)=>S(()=>X()?L($,q):O(T()))),tF=W(3,($,X,J)=>U(p8(X),(Z)=>J(Z)?L($,(Q)=>[Z,q(Q)]):O([Z,T()]))),eF=W(3,($,X,J)=>U(y1(X),(Z)=>J(Z)?L($,(Q)=>[Z,q(Q)]):O([Z,T()]))),$T=W(2,($,X)=>X($)),XT=($,X)=>(...J)=>U($,(Z)=>X(Z)(...J)),JT=($,X)=>(...J)=>L($,(Z)=>X(Z)(...J)),AB=($)=>new Proxy({},{get(X,J,Z){return(...Q)=>U($,(Y)=>Y[J](...Q))}}),OB=($)=>new Proxy({},{get(X,J,Z){return U($,(Q)=>o(Q[J])?Q[J]:O(Q[J]))}}),ZT=($)=>({functions:AB($),constants:OB($)}),QT=($)=>L(S8(),J$($)),wB=($)=>U(S8(),J$($)),YT=function(){let $=arguments;return u1(U(o1,(X)=>w(()=>{if(typeof $[0]==="string")X.attribute($[0],$[1]);else for(let J in $[0])X.attribute(J,$[0][J])})))},GT=function(){let $=arguments,X=Array.isArray($[0])?$[0]:[{_tag:"SpanLink",span:$[0],attributes:$[1]??{}}];return u1(U(o1,(J)=>w(()=>J.addLinks(X))))},KT=W(($)=>o($[0]),function(){let $=arguments;return R0($[0],r5,typeof $[1]==="string"?J8($[1],$[2]):(X)=>Object.entries($[1]).reduce((J,[Z,Q])=>J8(J,Z,Q),X))}),BT=wB(O8),o1=U(S8(),($)=>{let X=$.unsafeMap.get(O8.key);return X!==void 0&&X._tag==="Span"?O(X):v(new l8)}),WT=W(($)=>o($[0]),($,X,J)=>R0($,nQ,y9({_tag:"SpanLink",span:X,attributes:J??{}}))),HT=BigInt(0),zT=KX(($)=>E0($.context,$7)?$._tag==="Span"?zT($.parent):T():q($)),i1=($,X,J)=>{let Z=!$.getFiberRef(hJ)||J.context&&E0(J.context,$7),Q=$.getFiberRef(R8),Y=J.parent?q(J.parent):J.root?T():zT(J$(Q,O8)),G;if(Z)G=bA({name:X,parent:Y,context:t(J.context??h0(),$7,!0)});else{let K=$.getFiberRef(G0),B=E0(K,u6),H=E0(K,iO),z=$.getFiberRef(S4),V=$.getFiberRefs(),N=cK(V,r5),A=cK(V,nQ),F=A._tag==="Some"?J.links!==void 0?[...d8(A.value),...J.links??[]]:d8(A.value):J.links??h8();if(G=B.span(X,Y,J.context??h0(),F,z?H.unsafeCurrentTimeNanos():HT,J.kind??"internal",J),N._tag==="Some")AN(N.value,(E,d)=>G.attribute(d,E));if(J.attributes!==void 0)Object.entries(J.attributes).forEach(([E,d])=>G.attribute(E,d))}if(typeof J.captureStackTrace==="function")CJ.set(G,J.captureStackTrace);return G},DT=($,X)=>{return X=a8(X),m((J)=>O(i1(J,$,X)))},VT=p8(r5),UT=p8(nQ),FB=($,X,J,Z)=>w(()=>{if($.status._tag==="Ended")return;if(zK(X)&&CJ.has($))$.attribute("code.stacktrace",CJ.get($)());$.end(Z?J.unsafeCurrentTimeNanos():HT,X)}),h1=($,...X)=>{let J=a8(X.length===1?void 0:X[0]),Z=X[X.length-1];return m((Q)=>{let Y=i1(Q,$,J),G=Q.getFiberRef(S4),K=E0(Q.getFiberRef(G0),N8);return D8(Z(Y),(B)=>FB(Y,B,K,G))})},m1=W(2,($,X)=>h4($,O8,X)),TB=function(){let $=typeof arguments[0]!=="string",X=$?arguments[1]:arguments[0],J=a8($?arguments[2]:arguments[1]);if($){let Z=arguments[0];return h1(X,J,(Q)=>m1(Z,Q))}return(Z)=>h1(X,J,(Q)=>m1(Z,Q))},NT=($)=>function(){let X=$.captureStackTrace??!1;if($.captureStackTrace!==!1){let J=Error.stackTraceLimit;Error.stackTraceLimit=2;let Z=Error();Error.stackTraceLimit=J;let Q=!1;X=()=>{if(Q!==!1)return Q;if(Z.stack)return Q=Z.stack.trim().split(`
`).slice(2).join(`
`).trim(),Q}}return S(()=>{let J=typeof $.options==="function"?$.options.apply(null,arguments):$.options;return TB(S(()=>D0(()=>$.body.apply(this,arguments))),J.name,{...J,captureStackTrace:X})})},AT=($)=>$==null?v(new l8):O($),OT=($)=>u8(L($,q),(X)=>IA(X)?aX:v(X));var wT="Sequential",FT="Parallel",pk="ParallelN",W$={_tag:wT},KZ={_tag:FT},TT=($)=>({_tag:pk,parallelism:$}),LB=($)=>$._tag===wT,qB=($)=>$._tag===FT;var a1=W$,s1=KZ,t1=TT;var sX=ZZ;var tX=g1;var $Y="effect/FiberStatus",d4=Symbol.for($Y),e1="Done",qT="Running",MT="Suspended",nk=s(`${$Y}-${e1}`);class PT{[d4]=d4;_tag=e1;[R](){return nk}[I]($){return XY($)&&$._tag===e1}}class _T{runtimeFlags;[d4]=d4;_tag=qT;constructor($){this.runtimeFlags=$}[R](){return D(_($Y),x(_(this._tag)),x(_(this.runtimeFlags)),b(this))}[I]($){return XY($)&&$._tag===qT&&this.runtimeFlags===$.runtimeFlags}}class CT{runtimeFlags;blockingOn;[d4]=d4;_tag=MT;constructor($,X){this.runtimeFlags=$,this.blockingOn=X}[R](){return D(_($Y),x(_(this._tag)),x(_(this.runtimeFlags)),x(_(this.blockingOn)),b(this))}[I]($){return XY($)&&$._tag===MT&&this.runtimeFlags===$.runtimeFlags&&C(this.blockingOn,$.blockingOn)}}var ET=new PT,IT=($)=>new _T($),RT=($,X)=>new CT($,X),XY=($)=>P($,d4),ST=($)=>$._tag===e1;var jT=ET,PB=IT,xT=RT;var kT=ST;var ok=Symbol.for("effect/Micro"),ZY=Symbol.for("effect/Micro/MicroExit");var yT=Symbol.for("effect/Micro/MicroCause");var ik={_E:y};class EB extends globalThis.Error{_tag;traces;[yT];constructor($,X,J){let Z=`MicroCause.${$}`,Q,Y,G;if(X instanceof globalThis.Error){Q=`(${Z}) ${X.name}`,Y=X.message;let K=Y.split(`
`).length;G=X.stack?`(${Z}) ${X.stack.split(`
`).slice(0,K+3).join(`
`)}`:`${Q}: ${Y}`}else Q=Z,Y=O6(X,0),G=`${Q}: ${Y}`;if(J.length>0)G+=`
    ${J.join(`
    `)}`;super(Y);this._tag=$,this.traces=J,this[yT]=ik,this.name=Q,this.stack=G}pipe(){return M(this,arguments)}toString(){return this.stack}[g](){return this.stack}}class hT extends EB{defect;constructor($,X=[]){super("Die",$,X);this.defect=$}}var rk=($,X=[])=>new hT($,X);class mT extends EB{constructor($=[]){super("Interrupt","interrupted",$)}}var ak=($=[])=>new mT($);var sk=($)=>$._tag==="Interrupt";var bT=Symbol.for("effect/Micro/MicroFiber"),tk={_A:y,_E:y};class dT{context;interruptible;[bT];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor($,X=!0){this.context=$,this.interruptible=X,this[bT]=tk}getRef($){return KU(this.context,$)}addObserver($){if(this._exit)return $(this._exit),x$;return this._observers.push($),()=>{let X=this._observers.indexOf($);if(X>=0)this._observers.splice(X,1)}}_interrupted=!1;unsafeInterrupt(){if(this._exit)return;if(this._interrupted=!0,this.interruptible)this.evaluate(xB)}unsafePoll(){return this._exit}evaluate($){if(this._exit)return;else if(this._yielded!==void 0){let Z=this._yielded;this._yielded=void 0,Z()}let X=this.runLoop($);if(X===JY)return;let J=gT.interruptChildren&&gT.interruptChildren(this);if(J!==void 0)return this.evaluate(YY(J,()=>X));this._exit=X;for(let Z=0;Z<this._observers.length;Z++)this._observers[Z](X);this._observers.length=0}runLoop($){let X=!1,J=$;this.currentOpCount=0;try{while(!0){if(this.currentOpCount++,!X&&this.getRef(KY).shouldYield(this)){X=!0;let Z=J;J=YY(Zv,()=>Z)}if(J=J[_B](this),J===JY){let Z=this._yielded;if(ZY in Z)return this._yielded=void 0,Z;return JY}}}catch(Z){if(!P(J,_B))return CB(`MicroFiber.runLoop: Not a valid effect: ${String(J)}`);return CB(Z)}}getCont($){while(!0){let X=this._stack.pop();if(!X)return;let J=X[QY]&&X[QY](this);if(J)return{[$]:J};if(X[$])return X}}_yielded=void 0;yieldWith($){return this._yielded=$,JY}children(){return this._children??=new Set}}var gT=j("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0}));var cT=Symbol.for("effect/Micro/identifier"),y0=Symbol.for("effect/Micro/args"),_B=Symbol.for("effect/Micro/evaluate"),H7=Symbol.for("effect/Micro/successCont"),W7=Symbol.for("effect/Micro/failureCont"),QY=Symbol.for("effect/Micro/ensureCont"),JY=Symbol.for("effect/Micro/Yield"),ek={_A:y,_E:y,_R:y},$v={...Hw,_op:"Micro",[ok]:ek,pipe(){return M(this,arguments)},[Symbol.iterator](){return new O5(new A6(this))},toJSON(){return{_id:"Micro",op:this[cT],...y0 in this?{args:this[y0]}:void 0}},toString(){return l(this)},[g](){return l(this)}};function Xv($){return CB("Micro.evaluate: Not implemented")}var GY=($)=>({...$v,[cT]:$.op,[_B]:$.eval??Xv,[H7]:$.contA,[W7]:$.contE,[QY]:$.ensure}),IB=($)=>{let X=GY($);return function(){let J=Object.create(X);return J[y0]=$.single===!1?arguments:arguments[0],J}},uT=($)=>{let X={...GY($),[ZY]:ZY,_tag:$.op,get[$.prop](){return this[y0]},toJSON(){return{_id:"MicroExit",_tag:$.op,[$.prop]:this[y0]}},[I](J){return Gv(J)&&J._tag===$.op&&C(this[y0],J[y0])},[R](){return b(this,x(s($.op))(_(this[y0])))}};return function(J){let Z=Object.create(X);return Z[y0]=J,Z[H7]=void 0,Z[W7]=void 0,Z[QY]=void 0,Z}},RB=uT({op:"Success",prop:"value",eval($){let X=$.getCont(H7);return X?X[H7](this[y0],$):$.yieldWith(this)}}),fT=uT({op:"Failure",prop:"cause",eval($){let X=$.getCont(W7);while(sk(this[y0])&&X&&$.interruptible)X=$.getCont(W7);return X?X[W7](this[y0],$):$.yieldWith(this)}});var Jv=IB({op:"Yield",eval($){let X=!1;return $.getRef(KY).scheduleTask(()=>{if(X)return;$.evaluate(Kv)},this[y0]??0),$.yieldWith(()=>{X=!0})}}),Zv=Jv(0);var Qv=RB(void 0);var SB=IB({op:"WithMicroFiber",eval($){return this[y0]($)}});var YY=W(2,($,X)=>{let J=Object.create(Yv);return J[y0]=$,J[H7]=X,J}),Yv=GY({op:"OnSuccess",eval($){return $._stack.push(this),this[y0]}});var Gv=($)=>P($,ZY),pT=RB,jB=fT,xB=jB(ak());var CB=($)=>jB(rk($));var Kv=pT(void 0);var Bv="setImmediate"in globalThis?globalThis.setImmediate:($)=>setTimeout($,0);class kB{tasks=[];running=!1;scheduleTask($,X){if(this.tasks.push($),!this.running)this.running=!0,Bv(this.afterScheduled)}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let $=this.tasks;this.tasks=[];for(let X=0,J=$.length;X<J;X++)$[X]()}shouldYield($){return $.currentOpCount>=$.getRef(lT)}flush(){while(this.tasks.length>0)this.runTasks()}}var Wv=W(2,($,X)=>SB((J)=>{let Z=J.context;return J.context=X(Z),Dv($,()=>{return J.context=Z,Qv})}));var nT=W(2,($,X)=>Wv($,Z$(X)));class lT extends c$()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class KY extends c$()("effect/Micro/currentScheduler",{defaultValue:()=>new kB}){}var Hv=W(2,($,X)=>{let J=Object.create(zv);return J[y0]=$,J[H7]=X.onSuccess,J[W7]=X.onFailure,J}),zv=GY({op:"OnSuccessAndFailure",eval($){return $._stack.push(this),this[y0]}});var Dv=W(2,($,X)=>Uv((J)=>Hv(J($),{onFailure:(Z)=>YY(X(jB(Z)),()=>fT(Z)),onSuccess:(Z)=>YY(X(pT(Z)),()=>RB(Z))})));var oT=IB({op:"SetInterruptible",ensure($){if($.interruptible=this[y0],$._interrupted&&$.interruptible)return()=>xB}}),Vv=($)=>SB((X)=>{if(X.interruptible)return $;if(X.interruptible=!0,X._stack.push(oT(!1)),X._interrupted)return xB;return $}),Uv=($)=>SB((X)=>{if(!X.interruptible)return $(y);return X.interruptible=!1,X._stack.push(oT(!0)),$(Vv)});var iT=($,X)=>{let J=new dT(KY.context(X?.scheduler??new kB));if(J.evaluate($),X?.signal)if(X.signal.aborted)J.unsafeInterrupt();else{let Z=()=>J.unsafeInterrupt();X.signal.addEventListener("abort",Z,{once:!0}),J.addObserver(()=>X.signal.removeEventListener("abort",Z))}return J};class vB{buckets=[];scheduleTask($,X){let J=this.buckets.length,Z=void 0,Q=0;for(;Q<J;Q++)if(this.buckets[Q][0]<=X)Z=this.buckets[Q];else break;if(Z&&Z[0]===X)Z[1].push($);else if(Q===J)this.buckets.push([X,[$]]);else this.buckets.splice(Q,0,[X,[$]])}}class aT{maxNextTickBeforeTimer;running=!1;tasks=new vB;constructor($){this.maxNextTickBeforeTimer=$}starveInternal($){let X=this.tasks.buckets;this.tasks.buckets=[];for(let[J,Z]of X)for(let Q=0;Q<Z.length;Q++)Z[Q]();if(this.tasks.buckets.length===0)this.running=!1;else this.starve($)}starve($=0){if($>=this.maxNextTickBeforeTimer)setTimeout(()=>this.starveInternal(0),0);else Promise.resolve(void 0).then(()=>this.starveInternal($+1))}shouldYield($){return $.currentOpCount>$.getFiberRef(cQ)?$.getFiberRef(b6):!1}scheduleTask($,X){if(this.tasks.scheduleTask($,X),!this.running)this.running=!0,this.starve()}}var sT=j(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new aT(2048));class yB{tasks=new vB;deferred=!1;scheduleTask($,X){if(this.deferred)sT.scheduleTask($,X);else this.tasks.scheduleTask($,X)}shouldYield($){return $.currentOpCount>$.getFiberRef(cQ)?$.getFiberRef(b6):!1}flush(){while(this.tasks.buckets.length>0){let $=this.tasks.buckets;this.tasks.buckets=[];for(let[X,J]of $)for(let Z=0;Z<J.length;Z++)J[Z]()}this.deferred=!0}}var l6=j(Symbol.for("effect/FiberRef/currentScheduler"),()=>z0(sT)),tT=W(2,($,X)=>H0($,l6,X));var WY=j(Symbol.for("effect/FiberRef/currentRequestMap"),()=>z0(new Map));var bB=($,X,J,Z)=>{switch($){case void 0:return X();case"unbounded":return J();case"inherit":return l0(fQ,(Q)=>Q==="unbounded"?J():Q>1?Z(Q):X());default:return $>1?Z($):X()}},BZ=($,X,J)=>{switch($){case void 0:return X();case"unbounded":return J();case"inherit":return l0(fQ,(Z)=>Z==="unbounded"||Z>1?J():X());default:return $>1?J():X()}};var gB="InterruptSignal",hB="Stateful",mB="Resume",dB="YieldNow",HY=($)=>({_tag:"InterruptSignal",cause:$}),z7=($)=>({_tag:"Stateful",onFiber:$}),eX=($)=>({_tag:"Resume",effect:$}),eT=()=>({_tag:"YieldNow"});var Ov="effect/FiberScope",zY=Symbol.for(Ov);class XL{[zY]=zY;fiberId=P8;roots=new Set;add($,X){this.roots.add(X),X.addObserver(()=>{this.roots.delete(X)})}}class JL{fiberId;parent;[zY]=zY;constructor($,X){this.fiberId=$,this.parent=X}add($,X){this.parent.tell(z7((J)=>{J.addChild(X),X.addObserver(()=>{J.removeChild(X)})}))}}var ZL=($)=>{return new JL($.id(),$)},o6=j(Symbol.for("effect/FiberScope/Global"),()=>new XL);var wv="effect/Fiber",WZ=Symbol.for(wv),HZ={_E:($)=>$,_A:($)=>$},Fv={[WZ]:HZ,pipe(){return M(this,arguments)}},Tv="effect/Fiber",cB=Symbol.for(Tv);var YL=($)=>(cB in $),GL=($)=>$.await;var KL=($)=>$.inheritAll;var BL=W(2,i5(function*($,X){for(let J of $){if(YL(J)){J.unsafeInterruptAsFork(X);continue}yield*J.interruptAsFork(X)}for(let J of $){if(YL(J)&&J.unsafePoll())continue;yield*J.await}})),WL=W(2,($,X)=>$.interruptAsFork(X)),C$=($)=>vX(E8($.await),$.inheritAll);var r60={...F$,commit(){return C$(this)},...Fv,id:()=>P8,await:R4,children:O([]),inheritAll:R4,poll:O(T()),interruptAsFork:()=>R4};var c4="effect/FiberCurrent";var Lv="effect/Logger",zL=Symbol.for(Lv),DL={_Message:($)=>$,_Output:($)=>$},DY=($)=>({[zL]:DL,log:$,pipe(){return M(this,arguments)}});var t60={[zL]:DL,log:x$,pipe(){return M(this,arguments)}};var qv=/^[^\s"=]*$/,Mv=($,X)=>({annotations:J,cause:Z,date:Q,fiberId:Y,logLevel:G,message:K,spans:B})=>{let H=(F)=>F.match(qv)?F:$(F),z=(F,E)=>`${sK(F)}=${H(E)}`,V=(F,E)=>" "+z(F,E),N=z("timestamp",Q.toISOString());N+=V("level",G.label),N+=V("fiber",ZQ(Y));let A=cV(K);for(let F=0;F<A.length;F++)N+=V("message",O6(A[F],X));if(!l2(Z))N+=V("cause",$6(Z,{renderErrorCause:!0}));for(let F of B)N+=" "+tK(Q.getTime())(F);for(let[F,E]of J)N+=V(F,O6(E,X));return N},Pv=($)=>`"${$.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,VL=DY(Mv(Pv));var $5={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},e60={None:[],All:[],Trace:[$5.gray],Debug:[$5.blue],Info:[$5.green],Warning:[$5.yellow],Error:[$5.red],Fatal:[$5.bgBrightRed,$5.black]};var UL=typeof process==="object"&&process!==null&&typeof process.stdout==="object"&&process.stdout!==null,$40=UL&&process.stdout.isTTY===!0,X40=UL||"Deno"in globalThis;var NL="effect/MetricBoundaries",uB=Symbol.for(NL);class AL{values;[uB]=uB;constructor($){this.values=$,this._hash=D(s(NL),x(g8(this.values)))}_hash;[R](){return this._hash}[I]($){return Cv($)&&C(this.values,$.values)}pipe(){return M(this,arguments)}}var Cv=($)=>P($,uB),Ev=($)=>{let X=D($,I3(V0(Number.POSITIVE_INFINITY)),y3);return new AL(X)};var OL=($)=>D(E3($.count-1,(X)=>$.start*Math.pow($.factor,X)),HX,Ev);var Rv="effect/MetricKeyType",wL=Symbol.for(Rv),FL="effect/MetricKeyType/Counter",fB=Symbol.for(FL),Sv="effect/MetricKeyType/Frequency",jv=Symbol.for(Sv),xv="effect/MetricKeyType/Gauge",kv=Symbol.for(xv),TL="effect/MetricKeyType/Histogram",pB=Symbol.for(TL),vv="effect/MetricKeyType/Summary",yv=Symbol.for(vv),LL={_In:($)=>$,_Out:($)=>$};class qL{incremental;bigint;[wL]=LL;[fB]=fB;constructor($,X){this.incremental=$,this.bigint=X,this._hash=s(FL)}_hash;[R](){return this._hash}[I]($){return nB($)}pipe(){return M(this,arguments)}}class ML{boundaries;[wL]=LL;[pB]=pB;constructor($){this.boundaries=$,this._hash=D(s(TL),x(_(this.boundaries)))}_hash;[R](){return this._hash}[I]($){return lB($)&&C(this.boundaries,$.boundaries)}pipe(){return M(this,arguments)}}var PL=($)=>new qL($?.incremental??!1,$?.bigint??!1);var _L=($)=>{return new ML($)};var nB=($)=>P($,fB),CL=($)=>P($,jv),EL=($)=>P($,kv),lB=($)=>P($,pB),IL=($)=>P($,yv);var bv="effect/MetricKey",SL=Symbol.for(bv),gv={_Type:($)=>$},hv=E5(C);class VY{name;keyType;description;tags;[SL]=gv;constructor($,X,J,Z=[]){this.name=$,this.keyType=X,this.description=J,this.tags=Z,this._hash=D(s(this.name+this.description),x(_(this.keyType)),x(g8(this.tags)))}_hash;[R](){return this._hash}[I]($){return mv($)&&this.name===$.name&&C(this.keyType,$.keyType)&&C(this.description,$.description)&&hv(this.tags,$.tags)}pipe(){return M(this,arguments)}}var mv=($)=>P($,SL),jL=($,X)=>new VY($,PL(X),z4(X?.description));var xL=($,X,J)=>new VY($,_L(X),z4(J));var kL=W(2,($,X)=>X.length===0?$:new VY($.name,$.keyType,$.description,T$($.tags,X)));var cv="effect/MetricState",zZ=Symbol.for(cv),vL="effect/MetricState/Counter",oB=Symbol.for(vL),yL="effect/MetricState/Frequency",iB=Symbol.for(yL),bL="effect/MetricState/Gauge",rB=Symbol.for(bL),gL="effect/MetricState/Histogram",aB=Symbol.for(gL),hL="effect/MetricState/Summary",sB=Symbol.for(hL),DZ={_A:($)=>$};class mL{count;[zZ]=DZ;[oB]=oB;constructor($){this.count=$}[R](){return D(_(vL),x(_(this.count)),b(this))}[I]($){return fv($)&&this.count===$.count}pipe(){return M(this,arguments)}}var uv=E5(C);class dL{occurrences;[zZ]=DZ;[iB]=iB;constructor($){this.occurrences=$}_hash;[R](){return D(s(yL),x(g8(c(this.occurrences.entries()))),b(this))}[I]($){return pv($)&&uv(c(this.occurrences.entries()),c($.occurrences.entries()))}pipe(){return M(this,arguments)}}class cL{value;[zZ]=DZ;[rB]=rB;constructor($){this.value=$}[R](){return D(_(bL),x(_(this.value)),b(this))}[I]($){return nv($)&&this.value===$.value}pipe(){return M(this,arguments)}}class uL{buckets;count;min;max;sum;[zZ]=DZ;[aB]=aB;constructor($,X,J,Z,Q){this.buckets=$,this.count=X,this.min=J,this.max=Z,this.sum=Q}[R](){return D(_(gL),x(_(this.buckets)),x(_(this.count)),x(_(this.min)),x(_(this.max)),x(_(this.sum)),b(this))}[I]($){return lv($)&&C(this.buckets,$.buckets)&&this.count===$.count&&this.min===$.min&&this.max===$.max&&this.sum===$.sum}pipe(){return M(this,arguments)}}class fL{error;quantiles;count;min;max;sum;[zZ]=DZ;[sB]=sB;constructor($,X,J,Z,Q,Y){this.error=$,this.quantiles=X,this.count=J,this.min=Z,this.max=Q,this.sum=Y}[R](){return D(_(hL),x(_(this.error)),x(_(this.quantiles)),x(_(this.count)),x(_(this.min)),x(_(this.max)),x(_(this.sum)),b(this))}[I]($){return ov($)&&this.error===$.error&&C(this.quantiles,$.quantiles)&&this.count===$.count&&this.min===$.min&&this.max===$.max&&this.sum===$.sum}pipe(){return M(this,arguments)}}var pL=($)=>new mL($),nL=($)=>{return new dL($)},lL=($)=>new cL($),oL=($)=>new uL($.buckets,$.count,$.min,$.max,$.sum),iL=($)=>new fL($.error,$.quantiles,$.count,$.min,$.max,$.sum);var fv=($)=>P($,oB),pv=($)=>P($,iB),nv=($)=>P($,rB),lv=($)=>P($,aB),ov=($)=>P($,sB);var rv="effect/MetricHook",av=Symbol.for(rv),sv={_In:($)=>$,_Out:($)=>$},VZ=($)=>({[av]:sv,pipe(){return M(this,arguments)},...$});var rL=BigInt(0),sL=($)=>{let X=$.keyType.bigint?rL:0,J=$.keyType.incremental?$.keyType.bigint?(Q)=>Q>=rL:(Q)=>Q>=0:(Q)=>!0,Z=(Q)=>{if(J(Q))X=X+Q};return VZ({get:()=>pL(X),update:Z,modify:Z})},tL=($)=>{let X=new Map;for(let Z of $.keyType.preregisteredWords)X.set(Z,0);let J=(Z)=>{let Q=X.get(Z)??0;X.set(Z,Q+1)};return VZ({get:()=>nL(X),update:J,modify:J})},eL=($,X)=>{let J=X;return VZ({get:()=>lL(J),update:(Z)=>{J=Z},modify:(Z)=>{J=J+Z}})},$q=($)=>{let X=$.keyType.boundaries.values,J=X.length,Z=new Uint32Array(J+1),Q=new Float64Array(J),Y=0,G=0,K=Number.MAX_VALUE,B=Number.MIN_VALUE;D(X,BX(V4),L$((V,N)=>{Q[N]=V}));let H=(V)=>{let N=0,A=J;while(N!==A){let F=Math.floor(N+(A-N)/2),E=Q[F];if(V<=E)A=F;else N=F;if(A===N+1)if(V<=Q[N])A=N;else N=A}if(Z[N]=Z[N]+1,Y=Y+1,G=G+V,V<K)K=V;if(V>B)B=V},z=()=>{let V=KJ(J),N=0;for(let A=0;A<J;A++){let F=Q[A],E=Z[A];N=N+E,V[A]=[F,N]}return V};return VZ({get:()=>oL({buckets:z(),count:Y,min:K,max:B,sum:G}),update:H,modify:H})},Xq=($)=>{let{error:X,maxAge:J,maxSize:Z,quantiles:Q}=$.keyType,Y=D(Q,BX(V4)),G=KJ(Z),K=0,B=0,H=0,z=0,V=0,N=(F)=>{let E=[],d=0;while(d!==Z-1){let n=G[d];if(n!=null){let[K0,_0]=n,c0=p$(F-K0);if(s3(c0,U4)&&EU(c0,J))E.push(_0)}d=d+1}return tv(X,Y,BX(E,V4))},A=(F,E)=>{if(Z>0){K=K+1;let d=K%Z;G[d]=[E,F]}z=B===0?F:Math.min(z,F),V=B===0?F:Math.max(V,F),B=B+1,H=H+F};return VZ({get:()=>iL({error:X,quantiles:N(Date.now()),count:B,min:z,max:V,sum:H}),update:([F,E])=>A(F,E),modify:([F,E])=>A(F,E)})},tv=($,X,J)=>{let Z=J.length;if(!f0(X))return h8();let Q=X[0],Y=X.slice(1),G=aL($,Z,T(),0,Q,J),K=$8(G);return Y.forEach((B)=>{K.push(aL($,Z,G.value,G.consumed,B,G.rest))}),L$(K,(B)=>[B.quantile,B.value])},aL=($,X,J,Z,Q,Y)=>{let G=$,K=X,B=J,H=Z,z=Q,V=Y,N=$,A=X,F=J,E=Z,d=Q,n=Y;while(!0){if(!f0(V))return{quantile:z,value:T(),consumed:H,rest:[]};if(z===1)return{quantile:z,value:q(S3(V)),consumed:H+V.length,rest:[]};let K0=g0(V),_0=lV(V,(L0)=>L0===K0),c0=z*K,l4=G/2*c0,t8=H+_0[0].length,uZ=Math.abs(t8-c0);if(t8<c0-l4){N=G,A=K,F=D4(V),E=t8,d=z,n=_0[1],G=N,K=A,B=F,H=E,z=d,V=n;continue}if(t8>c0+l4){let L0=J0(B)?q(K0):B;return{quantile:z,value:L0,consumed:H,rest:V}}switch(B._tag){case"None":{N=G,A=K,F=D4(V),E=t8,d=z,n=_0[1],G=N,K=A,B=F,H=E,z=d,V=n;continue}case"Some":{let L0=Math.abs(c0-B.value);if(uZ<L0){N=G,A=K,F=D4(V),E=t8,d=z,n=_0[1],G=N,K=A,B=F,H=E,z=d,V=n;continue}return{quantile:z,value:q(B.value),consumed:H,rest:V}}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")};var $y="effect/MetricPair",Xy=Symbol.for($y),Jy={_Type:($)=>$};var Jq=($,X)=>{return{[Xy]:Jy,metricKey:$,metricState:X,pipe(){return M(this,arguments)}}};var Qy="effect/MetricRegistry",Zq=Symbol.for(Qy);class Qq{[Zq]=Zq;map=uX();snapshot(){let $=[];for(let[X,J]of this.map)$.push(Jq(X,J.get()));return $}get($){let X=D(this.map,P0($),e0);if(X==null){if(nB($.keyType))return this.getCounter($);if(EL($.keyType))return this.getGauge($);if(CL($.keyType))return this.getFrequency($);if(lB($.keyType))return this.getHistogram($);if(IL($.keyType))return this.getSummary($);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return X}getCounter($){let X=D(this.map,P0($),e0);if(X==null){let J=sL($);if(!D(this.map,_$($)))D(this.map,j8($,J));X=J}return X}getFrequency($){let X=D(this.map,P0($),e0);if(X==null){let J=tL($);if(!D(this.map,_$($)))D(this.map,j8($,J));X=J}return X}getGauge($){let X=D(this.map,P0($),e0);if(X==null){let J=eL($,$.keyType.bigint?BigInt(0):0);if(!D(this.map,_$($)))D(this.map,j8($,J));X=J}return X}getHistogram($){let X=D(this.map,P0($),e0);if(X==null){let J=$q($);if(!D(this.map,_$($)))D(this.map,j8($,J));X=J}return X}getSummary($){let X=D(this.map,P0($),e0);if(X==null){let J=Xq($);if(!D(this.map,_$($)))D(this.map,j8($,J));X=J}return X}}var Yq=()=>{return new Qq};var Gy="effect/Metric",Ky=Symbol.for(Gy),By={_Type:($)=>$,_In:($)=>$,_Out:($)=>$},Gq=j(Symbol.for("effect/Metric/globalMetricRegistry"),()=>Yq()),Kq=function($,X,J,Z){let Q=Object.assign((Y)=>V8(Y,(G)=>Hy(Q,G)),{[Ky]:By,keyType:$,unsafeUpdate:X,unsafeValue:J,unsafeModify:Z,register(){return this.unsafeValue([]),this},pipe(){return M(this,arguments)}});return Q};var UZ=($,X)=>Bq(jL($,X));var Bq=($)=>{let X,J=new WeakMap,Z=(Q)=>{if(Q.length===0){if(X!==void 0)return X;return X=Gq.get($),X}let Y=J.get(Q);if(Y!==void 0)return Y;return Y=Gq.get(kL($,Q)),J.set(Q,Y),Y};return Kq($.keyType,(Q,Y)=>Z(Y).update(Q),(Q)=>Z(Q).get(),(Q,Y)=>Z(Y).modify(Q))};var Wq=($,X,J)=>Bq(xL($,X,J));var Hq=W(3,($,X,J)=>Wy($,[oX(X,J)]));var Wy=W(2,($,X)=>{return Kq($.keyType,(J,Z)=>$.unsafeUpdate(J,T$(X,Z)),(J)=>$.unsafeValue(T$(X,J)),(J,Z)=>$.unsafeModify(J,T$(X,Z)))});var Hy=W(2,($,X)=>l0(h6,(J)=>w(()=>$.unsafeUpdate(X,J))));var Dy="effect/Request",tB=Symbol.for(Dy),Vy={_E:($)=>$,_A:($)=>$},S40={...y$,[tB]:Vy},zq=($)=>P($,tB);var eB=W(2,($,X)=>l0(WY,(J)=>w(()=>{if(J.has($)){let Z=J.get($);if(!Z.state.completed)Z.state.completed=!0,oJ(Z.result,X)}})));class NZ{count=0;observers=new Set;interrupted=!1;addObserver($){this.observers.add($)}removeObserver($){this.observers.delete($)}increment(){this.count++,this.observers.forEach(($)=>$(this.count))}decrement(){this.count--,this.observers.forEach(($)=>$(this.count))}}var Ny="effect/Supervisor",AZ=Symbol.for(Ny),UY={_T:($)=>$};class OZ{underlying;value0;[AZ]=UY;constructor($,X){this.underlying=$,this.value0=X}get value(){return this.value0}onStart($,X,J,Z){this.underlying.onStart($,X,J,Z)}onEnd($,X){this.underlying.onEnd($,X)}onEffect($,X){this.underlying.onEffect($,X)}onSuspend($){this.underlying.onSuspend($)}onResume($){this.underlying.onResume($)}map($){return new OZ(this,D(this.value,L($)))}zip($){return new wZ(this,$)}}class wZ{left;right;_tag="Zip";[AZ]=UY;constructor($,X){this.left=$,this.right=X}get value(){return kX(this.left.value,this.right.value)}onStart($,X,J,Z){this.left.onStart($,X,J,Z),this.right.onStart($,X,J,Z)}onEnd($,X){this.left.onEnd($,X),this.right.onEnd($,X)}onEffect($,X){this.left.onEffect($,X),this.right.onEffect($,X)}onSuspend($){this.left.onSuspend($),this.right.onSuspend($)}onResume($){this.left.onResume($),this.right.onResume($)}map($){return new OZ(this,D(this.value,L($)))}zip($){return new wZ(this,$)}}var $W=($)=>P($,AZ)&&k$($,"Zip");class Dq{[AZ]=UY;fibers=new Set;get value(){return w(()=>Array.from(this.fibers))}onStart($,X,J,Z){this.fibers.add(Z)}onEnd($,X){this.fibers.delete(X)}onEffect($,X){}onSuspend($){}onResume($){}map($){return new OZ(this,D(this.value,L($)))}zip($){return new wZ(this,$)}onRun($,X){return $()}}class Vq{effect;[AZ]=UY;constructor($){this.effect=$}get value(){return this.effect}onStart($,X,J,Z){}onEnd($,X){}onEffect($,X){}onSuspend($){}onResume($){}map($){return new OZ(this,D(this.value,L($)))}zip($){return new wZ(this,$)}onRun($,X){return $()}}var Ay=()=>{return new Dq},Uq=w(Ay),Oy=($)=>{return new Vq($)},X5=j("effect/Supervisor/none",()=>Oy(k));var Nq=F4;var Oq="Empty",wq="AddSupervisor",Fq="RemoveSupervisor",Tq="AndThen",D7={_tag:Oq},AY=($,X)=>{return{_tag:Tq,first:$,second:X}},wy=($,X)=>{return Fy(X,V0($))},Fy=($,X)=>{let J=$,Z=X;while(p0(Z)){let Q=d0(Z);switch(Q._tag){case Oq:{Z=X8(Z);break}case wq:{J=J.zip(Q.supervisor),Z=X8(Z);break}case Fq:{J=XW(J,Q.supervisor),Z=X8(Z);break}case Tq:{Z=m0(Q.first)(m0(Q.second)(X8(Z)));break}}}return J},XW=($,X)=>{if(C($,X))return X5;else if($W($))return XW($.left,X).zip(XW($.right,X));else return $},OY=($)=>{if(C($,X5))return o$();else if($W($))return D(OY($.left),i$(OY($.right)));else return NX($)},Ty=($,X)=>{if(C($,X))return D7;let J=OY($),Z=OY(X),Q=D(Z,W2(J),wX(D7,(G,K)=>AY(G,{_tag:wq,supervisor:K}))),Y=D(J,W2(Z),wX(D7,(G,K)=>AY(G,{_tag:Fq,supervisor:K})));return AY(Q,Y)},Lq=Nq({empty:D7,patch:wy,combine:AY,diff:Ty});var qy=UZ("effect_fiber_started",{incremental:!0}),qq=UZ("effect_fiber_active"),My=UZ("effect_fiber_successes",{incremental:!0}),Py=UZ("effect_fiber_failures",{incremental:!0}),_y=Hq(Wq("effect_fiber_lifetimes",OL({start:0.5,factor:2,count:35})),"time_unit","milliseconds"),FZ="Continue",Cy="Done",Mq="Yield",Ey={_E:($)=>$,_A:($)=>$},wY=($)=>{throw Error(`BUG: FiberRuntime - ${O6($)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},i6=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),r6=j("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),TZ={[T5]:($,X,J)=>{return D0(()=>X.effect_instruction_i1(J))},["OnStep"]:($,X,J)=>{return Z0(Z0(J))},[L5]:($,X,J)=>{return D0(()=>X.effect_instruction_i2(J))},[JJ]:($,X,J)=>{if($.patchRuntimeFlags($.currentRuntimeFlags,X.patch),C6($.currentRuntimeFlags)&&$.isInterrupted())return r($.getInterruptedCause());else return Z0(J)},[q5]:($,X,J)=>{if(D0(()=>X.effect_instruction_i2(J)),D0(()=>X.effect_instruction_i0()))return $.pushStack(X),D0(()=>X.effect_instruction_i1());else return k},[GX]:($,X,J)=>{while(!0){let Z=D0(()=>X.effect_instruction_i0.next(J));if(Z.done)return Z0(Z.value);let Q=H3(Z.value);if(!a5(Q))return $.pushStack(X),Q;else if(Q._tag==="Failure")return Q;J=Q.value}}},Iy={[gB]:($,X,J,Z)=>{return $.processNewInterruptSignal(Z.cause),C6(X)?r(Z.cause):J},[mB]:($,X,J,Z)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[hB]:($,X,J,Z)=>{return Z.onFiber($,PB(X)),J},[dB]:($,X,J,Z)=>{return U(Q6(),()=>J)}},Ry=($)=>f8(pN($),(X)=>a6(oN(X),([J,Z])=>{let Q=new Map,Y=[];for(let K of Z){Y.push(d8(K));for(let B of K)Q.set(B.request,B)}let G=Y.flat();return H0(uy(J.runAll(Y),G,()=>G.forEach((K)=>{K.listeners.interrupted=!0})),WY,Q)},!1,!1)),Sy=QJ();class MY extends b4{[WZ]=HZ;[cB]=Ey;_fiberRefs;_fiberId;_queue=[];_children=null;_observers=[];_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor($,X,J){super();if(this.currentRuntimeFlags=J,this._fiberId=$,this._fiberRefs=X,k2(J)){let Z=this.getFiberRef(h6);qy.unsafeUpdate(1,Z),qq.unsafeUpdate(1,Z)}this.refreshRefCache()}commit(){return C$(this)}id(){return this._fiberId}resume($){this.tell(eX($))}get status(){return this.ask(($,X)=>X)}get runtimeFlags(){return this.ask(($,X)=>{if(kT(X))return $.currentRuntimeFlags;return X.runtimeFlags})}scope(){return ZL(this)}get children(){return this.ask(($)=>Array.from($.getChildren()))}getChildren(){if(this._children===null)this._children=new Set;return this._children}getInterruptedCause(){return this.getFiberRef(bX)}fiberRefs(){return this.ask(($)=>$.getFiberRefs())}ask($){return S(()=>{let X=pJ(this._fiberId);return this.tell(z7((J,Z)=>{oJ(X,w(()=>$(J,Z)))})),v0(X)})}tell($){if(this._queue.push($),!this._running)this._running=!0,this.drainQueueLaterOnExecutor()}get await(){return Z8(($)=>{let X=(J)=>$(O(J));return this.tell(z7((J,Z)=>{if(J._exitValue!==null)X(this._exitValue);else J.addObserver(X)})),w(()=>this.tell(z7((J,Z)=>{J.removeObserver(X)})))},this.id())}get inheritAll(){return m(($,X)=>{let J=$.id(),Z=$.getFiberRefs(),Q=X.runtimeFlags,Y=this.getFiberRefs(),G=R1(Z,J,Y);$.setFiberRefs(G);let K=$.getFiberRef(Cq),B=D(Y$(Q,K),g2(M$),g2(VQ));return E4(B)})}get poll(){return w(()=>z4(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork($){return w(()=>this.tell(HY(c8($))))}unsafeInterruptAsFork($){this.tell(HY(c8($)))}addObserver($){if(this._exitValue!==null)$(this._exitValue);else this._observers.push($)}removeObserver($){this._observers=this._observers.filter((X)=>X!==$)}getFiberRefs(){return this.setFiberRef(Cq,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef($){this._fiberRefs=XZ(this._fiberRefs,$)}getFiberRef($){if(this._fiberRefs.locals.has($))return this._fiberRefs.locals.get($)[0][1];return $.initial}setFiberRef($,X){this._fiberRefs=Z7(this._fiberRefs,{fiberId:this._fiberId,fiberRef:$,value:X}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(G0),this.currentTracer=this.currentDefaultServices.unsafeMap.get(u6.key),this.currentSupervisor=this.getFiberRef(CY),this.currentScheduler=this.getFiberRef(l6),this.currentContext=this.getFiberRef(R8),this.currentSpan=this.currentContext.unsafeMap.get(O8.key)}setFiberRefs($){this._fiberRefs=$,this.refreshRefCache()}addChild($){this.getChildren().add($)}removeChild($){this.getChildren().delete($)}transferChildren($){let X=this._children;if(this._children=null,X!==null&&X.size>0){for(let J of X)if(J._exitValue===null)$.add(this.currentRuntimeFlags,J)}}drainQueueOnCurrentThread(){let $=!0;while($){let X=FZ,J=globalThis[c4];globalThis[c4]=this;try{while(X===FZ)X=this._queue.length===0?Cy:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[c4]=J}if(this._queue.length>0&&!this._running)if(this._running=!0,X===Mq)this.drainQueueLaterOnExecutor(),$=!1;else $=!0;else $=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(b6))}drainQueueWhileRunning($,X){let J=X;while(this._queue.length>0){let Z=this._queue.splice(0,1)[0];J=Iy[Z._tag](this,$,J,Z)}return J}isInterrupted(){return!FQ(this.getFiberRef(bX))}addInterruptedCause($){let X=this.getFiberRef(bX);this.setFiberRef(bX,B0(X,$))}processNewInterruptSignal($){this.addInterruptedCause($),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let $=!1;for(let X of this._children)X.tell(HY(c8(this.id()))),$=!0;return $}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let $=this._children.values();this._children=null;let X=!1;return I4({while:()=>!X,body:()=>{let Z=$.next();if(!Z.done)return U0(Z.value.await);else return w(()=>{X=!0})},step:()=>{}})}return null}reportExitValue($){if(k2(this.currentRuntimeFlags)){let X=this.getFiberRef(h6),J=this.id().startTimeMillis,Z=Date.now();switch(_y.unsafeUpdate(Z-J,X),qq.unsafeUpdate(-1,X),$._tag){case O0:{My.unsafeUpdate(1,X);break}case A0:{Py.unsafeUpdate(1,X);break}}}if($._tag==="Failure"){let X=this.getFiberRef(gJ);if(!u5($.cause)&&X._tag==="Some")this.log("Fiber terminated with an unhandled error",$.cause,X)}}setExitValue($){this._exitValue=$,this.reportExitValue($);for(let X=this._observers.length-1;X>=0;X--)this._observers[X]($);this._observers=[]}getLoggers(){return this.getFiberRef(Iq)}log($,X,J){let Z=w0(J)?J.value:this.getFiberRef(WK),Q=this.getFiberRef(ZW);if(iK(Q,Z))return;let Y=this.getFiberRef(uQ),G=this.getFiberRef(g6),K=this.getLoggers(),B=this.getFiberRefs();if(AX(K)>0){let H=E0(this.getFiberRef(G0),N8),z=new Date(H.unsafeCurrentTimeMillis());UV(B,()=>{for(let V of K)V.log({fiberId:this.id(),logLevel:Z,message:$,cause:X,context:B,spans:Y,annotations:G,date:z})})}}evaluateMessageWhileSuspended($){switch($._tag){case dB:return Mq;case gB:{if(this.processNewInterruptSignal($.cause),this._asyncInterruptor!==null)this._asyncInterruptor(r($.cause)),this._asyncInterruptor=null;return FZ}case mB:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect($.effect),FZ;case hB:return $.onFiber(this,this._exitValue!==null?jT:xT(this.currentRuntimeFlags,this._asyncBlockingOn)),FZ;default:return wY($)}}evaluateEffect($){this.currentSupervisor.onResume(this);try{let X=C6(this.currentRuntimeFlags)&&this.isInterrupted()?r(this.getInterruptedCause()):$;while(X!==null){let J=X,Z=this.runLoop(J);if(Z===i6){let Q=r6.currentOp;if(r6.currentOp=null,Q._op===M5)if(dN(this.currentRuntimeFlags))this.tell(eT()),this.tell(eX(U8)),X=null;else X=U8;else if(Q._op===QX)X=null}else{this.currentRuntimeFlags=D(this.currentRuntimeFlags,j2(VQ));let Q=this.interruptAllChildren();if(Q!==null)X=U(Q,()=>Z);else{if(this._queue.length===0)this.setExitValue(Z);else this.tell(eX(Z));X=null}}}}finally{this.currentSupervisor.onSuspend(this)}}start($){if(!this._running){this._running=!0;let X=globalThis[c4];globalThis[c4]=this;try{this.evaluateEffect($)}finally{if(this._running=!1,globalThis[c4]=X,this._queue.length>0)this.drainQueueLaterOnExecutor()}}else this.tell(eX($))}startFork($){this.tell(eX($))}patchRuntimeFlags($,X){let J=E6($,X);return globalThis[c4]=this,this.currentRuntimeFlags=J,J}initiateAsync($,X){let J=!1,Z=(Q)=>{if(!J)J=!0,this.tell(eX(Q))};if(C6($))this._asyncInterruptor=Z;try{X(Z)}catch(Q){Z(h(M0(Q)))}}pushStack($){if(this._stack.push($),$._op==="OnStep")this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let $=this._stack.pop();if($){if($._op==="OnStep")this._steps.pop();return $}return}getNextSuccessCont(){let $=this.popStack();while($){if($._op!==F5)return $;$=this.popStack()}}getNextFailCont(){let $=this.popStack();while($){if($._op!==T5&&$._op!==q5&&$._op!==GX)return $;$=this.popStack()}}[AV]($){return w(()=>X$(this.currentContext,$))}["Left"]($){return v($.left)}["None"]($){return v(new l8)}["Right"]($){return Z0($.right)}["Some"]($){return Z0($.value)}["Micro"]($){return n5((X)=>{let J=X,Z=iT(nT($,this.currentContext));return Z.addObserver((Q)=>{if(Q._tag==="Success")return J(Z0(Q.value));switch(Q.cause._tag){case"Interrupt":return J(r(c8(P8)));case"Fail":return J(v(Q.cause.error));case"Die":return J(Q8(Q.cause.defect))}}),n5((Q)=>{J=(Y)=>{Q(k)},Z.unsafeInterrupt()})})}[q9]($){let X=D0(()=>$.effect_instruction_i0()),J=this.getNextSuccessCont();if(J!==void 0){if(!(J._op in TZ))wY(J);return TZ[J._op](this,J,X)}else return r6.currentOp=Z0(X),i6}[O0]($){let X=$,J=this.getNextSuccessCont();if(J!==void 0){if(!(J._op in TZ))wY(J);return TZ[J._op](this,J,X.effect_instruction_i0)}else return r6.currentOp=X,i6}[A0]($){let X=$.effect_instruction_i0,J=this.getNextFailCont();if(J!==void 0)switch(J._op){case F5:case L5:if(!(C6(this.currentRuntimeFlags)&&this.isInterrupted()))return D0(()=>J.effect_instruction_i1(X));else return r(qQ(X));case"OnStep":if(!(C6(this.currentRuntimeFlags)&&this.isInterrupted()))return Z0(r(X));else return r(qQ(X));case JJ:if(this.patchRuntimeFlags(this.currentRuntimeFlags,J.patch),C6(this.currentRuntimeFlags)&&this.isInterrupted())return r(B0(X,this.getInterruptedCause()));else return r(X);default:wY(J)}else return r6.currentOp=r(X),i6}[M9]($){return D0(()=>$.effect_instruction_i0(this,PB(this.currentRuntimeFlags)))}["Blocked"]($){let X=this.getFiberRefs(),J=this.currentRuntimeFlags;if(this._steps.length>0){let Z=[],Q=this._steps[this._steps.length-1],Y=this.popStack();while(Y&&Y._op!=="OnStep")Z.push(Y),Y=this.popStack();this.setFiberRefs(Q.refs),this.currentRuntimeFlags=Q.flags;let G=sX(Q.refs,X),K=Y$(Q.flags,J);return Z0(R6($.effect_instruction_i0,m((B)=>{while(Z.length>0)B.pushStack(Z.pop());return B.setFiberRefs(tX(B.id(),B.getFiberRefs())(G)),B.currentRuntimeFlags=E6(K)(B.currentRuntimeFlags),$.effect_instruction_i1})))}return N0((Z)=>U(LZ(CQ($.effect_instruction_i0)),()=>Z($.effect_instruction_i1)))}["RunBlocked"]($){return Ry($.effect_instruction_i0)}[w6]($){let X=$.effect_instruction_i0,J=this.currentRuntimeFlags,Z=E6(J,X);if(C6(Z)&&this.isInterrupted())return r(this.getInterruptedCause());else if(this.patchRuntimeFlags(this.currentRuntimeFlags,X),$.effect_instruction_i1){let Q=Y$(Z,J);return this.pushStack(new e2(Q,$)),D0(()=>$.effect_instruction_i1(J))}else return U8}[T5]($){return this.pushStack($),$.effect_instruction_i0}["OnStep"]($){return this.pushStack($),$.effect_instruction_i0}[F5]($){return this.pushStack($),$.effect_instruction_i0}[L5]($){return this.pushStack($),$.effect_instruction_i0}[QX]($){return this._asyncBlockingOn=$.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,$.effect_instruction_i0),r6.currentOp=$,i6}[M5]($){return this._isYielding=!1,r6.currentOp=$,i6}[q5]($){let{effect_instruction_i0:X,effect_instruction_i1:J}=$;if(X())return this.pushStack($),J();else return U8}[GX]($){return TZ[GX](this,$,void 0)}[YX]($){return D0(()=>$.commit())}runLoop($){let X=$;this.currentOpCount=0;while(!0){if((this.currentRuntimeFlags&mN)!==0)this.currentSupervisor.onEffect(this,X);if(this._queue.length>0)X=this.drainQueueWhileRunning(this.currentRuntimeFlags,X);if(!this._isYielding){this.currentOpCount+=1;let J=this.currentScheduler.shouldYield(this);if(J!==!1){this._isYielding=!0,this.currentOpCount=0;let Z=X;X=U(Q6({priority:J}),()=>Z)}}try{if(X=this.currentTracer.context(()=>{if(Sy!==X[S6]._V){let J=this.getFiberRef(pQ);if(J._tag==="Some"){let Z=X[S6]._V;this.log(`Executing an Effect versioned ${Z} with a Runtime of version ${QJ()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,H8,J)}}return this[X._op](X)},this),X===i6){let J=r6.currentOp;if(J._op===M5||J._op===QX)return i6;return r6.currentOp=null,J._op===O0||J._op===A0?J:r(M0(J))}}catch(J){if(X!==i6&&!P(X,"_op")||!(X._op in this))X=M4(`Not a valid effect: ${O6(X)}`);else if(EA(J))X=r(B0(M0(J),c8(P8)));else X=Q8(J)}}}run=()=>{this.drainQueueOnCurrentThread()}}var ZW=j("effect/FiberRef/currentMinimumLogLevel",()=>z0(rK("Info"))),jy=($)=>DY((X)=>{let J=Xw(X.context,G0);E0(J,d6).unsafe.log($.log(X))});var xy=j(Symbol.for("effect/Logger/defaultLogger"),()=>jy(VL));var ky=j(Symbol.for("effect/Logger/tracerLogger"),()=>DY(({annotations:$,cause:X,context:J,fiberId:Z,logLevel:Q,message:Y})=>{let G=J$(p6(J,R8),O8);if(G._tag==="None"||G.value._tag==="ExternalSpan")return;let K=X$(p6(J,G0),N8),B={};for(let[H,z]of $)B[H]=z;if(B["effect.fiberId"]=HN(Z),B["effect.logLevel"]=Q.label,X!==null&&X._tag!=="Empty")B["effect.cause"]=$6(X,{renderErrorCause:!0});G.value.event(O6(Array.isArray(Y)&&Y.length===1?Y[0]:Y),K.unsafeCurrentTimeNanos(),B)}));var Iq=j(Symbol.for("effect/FiberRef/currentLoggers"),()=>qA(NX(xy,ky)));var Rq=function(){if(typeof arguments[0]==="string")return i0(g6,J8(arguments[0],arguments[1]));let $=Object.entries(arguments[0]);return i0(g6,VN((X)=>{for(let J=0;J<$.length;J++){let[Z,Q]=$[J];J8(X,Z,Q)}return X}))},Sq=W(2,($,X)=>{let J=typeof X==="string"?rK(X):X;return m((Z)=>{let Q=Z.getFiberRef(ZW);if(iK(Q,J))return O(T());return L($,q)})}),V7=W(($)=>o($[0]),($,X)=>y6(V8($,(J)=>B6((Z)=>X(J,Z))))),jq=W(($)=>o($[0]),($,X)=>D$($,B6((J)=>X(J)))),B6=($)=>m((X)=>{let J=X.getFiberRefs(),Z=S2(X.currentRuntimeFlags,M$);return U(HW,(Q)=>gX(Q,(Y)=>m((G)=>{let K=G.getFiberRefs(),B=G.currentRuntimeFlags,H=sX(K,J),z=Y$(B,Z),V=sX(J,K);return G.setFiberRefs(tX(H,G.id(),J)),D$(bQ($(Y),z),w(()=>{G.setFiberRefs(tX(V,G.id(),G.getFiberRefs()))}))})))}),xq=($)=>{return H0(RJ,q(o6))($)},Pq=Symbol.for("effect/Effect/existsPar/found"),kq=W(($)=>e8($[0])&&!o($[0]),($,X,J)=>BZ(J?.concurrency,()=>S(()=>vq($[Symbol.iterator](),0,X)),()=>I0(s8($,(Z,Q)=>SQ(X(Z,Q),{onTrue:()=>v(Pq),onFalse:()=>k}),J),{onFailure:(Z)=>Z===Pq?O(!0):v(Z),onSuccess:()=>O(!1)}))),vq=($,X,J)=>{let Z=$.next();if(Z.done)return O(!1);return U(J(Z.value,X),(Q)=>Q?O(Q):vq($,X+1,J))},yq=W(($)=>e8($[0])&&!o($[0]),($,X,J)=>{let Z=J?.negate?(Q,Y)=>L(X(Q,Y),eV):X;return BZ(J?.concurrency,()=>S(()=>c($).reduceRight((Q,Y,G)=>Y6(Q,S(()=>Z(Y,G)),(K,B)=>B?[Y,...K]:K),w(()=>[]))),()=>L(s8($,(Q,Y)=>L(Z(Q,Y),(G)=>G?q(Q):T()),J),rV))}),vy=($)=>{if(Array.isArray($)||e8($))return[$,T()];let X=Object.keys($),J=X.length;return[X.map((Z)=>$[Z]),q((Z)=>{let Q={};for(let Y=0;Y<J;Y++)Q[X[Y]]=Z[Y];return Q})]},yy=($,X,J)=>{let Z=[];for(let Q of $)Z.push(_8(Q));return U(s8(Z,y,{concurrency:J?.concurrency,batching:J?.batching,concurrentFinalizers:J?.concurrentFinalizers}),(Q)=>{let Y=T(),G=Q.length,K=Array(G),B=Array(G),H=!1;for(let z=0;z<G;z++){let V=Q[z];if(V._tag==="Left")K[z]=q(V.left),H=!0;else B[z]=V.right,K[z]=Y}if(H)return X._tag==="Some"?v(X.value(K)):v(K);else if(J?.discard)return k;return X._tag==="Some"?O(X.value(B)):O(B)})},by=($,X,J)=>{let Z=[];for(let Q of $)Z.push(_8(Q));if(J?.discard)return s8(Z,y,{concurrency:J?.concurrency,batching:J?.batching,discard:!0,concurrentFinalizers:J?.concurrentFinalizers});return L(s8(Z,y,{concurrency:J?.concurrency,batching:J?.batching,concurrentFinalizers:J?.concurrentFinalizers}),(Q)=>X._tag==="Some"?X.value(Q):Q)},W6=($,X)=>{let[J,Z]=vy($);if(X?.mode==="validate")return yy(J,Z,X);else if(X?.mode==="either")return by(J,Z,X);return X?.discard!==!0&&Z._tag==="Some"?L(s8(J,y,X),Z.value):s8(J,y,X)},bq=($)=>(X)=>W6(X,$),gq=($,X)=>L(W6(c($).map(W0),X),C5((J)=>aQ(J)?q(J.effect_instruction_i0):T())),QW=W(2,($,X)=>Array.from({length:X},()=>$)),hq=W(($)=>o($[0]),($,X,J)=>W6(QW($,X),J)),s8=W(($)=>e8($[0]),($,X,J)=>m((Z)=>{let Q=J?.batching===!0||J?.batching==="inherit"&&Z.getFiberRef(bJ);if(J?.discard)return bB(J.concurrency,()=>J5(a1,J?.concurrentFinalizers)((Y)=>Q?a6($,(G,K)=>Y(X(G,K)),!0,!1,1):f8($,(G,K)=>Y(X(G,K)))),()=>J5(s1,J?.concurrentFinalizers)((Y)=>a6($,(G,K)=>Y(X(G,K)),Q,!1)),(Y)=>J5(t1(Y),J?.concurrentFinalizers)((G)=>a6($,(K,B)=>G(X(K,B)),Q,!1,Y)));return bB(J?.concurrency,()=>J5(a1,J?.concurrentFinalizers)((Y)=>Q?JW($,1,(G,K)=>Y(X(G,K)),!0):n0($,(G,K)=>Y(X(G,K)))),()=>J5(s1,J?.concurrentFinalizers)((Y)=>FY($,(G,K)=>Y(X(G,K)),Q)),(Y)=>J5(t1(Y),J?.concurrentFinalizers)((G)=>JW($,Y,(K,B)=>G(X(K,B)),Q)))})),FY=($,X,J)=>S(()=>{let Z=c($),Q=Array(Z.length);return p(a6(Z,(G,K)=>U(X(G,K),(B)=>w(()=>Q[K]=B)),J,!1),O(Q))}),a6=($,X,J,Z,Q)=>N0((Y)=>vQ((G)=>m((K)=>{let B=Array.from($).reverse(),H=B.length;if(H===0)return k;let z=0,V=!1,N=Q?Math.min(B.length,Q):B.length,A=new Set,F=[],E=()=>A.forEach((L0)=>{L0.currentScheduler.scheduleTask(()=>{L0.unsafeInterruptAsFork(K.id())},0)}),d=[],n=[],K0=[],_0=()=>{let L0=F.filter(({exit:x8})=>x8._tag==="Failure").sort((x8,R$)=>x8.index<R$.index?-1:x8.index===R$.index?0:1).map(({exit:x8})=>x8);if(L0.length===0)L0.push(U8);return L0},c0=(L0,x8=!1)=>{let R$=y6(G(L0)),a0=gy(R$,K,K.currentRuntimeFlags,o6);return K.currentScheduler.scheduleTask(()=>{if(x8)a0.unsafeInterruptAsFork(K.id());a0.resume(R$)},0),a0},l4=()=>{if(!Z)H-=B.length,B=[];V=!0,E()},t8=J?RQ:W0,uZ=c0(Z8((L0)=>{let x8=(a0,V6)=>{if(a0._op==="Blocked")K0.push(a0);else if(F.push({index:V6,exit:a0}),a0._op==="Failure"&&!V)l4()},R$=()=>{if(B.length>0){let a0=B.pop(),V6=z++,WG=()=>{let A$=B.pop();return V6=z++,U(Q6(),()=>U(t8(Y(X(A$,V6))),_7))},_7=(A$)=>{if(B.length>0){if(x8(A$,V6),B.length>0)return WG()}return O(A$)},B5=U(t8(Y(X(a0,V6))),_7),S$=c0(B5);if(d.push(S$),A.add(S$),V)S$.currentScheduler.scheduleTask(()=>{S$.unsafeInterruptAsFork(K.id())},0);S$.addObserver((A$)=>{let Z4;if(A$._op==="Failure")Z4=A$;else Z4=A$.effect_instruction_i0;if(n.push(S$),A.delete(S$),x8(Z4,V6),F.length===H)L0(O(S0(dX(_0(),{parallel:!0}),()=>U8)));else if(K0.length+F.length===H){let HG=_0(),zG=K0.map((C7)=>C7.effect_instruction_i0).reduce(d2);L0(O(R6(zG,a6([S0(dX(HG,{parallel:!0}),()=>U8),...K0.map((C7)=>C7.effect_instruction_i1)],(C7)=>C7,J,!0,Q))))}else R$()})}};for(let a0=0;a0<N;a0++)R$()}));return U0(D8(E8(Y(C$(uZ))),s5({onFailure:(L0)=>{l4();let x8=K0.length+1,R$=Math.min(typeof Q==="number"?Q:K0.length,K0.length),a0=Array.from(K0);return Z8((V6)=>{let WG=[],_7=0,B5=0,S$=(Z4,HG)=>(zG)=>{if(WG[Z4]=zG,_7++,_7===x8)V6(Z0(r(L0)));if(a0.length>0&&HG)A$()},A$=()=>{c0(a0.pop(),!0).addObserver(S$(B5,!0)),B5++};uZ.addObserver(S$(B5,!1)),B5++;for(let Z4=0;Z4<R$;Z4++)A$()})},onSuccess:()=>n0(n,(L0)=>L0.inheritAll)})))}))),JW=($,X,J,Z)=>S(()=>{let Q=c($),Y=Array(Q.length);return p(a6(Q,(K,B)=>L(J(K,B),(H)=>Y[B]=H),Z,!1,X),O(Y))}),s6=($)=>m((X,J)=>O(qZ($,X,J.runtimeFlags))),LZ=($)=>hy($,o6),mq=W(2,($,X)=>s6(kQ($,(J)=>{let Z=P$(J);switch(Z._tag){case"Left":return X(Z.left);case"Right":return h(Z.right)}}))),qZ=($,X,J,Z=null)=>{let Q=TY($,X,J,Z);return Q.resume($),Q},gy=($,X,J,Z=null)=>{return TY($,X,J,Z)},TY=($,X,J,Z=null)=>{let Q=QQ(),Y=X.getFiberRefs(),G=mK(Y,Q),K=new MY(Q,G,J),B=p6(G,R8),H=K.currentSupervisor;return H.onStart(B,$,q(X),K),K.addObserver((V)=>H.onEnd(V,K)),(Z!==null?Z:D(X.getFiberRef(RJ),S0(()=>X.scope()))).add(J,K),K},hy=($,X)=>m((J,Z)=>O(qZ($,J,Z.runtimeFlags,X))),YW=W(($)=>w$($[2]),($,X,J,Z)=>BZ(Z?.concurrency,()=>c($).reduce((Q,Y,G)=>Y6(Q,Y,(K,B)=>J(K,B,G)),O(X)),()=>U(v1(X),(Q)=>U(s8($,(Y,G)=>U(Y,(K)=>Uw(Q,(B)=>J(B,K,G))),Z),()=>y1(Q))))),GW=W(($)=>e8($[0]),($,X,J)=>D(s8($,(Z,Q)=>_8(X(Z,Q)),J),L((Z)=>OA(Z,y)))),dq=W(($)=>e8($[0]),($,X,J)=>U(GW($,X,{concurrency:J?.concurrency,batching:J?.batching,concurrentFinalizers:J?.concurrentFinalizers}),([Z,Q])=>E9(Z)?v(Z):J?.discard?k:O(Q))),cq=($)=>m((X,J)=>Z8((Z)=>{let Q=new Set,Y,G=H8,K=()=>{for(let z of Q)z.unsafeInterruptAsFork(X.id())},B=!1,H=!0;for(let z of $){H=!1;let V=qZ(k6(z),X,J.runtimeFlags);if(Q.add(V),V.addObserver((N)=>{if(Q.delete(V),!Y)if(N._tag==="Success")B=!0,Y=V,G=H8,K();else G=z8(N.cause,G);if(B&&Q.size===0)Z(Y?p(KL(Y),Y.unsafePoll()):h(G))}),Y)break}if(H)return Z(P4(()=>new mJ("Received an empty collection of effects")));return B=!0,BL(Q,X.id())})),uq=W(($)=>e8($[0])&&!o($[0]),($,X,J,Z)=>BZ(Z?.concurrency,()=>c($).reduce((Q,Y,G)=>Y6(Q,Y,(K,B)=>J(K,B,G)),X),()=>S(()=>D(YW([X,...$],T(),(Q,Y,G)=>{switch(Q._tag){case"None":return q(Y);case"Some":return q(J(Q.value,Y,G))}},Z),L((Q)=>{switch(Q._tag){case"None":throw Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return Q.value}}))))),LY=($)=>K$((X)=>C0(J$(X,H6),{onNone:()=>$,onSome:(J)=>{switch(J.strategy._tag){case"Parallel":return $;case"Sequential":case"ParallelN":return U(n8(J,s1),(Z)=>e6($,Z))}}})),_q=($)=>(X)=>K$((J)=>C0(J$(J,H6),{onNone:()=>X,onSome:(Z)=>{if(Z.strategy._tag==="ParallelN"&&Z.strategy.parallelism===$)return X;return U(n8(Z,t1($)),(Q)=>e6(X,Q))}})),fq=($)=>(X)=>J5($,!0)(X),J5=($,X)=>(J)=>K$((Z)=>C0(J$(Z,H6),{onNone:()=>J(y),onSome:(Q)=>{if(X===!0){let Y=$._tag==="Parallel"?LY:$._tag==="Sequential"?qY:_q($.parallelism);switch(Q.strategy._tag){case"Parallel":return Y(J(LY));case"Sequential":return Y(J(qY));case"ParallelN":return Y(J(_q(Q.strategy.parallelism)))}}else return J(y)}})),z$=($)=>U(H6,$),MZ=($)=>U(U7(),(X)=>D8($(X),(J)=>X.close(J))),PY=($)=>U(U7(),(X)=>XM($,X)),qY=($)=>K$((X)=>C0(J$(X,H6),{onNone:()=>$,onSome:(J)=>{switch(J.strategy._tag){case"Sequential":return $;case"Parallel":case"ParallelN":return U(n8(J,a1),(Z)=>e6($,Z))}}})),pq=($,X)=>KW([oX($,X)]),KW=($)=>i0(h6,(X)=>T$(X,$)),nq=W(2,($,X)=>MZ((J)=>U(e6($,J),X))),lq=W(($)=>o($[1]),($,X,J)=>BW($,X,(Z,Q)=>[Z,Q],J)),BW=W(($)=>o($[1]),($,X,J,Z)=>E8(t6(W0($),W0(X),(Q,Y)=>fJ(Q,Y,{onSuccess:J,onFailure:(G,K)=>Z?.concurrent?z8(G,K):B0(G,K)}),Z)));var oq=W(($)=>e8($[0]),($,X,J)=>C4(s8($,(Z,Q)=>C4(X(Z,Q)),J))),iq=($)=>i0(G0,t(N8,$)),rq=($)=>i0(G0,t(c6,$)),_Y=($)=>i0(G0,t(x4,$)),aq=($)=>z$((X)=>U(n8(X,W$),(J)=>D($,e6(J),L((Z)=>[C8((Q)=>hX(J,sQ(Q))),Z])))),sq=W(($)=>o($[1]),($,X,J)=>t6($,X,(Z,Q)=>[Z,Q],J)),tq=W(($)=>o($[1]),($,X,J)=>{if(J?.concurrent!==!0&&(J?.batching===void 0||J.batching===!1))return vX($,X);return t6($,X,(Z,Q)=>Z,J)}),eq=W(($)=>o($[1]),($,X,J)=>{if(J?.concurrent!==!0&&(J?.batching===void 0||J.batching===!1))return p($,X);return t6($,X,(Z,Q)=>Q,J)}),t6=W(($)=>o($[1]),($,X,J,Z)=>L(W6([$,X],{concurrency:Z?.concurrent?2:1,batching:Z?.batching,concurrentFinalizers:Z?.concurrentFinalizers}),([Q,Y])=>J(Q,Y))),WW=($)=>{if($===uN)return k;return D(l5,U((X)=>{let J=E6(X,$),Z=Y$(J,X);return D(E4($),p(B6(()=>E4(Z))),U0)}),y6)},H6=x0("effect/Scope"),HW=H6,my=($,X)=>{if($.state._tag==="Open")$.state.finalizers.set({},X)},dy={[lQ]:lQ,[oQ]:oQ,pipe(){return M(this,arguments)},fork($){return w(()=>{let X=$M($);if(this.state._tag==="Closed")return X.state=this.state,X;let J={},Z=(Q)=>X.close(Q);return this.state.finalizers.set(J,Z),my(X,(Q)=>w(()=>{if(this.state._tag==="Open")this.state.finalizers.delete(J)})),X})},close($){return S(()=>{if(this.state._tag==="Closed")return k;let X=Array.from(this.state.finalizers.values()).reverse();if(this.state={_tag:"Closed",exit:$},X.length===0)return k;return LB(this.strategy)?D(n0(X,(J)=>W0(J($))),U((J)=>D(dX(J),h$(cJ),S0(()=>U8)))):qB(this.strategy)?D(FY(X,(J)=>W0(J($)),!1),U((J)=>D(dX(J,{parallel:!0}),h$(cJ),S0(()=>U8)))):D(JW(X,this.strategy.parallelism,(J)=>W0(J($)),!1),U((J)=>D(dX(J,{parallel:!0}),h$(cJ),S0(()=>U8))))})},addFinalizer($){return S(()=>{if(this.state._tag==="Closed")return $(this.state.exit);return this.state.finalizers.set({},$),k})}},$M=($=W$)=>{let X=Object.create(dy);return X.strategy=$,X.state={_tag:"Open",finalizers:new Map},X},U7=($=W$)=>w(()=>$M($)),e6=W(2,($,X)=>cX($,Z$(q8(H6,X)))),XM=W(2,($,X)=>D($,e6(X),D8((J)=>X.close(J)))),cy=($)=>yX($,{differ:Lq,fork:D7}),Y8=W(2,($,X)=>U0(V7(U(p8($),(J)=>e(SX($,X),J)),(J)=>SX($,J)))),i0=W(2,($,X)=>l0($,(J)=>Y8($,X(J))));var Cq=MA(cN),CY=cy(X5),JM=($)=>s8($,GL),zW=($)=>{return{...eK,commit(){return C$(this)},[WZ]:HZ,id:()=>c($).reduce((J,Z)=>D2(J,Z.id()),P8),await:W0(FY($,(J)=>E8(J.await),!1)),children:L(FY($,(J)=>J.children,!1),S9),inheritAll:f8($,(J)=>J.inheritAll),poll:L(n0($,(J)=>J.poll),BJ(q(Z0([])),(J,Z)=>{switch(Z._tag){case"None":return T();case"Some":switch(J._tag){case"None":return T();case"Some":return q(fJ(Z.value,J.value,{onSuccess:(Q,Y)=>[Q,...Y],onFailure:z8}))}}})),interruptAsFork:(J)=>f8($,(Z)=>Z.interruptAsFork(J))}};var DW=W(3,($,X,J)=>VW($,X,{onSelfWin:(Z,Q)=>U(Z.await,(Y)=>{switch(Y._tag){case O0:return U(Z.inheritAll,()=>J.onSelfDone(Y,Q));case A0:return J.onSelfDone(Y,Q)}}),onOtherWin:(Z,Q)=>U(Z.await,(Y)=>{switch(Y._tag){case O0:return U(Z.inheritAll,()=>J.onOtherDone(Y,Q));case A0:return J.onOtherDone(Y,Q)}})})),ZM=($)=>N0((X)=>C8((J)=>U(LZ(X($)),(Z)=>D(X(C$(Z)),Z6(()=>D(Z,WL(J))))))),EY=W(2,($,X)=>C8((J)=>DW($,X,{onSelfDone:(Z,Q)=>t5(Z,{onFailure:(Y)=>D(C$(Q),K7((G)=>z8(Y,G))),onSuccess:(Y)=>D(Q,I8(J),e(Y))}),onOtherDone:(Z,Q)=>t5(Z,{onFailure:(Y)=>D(C$(Q),K7((G)=>z8(G,Y))),onSuccess:(Y)=>D(Q,I8(J),e(Y))})}))),VW=W(3,($,X,J)=>m((Z,Q)=>{let Y=Q.runtimeFlags,G=a$(!0),K=TY($,Z,Y,J.selfScope),B=TY(X,Z,Y,J.otherScope);return Z8((H)=>{K.addObserver(()=>Eq(K,B,J.onSelfWin,G,H)),B.addObserver(()=>Eq(B,K,J.onOtherWin,G,H)),K.startFork($),B.startFork(X)},D2(K.id(),B.id()))})),Eq=($,X,J,Z,Q)=>{if(t9(!0,!1)(Z))Q(J($,X))},D$=W(2,($,X)=>N0((J)=>Q0(J($),{onFailure:(Z)=>Q0(X,{onFailure:(Q)=>h(B0(Z,Q)),onSuccess:()=>h(Z)}),onSuccess:(Z)=>e(X,Z)}))),uy=($,X,J)=>C8((Z)=>U(U(LZ(k6($)),(Q)=>Z8((Y)=>{let G=X.map((H)=>H.listeners.count),K=()=>{if(G.every((H)=>H===0)){if(X.every((H)=>{if(H.result.state.current._tag==="Pending")return!0;else if(H.result.state.current._tag==="Done"&&a5(H.result.state.current.effect)&&H.result.state.current.effect._tag==="Failure"&&TQ(H.result.state.current.effect.cause))return!0;else return!1}))B.forEach((H)=>H()),J?.(),Y(yJ(Q))}};Q.addObserver((H)=>{B.forEach((z)=>z()),Y(H)});let B=X.map((H,z)=>{let V=(N)=>{G[z]=N,K()};return H.listeners.addObserver(V),()=>H.listeners.removeObserver(V)});return K(),w(()=>{B.forEach((H)=>H())})})),()=>S(()=>{let Q=X.flatMap((Y)=>{if(!Y.state.completed)return[Y];return[]});return f8(Q,(Y)=>eB(Y.request,sQ(Z)))})));var H$=($,X)=>{return X=a8(X),y6(m((J)=>{let Z=X$(J.getFiberRef(R8),H6),Q=i1(J,$,X),Y=J.getFiberRef(S4),G=E0(J.getFiberRef(G0),N8);return e(gX(Z,(K)=>FB(Q,K,G,Y)),Q)}))},IY=($)=>i0(G0,t(u6,$)),QM=function(){let $=typeof arguments[0]!=="string",X=$?arguments[1]:arguments[0],J=a8($?arguments[2]:arguments[1]);if($){let Z=arguments[0];return U(H$(X,a8(J)),(Q)=>h4(Z,O8,Q))}return(Z)=>U(H$(X,a8(J)),(Q)=>h4(Z,O8,Q))};var YM=($,X,J,Z)=>m5({_tag:"Complete",key:$,exit:X,entryStats:J,timeToLiveMillis:Z}),GM=($,X)=>m5({_tag:"Pending",key:$,deferred:X}),fy=($,X)=>m5({_tag:"Refreshing",deferred:$,complete:X}),UW=Symbol.for("effect/Cache/MapKey");class KM{current;[UW]=UW;previous=void 0;next=void 0;constructor($){this.current=$}[R](){return D(_(this.current),x(_(this.previous)),x(_(this.next)),b(this))}[I]($){if(this===$)return!0;return py($)&&C(this.current,$.current)&&C(this.previous,$.previous)&&C(this.next,$.next)}}var N7=($)=>new KM($),py=($)=>P($,UW);class BM{head=void 0;tail=void 0;add($){if($!==this.tail)if(this.tail===void 0)this.head=$,this.tail=$;else{let{previous:X,next:J}=$;if(J!==void 0)if($.next=void 0,X!==void 0)X.next=J,J.previous=X;else this.head=J,this.head.previous=void 0;this.tail.next=$,$.previous=this.tail,this.tail=$}}remove(){let $=this.head;if($!==void 0){let X=$.next;if(X!==void 0)$.next=void 0,this.head=X,this.head.previous=void 0;else this.head=void 0,this.tail=void 0}return $}}var ny=()=>new BM,ly=($,X,J,Z,Q,Y)=>({map:$,keys:X,accesses:J,updating:Z,hits:Q,misses:Y}),oy=()=>ly(uX(),ny(),tA(),a$(!1),0,0),iy="effect/Cache",NW=Symbol.for(iy),ry={_Key:($)=>$,_Error:($)=>$,_Value:($)=>$},ay="effect/ConsumerCache",AW=Symbol.for(ay),sy={_Key:($)=>$,_Error:($)=>$,_Value:($)=>$},OW=($)=>$,A7=($)=>({loadedMillis:$});class wW{capacity;context;fiberId;lookup;timeToLive;[NW]=ry;[AW]=sy;cacheState;constructor($,X,J,Z,Q){this.capacity=$,this.context=X,this.fiberId=J,this.lookup=Z,this.timeToLive=Q,this.cacheState=oy()}get($){return L(this.getEither($),_9)}get cacheStats(){return w(()=>OW({hits:this.cacheState.hits,misses:this.cacheState.misses,size:$1(this.cacheState.map)}))}getOption($){return S(()=>C0(P0(this.cacheState.map,$),{onNone:()=>{let X=N7($);return this.trackAccess(X),this.trackMiss(),O(T())},onSome:(X)=>this.resolveMapValue(X)}))}getOptionComplete($){return S(()=>C0(P0(this.cacheState.map,$),{onNone:()=>{let X=N7($);return this.trackAccess(X),this.trackMiss(),O(T())},onSome:(X)=>this.resolveMapValue(X,!0)}))}contains($){return w(()=>_$(this.cacheState.map,$))}entryStats($){return w(()=>{let X=P0(this.cacheState.map,$);if(w0(X))switch(X.value._tag){case"Complete":{let J=X.value.entryStats.loadedMillis;return q(A7(J))}case"Pending":return T();case"Refreshing":{let J=X.value.complete.entryStats.loadedMillis;return q(A7(J))}}return T()})}getEither($){return S(()=>{let X=$,J=void 0,Z=void 0,Q=e0(P0(this.cacheState.map,X));if(Q===void 0)if(Z=OK(this.fiberId),J=N7(X),_$(this.cacheState.map,X))Q=e0(P0(this.cacheState.map,X));else j8(this.cacheState.map,X,GM(J,Z));if(Q===void 0)return this.trackAccess(J),this.trackMiss(),L(this.lookupValueOf($,Z),f);else return U(this.resolveMapValue(Q),C0({onNone:()=>this.getEither($),onSome:(Y)=>O($0(Y))}))})}invalidate($){return w(()=>{fX(this.cacheState.map,$)})}invalidateWhen($,X){return w(()=>{let J=P0(this.cacheState.map,$);if(w0(J)&&J.value._tag==="Complete"){if(J.value.exit._tag==="Success"){if(X(J.value.exit.value))fX(this.cacheState.map,$)}}})}get invalidateAll(){return w(()=>{this.cacheState.map=uX()})}refresh($){return K6((X)=>S(()=>{let J=$,Z=OK(this.fiberId),Q=e0(P0(this.cacheState.map,J));if(Q===void 0)if(_$(this.cacheState.map,J))Q=e0(P0(this.cacheState.map,J));else j8(this.cacheState.map,J,GM(N7(J),Z));if(Q===void 0)return U0(this.lookupValueOf($,Z));else switch(Q._tag){case"Complete":{if(this.hasExpired(X,Q.timeToLiveMillis)){let Y=e0(P0(this.cacheState.map,J));if(C(Y,Q))fX(this.cacheState.map,J);return U0(this.get($))}return D(this.lookupValueOf($,Z),l1(()=>{let Y=e0(P0(this.cacheState.map,J));if(C(Y,Q)){let G=fy(Z,Q);return j8(this.cacheState.map,J,G),!0}return!1}),U0)}case"Pending":return iJ(Q.deferred);case"Refreshing":return iJ(Q.deferred)}}))}set($,X){return K6((J)=>w(()=>{let Z=J.unsafeCurrentTimeMillis(),Q=$,Y=cA(X),G=YM(N7(Q),Y,A7(Z),Z+n$(F0(this.timeToLive(Y))));j8(this.cacheState.map,Q,G)}))}get size(){return w(()=>{return $1(this.cacheState.map)})}get values(){return w(()=>{let $=[];for(let X of this.cacheState.map)if(X[1]._tag==="Complete"&&X[1].exit._tag==="Success")$.push(X[1].exit.value);return $})}get entries(){return w(()=>{let $=[];for(let X of this.cacheState.map)if(X[1]._tag==="Complete"&&X[1].exit._tag==="Success")$.push([X[0],X[1].exit.value]);return $})}get keys(){return w(()=>{let $=[];for(let X of this.cacheState.map)if(X[1]._tag==="Complete"&&X[1].exit._tag==="Success")$.push(X[0]);return $})}resolveMapValue($,X=!1){return K6((J)=>{switch($._tag){case"Complete":{if(this.trackAccess($.key),this.hasExpired(J,$.timeToLiveMillis))return fX(this.cacheState.map,$.key.current),O(T());return this.trackHit(),L($.exit,q)}case"Pending":{if(this.trackAccess($.key),this.trackHit(),X)return O(T());return L(iJ($.deferred),q)}case"Refreshing":{if(this.trackAccess($.complete.key),this.trackHit(),this.hasExpired(J,$.complete.timeToLiveMillis)){if(X)return O(T());return L(iJ($.deferred),q)}return L($.complete.exit,q)}}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess($){if(eA(this.cacheState.accesses,$),t9(this.cacheState.updating,!1,!0)){let X=!0;while(X){let Z=$O(this.cacheState.accesses,LK);if(Z===LK)X=!1;else this.cacheState.keys.add(Z)}let J=$1(this.cacheState.map);X=J>this.capacity;while(X){let Z=this.cacheState.keys.remove();if(Z!==void 0){if(_$(this.cacheState.map,Z.current))fX(this.cacheState.map,Z.current),J=J-1,X=J>this.capacity}else X=!1}M6(this.cacheState.updating,!1)}}hasExpired($,X){return $.unsafeCurrentTimeMillis()>X}lookupValueOf($,X){return K6((J)=>S(()=>{let Z=$;return D(this.lookup($),i8(this.context),W0,U((Q)=>{let Y=J.unsafeCurrentTimeMillis(),G=A7(Y),K=YM(N7(Z),Q,G,Y+n$(F0(this.timeToLive(Q))));return j8(this.cacheState.map,Z,K),p(gA(X,Q),Q)}),Z6(()=>p(hA(X),w(()=>{fX(this.cacheState.map,Z)}))))}))}}var WM=($)=>{let X=F0($.timeToLive);return FW({capacity:$.capacity,lookup:$.lookup,timeToLive:()=>X})},FW=($)=>L(W6([S8(),x6]),([X,J])=>new wW($.capacity,X,J,$.lookup,(Z)=>F0($.timeToLive(Z)))),HM=($,X,J)=>new wW($,h0(),XQ,X,(Z)=>F0(J(Z)));var ey=NW,$b=AW,Xb=WM,Jb=FW,Zb=OW,Qb=A7;var TW=I6,LW=M0;var zM=P$;var E$={};o4(E$,{zipWith:()=>JC,zipRight:()=>Uu,zipLeft:()=>Vu,zip:()=>Du,yieldNow:()=>tg,withUnhandledErrorLogLevel:()=>jc,withTracerTiming:()=>Ru,withTracerScoped:()=>Eu,withTracerEnabled:()=>Iu,withTracer:()=>Cu,withSpanScoped:()=>uu,withSpan:()=>ZC,withSchedulingPriority:()=>Rm,withScheduler:()=>Im,withRuntimeFlagsPatchScoped:()=>oc,withRuntimeFlagsPatch:()=>lc,withRequestCaching:()=>qu,withRequestCache:()=>Mu,withRequestBatching:()=>Lu,withRandomScoped:()=>uc,withRandomFixed:()=>cc,withRandom:()=>XC,withParentSpan:()=>fu,withMetric:()=>ec,withMaxOpsBeforeYield:()=>Sm,withLogSpan:()=>Ec,withFiberRuntime:()=>gg,withExecutionPlan:()=>Ah,withEarlyRelease:()=>Km,withConsoleScoped:()=>gm,withConsole:()=>hm,withConfigProviderScoped:()=>am,withConfigProvider:()=>rm,withConcurrency:()=>Em,withClockScoped:()=>km,withClock:()=>vm,whileLoop:()=>Zc,whenRef:()=>kd,whenLogLevel:()=>xc,whenFiberRef:()=>xd,whenEffect:()=>jd,when:()=>Sd,void:()=>sg,validateWith:()=>zu,validateFirst:()=>kg,validateAll:()=>xg,validate:()=>Hu,using:()=>Gm,useSpan:()=>du,updateService:()=>zd,updateFiberRefs:()=>Dc,unsandbox:()=>qh,unsafeMakeSemaphore:()=>$u,unsafeMakeLatch:()=>Ju,unlessEffect:()=>Rd,unless:()=>Id,uninterruptibleMask:()=>xh,uninterruptible:()=>jh,tryPromise:()=>Lh,tryMapPromise:()=>Th,tryMap:()=>Fh,try:()=>wh,transposeOption:()=>lu,transposeMapOption:()=>ou,transplant:()=>Cm,tracerWith:()=>_u,tracer:()=>Pu,timeoutTo:()=>om,timeoutOption:()=>pm,timeoutFailCause:()=>lm,timeoutFail:()=>nm,timeout:()=>fm,timedWith:()=>um,timed:()=>cm,tapErrorTag:()=>ld,tapErrorCause:()=>od,tapError:()=>nd,tapDefect:()=>pd,tapBoth:()=>fd,tap:()=>ud,takeWhile:()=>Ag,takeUntil:()=>Ng,tagMetricsScoped:()=>ac,tagMetrics:()=>ic,sync:()=>ag,suspend:()=>rg,supervised:()=>_m,summarized:()=>cd,succeedSome:()=>ig,succeedNone:()=>OH,succeed:()=>og,step:()=>wu,spanLinks:()=>yu,spanAnnotations:()=>vu,sleep:()=>dm,setFiberRefs:()=>zc,serviceOptional:()=>Hd,serviceOption:()=>Wd,serviceMembers:()=>Bd,serviceFunctions:()=>Gd,serviceFunctionEffect:()=>Yd,serviceFunction:()=>Qd,serviceConstants:()=>Kd,sequentialFinalizers:()=>$m,scopedWith:()=>Qm,scoped:()=>Ym,scopeWith:()=>Zm,scope:()=>Jm,scheduleFrom:()=>Jc,scheduleForked:()=>Xc,schedule:()=>$c,sandbox:()=>Uh,runtime:()=>fc,runSyncExit:()=>Wu,runSync:()=>Bu,runRequestBlock:()=>Ou,runPromiseExit:()=>Ku,runPromise:()=>Gu,runFork:()=>Qu,runCallback:()=>Yu,retryOrElse:()=>Oh,retry:()=>Nh,request:()=>Fu,replicateEffect:()=>jg,replicate:()=>Sg,repeatOrElse:()=>ed,repeatN:()=>td,repeat:()=>sd,reduceWhile:()=>Eg,reduceRight:()=>Ig,reduceEffect:()=>Rg,reduce:()=>Cg,randomWith:()=>dc,random:()=>mc,raceWith:()=>dd,raceFirst:()=>md,raceAll:()=>hd,race:()=>gd,provideServiceEffect:()=>Zd,provideService:()=>Jd,provide:()=>Xd,promise:()=>lg,patchRuntimeFlags:()=>nc,patchFiberRefs:()=>Hc,partition:()=>_g,parallelFinalizers:()=>eh,parallelErrors:()=>Vh,orElseSucceed:()=>gc,orElseFail:()=>bc,orElse:()=>yc,orDieWith:()=>vc,orDie:()=>kc,optionFromOptional:()=>nu,option:()=>Od,once:()=>Wg,onInterrupt:()=>Sh,onExit:()=>th,onError:()=>sh,none:()=>ng,never:()=>pg,negate:()=>nh,metricLabels:()=>tc,mergeAll:()=>Pg,merge:()=>ph,matchEffect:()=>wc,matchCauseEffect:()=>Oc,matchCause:()=>Ac,match:()=>Nc,mapInputContext:()=>$d,mapErrorCause:()=>fh,mapError:()=>uh,mapBoth:()=>ch,mapAccum:()=>dh,map:()=>K5,makeSpanScoped:()=>mu,makeSpan:()=>hu,makeSemaphore:()=>Xu,makeLatch:()=>Zu,loop:()=>ad,logWithLevel:()=>Tc,logWarning:()=>Pc,logTrace:()=>Lc,logInfo:()=>Mc,logFatal:()=>Cc,logError:()=>_c,logDebug:()=>qc,logAnnotations:()=>Sc,log:()=>Fc,locallyWith:()=>Kc,locallyScopedWith:()=>Wc,locallyScoped:()=>Bc,locally:()=>Gc,linkSpans:()=>bu,linkSpanCurrent:()=>gu,liftPredicate:()=>kh,let:()=>Ad,labelMetricsScoped:()=>sc,labelMetrics:()=>rc,iterate:()=>rd,isSuccess:()=>Uc,isFailure:()=>Vc,isEffect:()=>Qg,intoDeferred:()=>Td,interruptibleMask:()=>Rh,interruptible:()=>Ih,interruptWith:()=>Eh,interrupt:()=>Ch,inheritFiberRefs:()=>Yc,ignoreLogged:()=>Dh,ignore:()=>zh,if:()=>Ld,head:()=>Mg,getRuntimeFlags:()=>pc,getFiberRefs:()=>Qc,gen:()=>fg,functionWithSpan:()=>cu,fromNullable:()=>pu,fromFiberEffect:()=>Pm,fromFiber:()=>Mm,forkWithErrorHandler:()=>qm,forkScoped:()=>Lm,forkIn:()=>Tm,forkDaemon:()=>wm,forkAll:()=>Fm,fork:()=>Om,forever:()=>id,forEach:()=>qg,fnUntraced:()=>su,fn:()=>au,flipWith:()=>mh,flip:()=>hh,flatten:()=>bd,flatMap:()=>vd,firstSuccessOf:()=>hc,findFirst:()=>Lg,finalizersMask:()=>Xm,filterOrFail:()=>_d,filterOrElse:()=>Pd,filterOrDieMessage:()=>Md,filterOrDie:()=>qd,filterMap:()=>Tg,filterEffectOrFail:()=>Ed,filterEffectOrElse:()=>Cd,filter:()=>Fg,fiberIdWith:()=>Am,fiberId:()=>Nm,failSync:()=>mg,failCauseSync:()=>dg,failCause:()=>$C,fail:()=>hg,exit:()=>Fd,exists:()=>wg,every:()=>Og,eventually:()=>Hh,ensuringChildren:()=>Um,ensuringChild:()=>Vm,ensuring:()=>ah,ensureSuccessType:()=>tu,ensureRequirementsType:()=>$f,ensureErrorType:()=>eu,either:()=>wd,dropWhile:()=>Ug,dropUntil:()=>Vg,disconnect:()=>_h,diffFiberRefs:()=>Dm,dieSync:()=>ug,dieMessage:()=>cg,die:()=>AH,descriptorWith:()=>zm,descriptor:()=>Hm,delay:()=>mm,daemonChildren:()=>Wm,custom:()=>bg,currentSpan:()=>xu,currentParentSpan:()=>ku,contextWithEffect:()=>em,contextWith:()=>tm,context:()=>sm,consoleWith:()=>bm,console:()=>ym,configProviderWith:()=>im,clockWith:()=>xm,clock:()=>jm,checkInterruptible:()=>Ph,cause:()=>Wh,catchTags:()=>Bh,catchTag:()=>Kh,catchSomeDefect:()=>Gh,catchSomeCause:()=>Yh,catchSome:()=>Qh,catchIf:()=>Zh,catchAllDefect:()=>Jh,catchAllCause:()=>Xh,catchAll:()=>$h,catch:()=>eg,cachedWithTTL:()=>Yg,cachedInvalidateWithTTL:()=>Gg,cachedFunction:()=>Bg,cached:()=>Kg,cacheRequestResult:()=>Tu,blocked:()=>Au,bindTo:()=>Nd,bindAll:()=>Ud,bind:()=>Vd,awaitAllChildren:()=>Bm,asyncEffect:()=>yg,async:()=>vg,asVoid:()=>gh,asSomeError:()=>bh,asSome:()=>yh,as:()=>vh,ap:()=>Nu,annotateSpans:()=>Su,annotateLogsScoped:()=>Rc,annotateLogs:()=>Ic,annotateCurrentSpan:()=>ju,andThen:()=>yd,allowInterrupt:()=>Mh,allWith:()=>zg,allSuccesses:()=>Dg,all:()=>Hg,addFinalizer:()=>rh,acquireUseRelease:()=>ih,acquireReleaseInterruptible:()=>oh,acquireRelease:()=>lh,Tag:()=>iu,Service:()=>ru,EffectTypeId:()=>Zg,Do:()=>Dd});var Yb="effect/ScheduleInterval",PZ=Symbol.for(Yb),qW={[PZ]:PZ,startMillis:0,endMillis:0},MW=($,X)=>{if($>X)return qW;return{[PZ]:PZ,startMillis:$,endMillis:X}},VM=W(2,($,X)=>UM($,X)===$),UM=W(2,($,X)=>{if($.endMillis<=X.startMillis)return $;if(X.endMillis<=$.startMillis)return X;if($.startMillis<X.startMillis)return $;if(X.startMillis<$.startMillis)return X;if($.endMillis<=X.endMillis)return $;return X});var NM=($)=>{return $.startMillis>=$.endMillis};var AM=W(2,($,X)=>{let J=Math.max($.startMillis,X.startMillis),Z=Math.min($.endMillis,X.endMillis);return MW(J,Z)});var OM=($)=>{return MW($,Number.POSITIVE_INFINITY)};var PW=qW,wM=VM;var FM=NM;var TM=AM;var LM=OM;var Bb="effect/ScheduleIntervals",CW=Symbol.for(Bb),EW=($)=>{return{[CW]:CW,intervals:$}};var qM=W(2,($,X)=>Wb($.intervals,X.intervals,W8())),Wb=($,X,J)=>{let Z=$,Q=X,Y=J;while(p0(Z)&&p0(Q)){let G=D(d0(Z),TM(d0(Q))),K=FM(G)?Y:D(Y,m0(G));if(D(d0(Z),wM(d0(Q))))Z=X8(Z);else Q=X8(Q);Y=K}return EW(f$(Y))},SY=($)=>{return D($.intervals,b9,S0(()=>PW)).startMillis},MM=($)=>{return D($.intervals,b9,S0(()=>PW)).endMillis},PM=W(2,($,X)=>SY($)<SY(X)),_M=($)=>{return p0($.intervals)};var CM=EW;var EM=qM,jY=SY,IW=MM,IM=PM,RM=_M;var RW="Continue",SM="Done",jM=($)=>{return{_tag:RW,intervals:$}},xM=($)=>{return{_tag:RW,intervals:CM(V0($))}},kM={_tag:SM},vM=($)=>{return $._tag===RW},yM=($)=>{return $._tag===SM};var bM=jM;var gM=xM,O7=kM,SW=vM,Z5=yM;var hM=H6;var mM=hX;var dM=n8;class uM{permits;waiters=new Set;taken=0;constructor($){this.permits=$}get free(){return this.permits-this.taken}take=($)=>jJ((X)=>{if(this.free<$){let J=()=>{if(this.free<$)return;this.waiters.delete(J),this.taken+=$,X(O($))};return this.waiters.add(J),w(()=>{this.waiters.delete(J)})}return this.taken+=$,X(O($))});updateTakenUnsafe($,X){if(this.taken=X(this.taken),this.waiters.size>0)$.getFiberRef(l6).scheduleTask(()=>{let J=this.waiters.values(),Z=J.next();while(Z.done===!1&&this.free>0)Z.value(),Z=J.next()},$.getFiberRef(b6));return O(this.free)}updateTaken($){return m((X)=>this.updateTakenUnsafe(X,$))}resize=($)=>U0(m((X)=>{if(this.permits=$,this.free<0)return k;return this.updateTakenUnsafe(X,(J)=>J)}));release=($)=>this.updateTaken((X)=>X-$);releaseAll=this.updateTaken(($)=>0);withPermits=($)=>(X)=>N0((J)=>U(J(this.take($)),(Z)=>D$(J(X),this.release(Z))));withPermitsIfAvailable=($)=>(X)=>N0((J)=>S(()=>{if(this.free<$)return aX;return this.taken+=$,D$(J(Y7(X)),this.release($))}))}var kY=($)=>new uM($),fM=($)=>w(()=>kY($));class pM extends b4{isOpen;waiters=[];scheduled=!1;constructor($){super();this.isOpen=$}commit(){return this.await}unsafeSchedule($){if(this.scheduled||this.waiters.length===0)return k;return this.scheduled=!0,$.currentScheduler.scheduleTask(this.flushWaiters,$.getFiberRef(b6)),k}flushWaiters=()=>{this.scheduled=!1;let $=this.waiters;this.waiters=[];for(let X=0;X<$.length;X++)$[X](U8)};open=m(($)=>{if(this.isOpen)return k;return this.isOpen=!0,this.unsafeSchedule($)});unsafeOpen(){if(this.isOpen)return;this.isOpen=!0,this.flushWaiters()}release=m(($)=>{if(this.isOpen)return k;return this.unsafeSchedule($)});await=jJ(($)=>{if(this.isOpen)return $(k);return this.waiters.push($),w(()=>{let X=this.waiters.indexOf($);if(X!==-1)this.waiters.splice(X,1)})});unsafeClose(){this.isOpen=!1}close=w(()=>{this.isOpen=!1});whenOpen=($)=>{return p(this.await,$)}}var yW=($)=>new pM($??!1),nM=($)=>w(()=>yW($)),lM=($)=>vY($,JM),oM=W(2,($,X)=>L(bW($,X),(J)=>J[0])),bW=W(2,($,X)=>{let J=F0(X);return U(S8(),(Z)=>L(bY(T()),(Q)=>[i8(Db($,J,Q),Z),Vb(Q)]))}),cM=($,X,J)=>{let Z=n$(F0(X));return D(o8(),V8((Q)=>J6($,Q)),L((Q)=>q([J+Z,Q])))},Db=($,X,J)=>N0((Z)=>D(K6((Q)=>Q.currentTimeMillis),U((Q)=>Ob(J,(Y)=>{switch(Y._tag){case"None":return q(cM($,X,Q));case"Some":{let[G]=Y.value;return G-Q<=0?q(cM($,X,Q)):T()}}})),U((Q)=>J0(Q)?M4("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):Z(v0(Q.value[1]))))),Vb=($)=>G6($,T()),iM=W(2,($,X)=>vY($,(J)=>X(zW(J)))),vY=W(2,($,X)=>U(Uq,(J)=>D(hW($,J),D$(U(J.value,X))))),rM=W(($)=>e8($[0]),($,X)=>X?.discard?f8($,s6):L(n0($,s6),zW)),gW=W(2,($,X)=>m((J,Z)=>{let Q=X,Y=qZ($,J,Z.runtimeFlags,o6);if(Q.state._tag==="Open"){let G=()=>C8((B)=>C(B,Y.id())?k:U0(yJ(Y))),K={};Q.state.finalizers.set(K,G),Y.addObserver(()=>{if(Q.state._tag==="Closed")return;Q.state.finalizers.delete(K)})}else Y.unsafeInterruptAsFork(J.id());return O(Y)})),yY=($)=>z$((X)=>gW($,X)),aM=($)=>C$($),sM=($)=>S(()=>U($,C$)),kW=Symbol.for("effect/Effect/memoizeFunction.key");class vW{a;eq;[kW]=kW;constructor($,X){this.a=$,this.eq=X}[I]($){if(P($,kW))if(this.eq)return this.eq(this.a,$.a);else return C(this.a,$.a);return!1}[R](){return this.eq?0:b(this,_(this.a))}}var tM=($,X)=>{return D(w(()=>uX()),U(bY),L((J)=>(Z)=>D(J.modifyEffect((Q)=>{let Y=D(Q,P0(new vW(Z,X)));if(J0(Y))return D(o8(),V8((G)=>D(G7($(Z)),J6(G),s6)),L((G)=>[G,D(Q,j8(new vW(Z,X),G))]));return O([Y.value,Q])}),U(v0),U(([Q,Y])=>D(iX(Q),e(Y))))))},eM=W(2,($,X)=>D(W0($),EY(W0(X)),(J)=>E8(J))),hW=W(2,($,X)=>{return R0(CY,(Z)=>Z.zip(X))($)}),$P=W(2,($,X)=>mW($,{onTimeout:()=>RA(X),duration:X})),mW=W(2,($,{duration:X,onTimeout:J})=>E8(_Z($,{onTimeout:()=>G$(J),onSuccess:O,duration:X}))),XP=W(2,($,{duration:X,onTimeout:J})=>E8(_Z($,{onTimeout:()=>j6(J),onSuccess:O,duration:X}))),JP=W(2,($,X)=>_Z($,{duration:X,onSuccess:q,onTimeout:T})),_Z=W(2,($,{duration:X,onSuccess:J,onTimeout:Z})=>C8((Q)=>N0((Y)=>VW(Y($),k6(rX(X)),{onSelfWin:(G,K)=>U(G.await,(B)=>{if(B._tag==="Success")return U(G.inheritAll,()=>e(I8(K,Q),J(B.value)));else return U(I8(K,Q),()=>r(B.cause))}),onOtherWin:(G,K)=>U(G.await,(B)=>{if(B._tag==="Success")return U(G.inheritAll,()=>e(I8(K,Q),Z()));else return U(I8(K,Q),()=>r(B.cause))}),otherScope:o6})))),Ub="effect/Ref/SynchronizedRef",Nb=Symbol.for(Ub),Ab={_A:($)=>$};class ZP extends b4{ref;withLock;[Nb]=Ab;[x1]=XB;[g4]=g4;constructor($,X){super();this.ref=$,this.withLock=X,this.get=o0(this.ref)}get;commit(){return this.get}modify($){return this.modifyEffect((X)=>O($(X)))}modifyEffect($){return this.withLock(D(U(o0(this.ref),$),U(([X,J])=>e(G6(this.ref,J),X))))}}var bY=($)=>w(()=>dW($)),dW=($)=>{let X=Q7($),J=kY(1);return new ZP(X,J.withPermits(1))},Ob=W(2,($,X)=>$.modifyEffect((J)=>{let Z=X(J);switch(Z._tag){case"None":return O([J,J]);case"Some":return L(Z.value,(Q)=>[Q,Q])}}));var QP=W(($)=>o($[0]),($,X,J)=>U($,(Z)=>W6(X(Z),J).pipe(L((Q)=>Object.assign({},Z,Q)))));var GP=Symbol.for("effect/ManagedRuntime");var KP="ExtendScope",BP="Fold",cW="Fresh",WP="FromEffect",HP="Scoped",zP="Suspend",DP="Provide",uW="ProvideMerge",VP="MergeAll",UP="ZipWith";var NP=I8;var w7=($)=>function(){if(arguments.length===1){let X=arguments[0];return(J,...Z)=>$(X,J,...Z)}return $.apply(this,arguments)},hY=w7(($,X,J)=>{let Z=QQ(),Q=[[R8,[[Z,$.context]]]];if(J?.scheduler)Q.push([l6,[[Z,J.scheduler]]]);let Y=Qw($.fiberRefs,{entries:Q,forkAs:Z});if(J?.updateRefs)Y=J.updateRefs(Y,Z);let G=new MY(Z,Y,$.runtimeFlags),K=X;if(J?.scope)K=U(dM(J.scope,W$),(H)=>p(iQ(H,C8((z)=>C(z,G.id())?k:I8(G,z))),D8(X,(z)=>mM(H,z))));let B=G.currentSupervisor;if(B!==X5)B.onStart($.context,K,T(),G),G.addObserver((H)=>B.onEnd(H,G));if(o6.add($.runtimeFlags,G),J?.immediate===!1)G.resume(K);else G.start(K);return G}),pW=w7(($,X,J={})=>{let Z=hY($,X,J);if(J.onExit)Z.addObserver((Q)=>{J.onExit(Q)});return(Q,Y)=>pW($)(D(Z,NP(Q??P8)),{...Y,onExit:Y?.onExit?(G)=>Y.onExit(dA(G)):void 0})}),Tb=w7(($,X)=>{let J=LP($)(X);if(J._tag==="Failure")throw FP(J.effect_instruction_i0);return J.effect_instruction_i0});class OP extends Error{fiber;_tag="AsyncFiberException";constructor($){super(`Fiber #${$.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`);this.fiber=$,this.name=this._tag,this.stack=this.message}}var Lb=($)=>{let X=Error.stackTraceLimit;Error.stackTraceLimit=0;let J=new OP($);return Error.stackTraceLimit=X,J};var fW=Symbol.for("effect/Runtime/FiberFailure"),gY=Symbol.for("effect/Runtime/FiberFailure/Cause");class wP extends Error{[fW];[gY];constructor($){let X=PQ($)[0];super(X?.message||"An error has occurred");if(this[fW]=fW,this[gY]=$,this.name=X?`(FiberFailure) ${X.name}`:"FiberFailure",X?.stack)this.stack=X.stack}toJSON(){return{_id:"FiberFailure",cause:this[gY].toJSON()}}toString(){return"(FiberFailure) "+$6(this[gY],{renderErrorCause:!0})}[g](){return this.toString()}}var FP=($)=>{let X=Error.stackTraceLimit;Error.stackTraceLimit=0;let J=new wP($);return Error.stackTraceLimit=X,J};var TP=($)=>{let X=$;switch(X._op){case"Failure":case"Success":return X;case"Left":return uJ(X.left);case"Right":return Z0(X.right);case"Some":return Z0(X.value);case"None":return uJ(new l8)}},LP=w7(($,X)=>{let J=TP(X);if(J)return J;let Z=new yB,Q=hY($)(X,{scheduler:Z});Z.flush();let Y=Q.unsafePoll();if(Y)return Y;return DK(IQ(Lb(Q),eQ(Q)))}),qb=w7(($,X,J)=>qP($,X,J).then((Z)=>{switch(Z._tag){case O0:return Z.effect_instruction_i0;case A0:throw FP(Z.effect_instruction_i0)}})),qP=w7(($,X,J)=>new Promise((Z)=>{let Q=TP(X);if(Q)Z(Q);let Y=hY($)(X);if(Y.addObserver((G)=>{Z(G)}),J?.signal!==void 0)if(J.signal.aborted)Y.unsafeInterruptAsFork(Y.id());else J.signal.addEventListener("abort",()=>{Y.unsafeInterruptAsFork(Y.id())},{once:!0})}));class nW{context;runtimeFlags;fiberRefs;constructor($,X,J){this.context=$,this.runtimeFlags=X,this.fiberRefs=J}pipe(){return M(this,arguments)}}var Mb=($)=>new nW($.context,$.runtimeFlags,$.fiberRefs),F7=()=>m(($,X)=>O(new nW($.getFiberRef(R8),X.runtimeFlags,$.getFiberRefs()))),Pb=x2(M$,R2,I2),X4=Mb({context:h0(),runtimeFlags:Pb,fiberRefs:Yw()});var MP=pW(X4),PP=hY(X4),_P=qb(X4),CP=qP(X4),EP=Tb(X4),IP=LP(X4),RP=($)=>S(()=>{let X=void 0;return U(o8(),(J)=>U(F7(),(Z)=>N0((Q)=>p(s6(Q(Q0($((Y)=>pW(Z)(J6(Y,J))),{onFailure:(Y)=>lJ(J,Y),onSuccess:(Y)=>{return X=Y,k}}))),Q(Z6(v0(J),()=>X??k))))))});var jP=W(2,($,X)=>$.modifyEffect(X));var Cb="effect/Layer",dY=Symbol.for(Cb),Eb={_RIn:($)=>$,_E:($)=>$,_ROut:($)=>$},V$={[dY]:Eb,pipe(){return M(this,arguments)}},Ib="effect/Layer/MemoMap",CZ=Symbol.for(Ib),lW=c$()("effect/Layer/CurrentMemoMap",{defaultValue:()=>Rb()}),IZ=($)=>P($,dY),oW=($)=>{return $._op_layer===cW};class iW{ref;[CZ];constructor($){this.ref=$,this[CZ]=CZ}getOrElseMemoize($,X){return D(jP(this.ref,(J)=>{let Z=J.get($);if(Z!==void 0){let[Q,Y]=Z,G=D(Q,U(([K,B])=>D(iX(K),e(B))),D8(s5({onFailure:()=>k,onSuccess:()=>gX(X,Y)})));return O([G,J])}return D(nX(0),U((Q)=>D(o8(),U((Y)=>D(nX(()=>k),L((G)=>{let K=N0((H)=>D(U7(),U((z)=>D(H(U(bP($,z,!0),(V)=>G7(V(this)))),W0,U((V)=>{switch(V._tag){case A0:return D(lJ(Y,V.effect_instruction_i0),p(hX(z,V)),p(h(V.effect_instruction_i0)));case O0:return D(G6(G,(N)=>D(hX(z,N),o5(JB(Q,(A)=>[A===1,A-1])),U0)),p(lX(Q,(N)=>N+1)),p(gX(X,(N)=>D(w(()=>J.delete($)),p(o0(G)),U((A)=>A(N))))),p(NK(Y,V.effect_instruction_i0)),e(V.effect_instruction_i0[1]))}}))))),B=[D(v0(Y),D8(t5({onFailure:()=>k,onSuccess:()=>lX(Q,(H)=>H+1)}))),(H)=>D(o0(G),U((z)=>z(H)))];return[K,oW($)?J:J.set($,B)]}))))))}),E8)}}var rW=S(()=>L(bY(new Map),($)=>new iW($))),Rb=()=>new iW(dW(new Map)),yP=($)=>z$((X)=>u4($,X)),u4=W(2,($,X)=>U(rW,(J)=>cY($,J,X))),cY=W(3,($,X,J)=>U(bP($,J),(Z)=>h4(Z(X),lW,X))),bP=($,X,J=!1)=>{let Z=$;switch(Z._op_layer){case"Locally":return w(()=>(Q)=>Z.f(Q.getOrElseMemoize(Z.self,X)));case"ExtendScope":return w(()=>(Q)=>z$((Y)=>Q.getOrElseMemoize(Z.layer,Y)));case"Fold":return w(()=>(Q)=>D(Q.getOrElseMemoize(Z.layer,X),Q0({onFailure:(Y)=>Q.getOrElseMemoize(Z.failureK(Y),X),onSuccess:(Y)=>Q.getOrElseMemoize(Z.successK(Y),X)})));case"Fresh":return w(()=>(Q)=>D(Z.layer,u4(X)));case"FromEffect":return J?w(()=>(Q)=>Z.effect):w(()=>(Q)=>Q.getOrElseMemoize($,X));case"Provide":return w(()=>(Q)=>D(Q.getOrElseMemoize(Z.first,X),U((Y)=>D(Q.getOrElseMemoize(Z.second,X),i8(Y)))));case"Scoped":return J?w(()=>(Q)=>e6(Z.effect,X)):w(()=>(Q)=>Q.getOrElseMemoize($,X));case"Suspend":return w(()=>(Q)=>Q.getOrElseMemoize(Z.evaluate(),X));case"ProvideMerge":return w(()=>(Q)=>D(Q.getOrElseMemoize(Z.first,X),Y6(Q.getOrElseMemoize(Z.second,X),Z.zipK)));case"ZipWith":return yQ(function*(){let Q=yield*n8(X,KZ),Y=yield*n8(Q,W$),G=yield*n8(Q,W$);return(K)=>D(K.getOrElseMemoize(Z.first,Y),t6(K.getOrElseMemoize(Z.second,G),Z.zipK,{concurrent:!0}))});case"MergeAll":{let Q=Z.layers;return L(n8(X,KZ),(Y)=>(G)=>{let K=Array(Q.length);return L(a6(Q,i5(function*(B,H){let z=yield*n8(Y,W$),V=yield*G.getOrElseMemoize(B,z);K[H]=V}),!1,!1),()=>u3(...K))})}}},Q5=W(2,($,X)=>iY($,{onFailure:X,onSuccess:J4})),aW=W(2,($,X)=>oY($,{onFailure:X,onSuccess:J4})),sW=($)=>RZ(LW($)),gP=($)=>fY(()=>LW($())),hP=($)=>lY($,()=>h0()),uY=()=>G8(S8()),mP=($)=>{let X=Object.create(V$);return X._op_layer=KP,X.layer=$,X},tW=($)=>RZ(TW($)),eW=($)=>fY(()=>TW($())),RZ=($)=>G8(h($)),fY=($)=>G8(j6($)),z6=W(2,($,X)=>iY($,{onFailure:tW,onSuccess:X})),dP=W(2,($,X)=>z6($,E0(X))),$H=($)=>{let X=Object.create(V$);return X._op_layer=cW,X.layer=$,X},f4=W(2,($,X)=>{let J=S5($),Z=J?$:X;return G8(L(J?X:$,(Y)=>q8(Z,Y)))}),cP=($)=>G8(L($,()=>h0()));function G8($){let X=Object.create(V$);return X._op_layer=WP,X.effect=$,X}var uP=W(3,($,X,J)=>pY($,H0(X,J))),pY=W(2,($,X)=>{let J=Object.create(V$);return J._op_layer="Locally",J.self=$,J.f=X,J}),nY=W(3,($,X,J)=>pY($,R0(X,J))),fP=($,X)=>Y5(Y8($,X)),pP=($,X)=>Y5(i0($,X)),nP=($,X,J)=>G8(L($,(Z)=>q8(X,J(Z)))),lP=($)=>PY(p(z$((X)=>D($,u4(X))),R4)),oP=function(){if(arguments.length===1)return($)=>xP(arguments[0],$);return xP(arguments[0],arguments[1])},xP=($,X)=>T7($,new Proxy({...X},{get(J,Z,Q){if(Z in J)return J[Z];let Y=Error.stackTraceLimit;Error.stackTraceLimit=2;let G=Error(`${$.key}: Unimplemented method "${Z.toString()}"`);return Error.stackTraceLimit=Y,G.name="UnimplementedError",Sb(G)},has:b8})),Sb=($)=>{let X=Q8($);function J(){return X}return Object.assign(J,X),Object.setPrototypeOf(J,Object.getPrototypeOf(X)),J},lY=W(2,($,X)=>z6($,(J)=>J4(X(J)))),iP=W(2,($,X)=>Q5($,(J)=>eW(()=>X(J)))),oY=W(2,($,{onFailure:X,onSuccess:J})=>{let Z=Object.create(V$);return Z._op_layer=BP,Z.layer=$,Z.failureK=X,Z.successK=J,Z}),iY=W(2,($,{onFailure:X,onSuccess:J})=>oY($,{onFailure:(Z)=>{let Q=zM(Z);switch(Q._tag){case"Left":return X(Q.left);case"Right":return RZ(Q.right)}},onSuccess:J})),rP=($)=>z$((X)=>L(f1(u4($,X)),G8)),XH=W(2,($,X)=>JH($,X,(J,Z)=>Z$(J,Z))),rY=(...$)=>{let X=Object.create(V$);return X._op_layer=VP,X.layers=$,X},aP=($)=>Q5($,(X)=>sW(X)),sP=W(2,($,X)=>Q5($,X)),tP=($)=>XH(uY(),$),eP=W(4,($,X,J,Z)=>lY($,(Q)=>q8(J,Z(X$(Q,X))))),$_=W(2,($,X)=>jZ(()=>{let J=x0("effect/Layer/retry/{ state: unknown }");return D(T7(J,{state:X.initial}),z6((Z)=>X_($,X,J,D(Z,E0(J)).state)))})),X_=($,X,J,Z)=>{return D($,Q5((Q)=>D(jb(X,J,Q,Z),z6((Y)=>$H(X_($,X,J,D(Y,E0(J)).state))))))},jb=($,X,J,Z)=>{return f4(X,D(J7,U((Q)=>D($.step(Q,J,Z),U(([Y,G,K])=>Z5(K)?v(J):D($Z(p$(jY(K.intervals)-Q)),e({state:Y})))))))},p4=W(2,($,X)=>{let J=S5($),Z=J?$:X;return SZ(L(J?X:$,(Y)=>q8(Z,Y)))}),Y5=($)=>SZ(D($,e(h0()))),SZ=($)=>{let X=Object.create(V$);return X._op_layer=HP,X.effect=$,X},J_=SZ(L(V7(U7(),($,X)=>$.close(X)),($)=>q8(hM,$))),Z_=($)=>f4($,$),T7=W(2,($,X)=>{let J=S5($);return G8(O(q8(J?$:X,J?X:$)))}),J4=($)=>{return G8(O($))},Q_=J4(h0()),jZ=($)=>{let X=Object.create(V$);return X._op_layer=zP,X.evaluate=$,X},aY=W(2,($,X)=>{let J=S5($),Z=J?$:X,Q=J?X:$;return G8(w(()=>q8(Z,Q())))}),Y_=($)=>{return G8(w($))},G_=W(2,($,X)=>z6($,(J)=>G8(e(X(J),J)))),K_=W(2,($,X)=>Q5($,(J)=>G8(U(X(J),()=>v(J))))),B_=W(2,($,X)=>aW($,(J)=>G8(U(X(J),()=>h(J))))),W_=($)=>D(z$((X)=>u4($,X)),U((X)=>D(F7(),i8(X)))),H_=W(2,($,X)=>U(z$((J)=>cY($,X,J)),(J)=>D(F7(),i8(J)))),G5=W(2,($,X)=>jZ(()=>{let J=Object.create(V$);return J._op_layer=DP,J.first=Object.create(V$,{_op_layer:{value:uW,enumerable:!0},first:{value:uY(),enumerable:!0},second:{value:Array.isArray(X)?rY(...X):X},zipK:{value:(Z,Q)=>D(Z,Z$(Q))}}),J.second=$,J})),z_=W(2,($,X)=>{let J=Object.create(V$);return J._op_layer=uW,J.first=X,J.second=G5($,X),J.zipK=(Z,Q)=>{return D(Z,Z$(Q))},J}),JH=W(3,($,X,J)=>jZ(()=>{let Z=Object.create(V$);return Z._op_layer=UP,Z.first=$,Z.second=X,Z.zipK=J,Z})),ZH=($)=>{let X=x0("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return z6(f4(X,$),(J)=>E0(J,X))},EZ=($)=>{let X=x0("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return z6(p4(X,$),(J)=>E0(J,X))},D_=W(($)=>IZ($[0]),function(){let $=arguments;return nY($[0],g6,typeof $[1]==="string"?J8($[1],$[2]):(X)=>Object.entries($[1]).reduce((J,[Z,Q])=>J8(J,Z,Q),X))}),V_=W(($)=>IZ($[0]),function(){let $=arguments;return nY($[0],r5,typeof $[1]==="string"?J8($[1],$[2]):(X)=>Object.entries($[1]).reduce((J,[Z,Q])=>J8(J,Z,Q),X))}),U_=function(){let $=typeof arguments[0]!=="string",X=$?arguments[1]:arguments[0],J=a8($?arguments[2]:arguments[1]);if($){let Z=arguments[0];return EZ(L(J?.onEnd?V8(H$(X,J),(Q)=>B6((Y)=>J.onEnd(Q,Y))):H$(X,J),(Q)=>mY(Z,Q)))}return(Z)=>EZ(L(J?.onEnd?V8(H$(X,J),(Q)=>B6((Y)=>J.onEnd(Q,Y))):H$(X,J),(Q)=>mY(Z,Q)))},mY=W(2,($,X)=>G5($,J4(q8(O8,X)))),kP=W(2,($,X)=>MZ((J)=>U(u4(X,J),(Z)=>tQ($,Z)))),vP=W(2,($,X)=>{let J=sX(X4.fiberRefs,X.fiberRefs),Z=Y$(X4.runtimeFlags,X.runtimeFlags);return N0((Q)=>m((Y)=>{let G=Y.getFiberRef(R8),K=Y.getFiberRefs(),B=tX(Y.id(),K)(J),H=Y.currentRuntimeFlags,z=E6(Z)(H),V=sX(B,K),N=Y$(z,H);return Y.setFiberRefs(B),Y.currentRuntimeFlags=z,D$(tQ(Q($),Z$(G,X.context)),m((A)=>{return A.setFiberRefs(tX(A.id(),A.getFiberRefs())(V)),A.currentRuntimeFlags=E6(N)(A.currentRuntimeFlags),k}))}))}),sY=W(2,($,X)=>{if(Array.isArray(X))return kP($,rY(...X));else if(IZ(X))return kP($,X);else if(c3(X))return tQ($,X);else if(GP in X)return U(X.runtimeEffect,(J)=>vP($,J));else return vP($,X)});var N_=L(p8(G0),E0(d6)),A_=($)=>l0(G0,(X)=>$(E0(X,d6))),O_=W(2,($,X)=>R0($,G0,t(d6,X))),w_=($)=>i0(G0,t(d6,$));var eY={};o4(eY,{unsafeStruct:()=>kb,unsafeArray:()=>YH,tuple:()=>vb,taggedEnum:()=>mb,tagged:()=>F_,struct:()=>QH,case:()=>bb,array:()=>yb,TaggedError:()=>cb,TaggedClass:()=>gb,Structural:()=>hb,Error:()=>L_,Class:()=>T_});var QH=m5,kb=($)=>Object.setPrototypeOf($,y$),vb=(...$)=>YH($),yb=($)=>YH($.slice(0)),YH=($)=>Object.setPrototypeOf($,qN),bb=()=>($)=>$===void 0?Object.create(y$):QH($);var F_=($)=>(X)=>{let J=X===void 0?Object.create(y$):QH(X);return J._tag=$,J},T_=_6,gb=($)=>{class X extends T_{_tag=$}return X},hb=_6,mb=()=>new Proxy({},{get($,X,J){if(X==="$is")return k$;else if(X==="$match")return db;return F_(X)}});function db(){if(arguments.length===1){let J=arguments[0];return function(Z){return J[Z._tag](Z)}}let $=arguments[0];return arguments[1][$._tag]($)}var L_=function(){let $=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends rQ{constructor(J){super(J?.message,J?.cause?{cause:J.cause}:void 0);if(J)Object.assign(this,J),Object.defineProperty(this,$,{value:J,enumerable:!1})}toJSON(){return{...this[$],...this}}}}.BaseEffectError}(),cb=($)=>{let X={BaseEffectError:class extends L_{_tag=$}};return X.BaseEffectError.prototype.name=$,X.BaseEffectError};var q_=xO;var ub="effect/Schedule",C_=Symbol.for(ub),E_=($)=>P($,C_),fb="effect/ScheduleDriver",pb=Symbol.for(fb),GH={start:0,now:0,input:void 0,output:void 0,elapsed:U4,elapsedSincePrevious:U4,recurrence:0},xZ=c$()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>GH}),nb={_Out:($)=>$,_In:($)=>$,_R:($)=>$},lb={_Out:($)=>$,_In:($)=>$,_R:($)=>$};class I_{initial;step;[C_]=nb;constructor($,X){this.initial=$,this.step=X}pipe(){return M(this,arguments)}}var P_=($,X,J,Z)=>lX($,(Q)=>Q.recurrence===0?{now:X,input:J,output:Z,recurrence:Q.recurrence+1,elapsed:U4,elapsedSincePrevious:U4,start:X}:{now:X,input:J,output:Z,recurrence:Q.recurrence+1,elapsed:p$(X-Q.start),elapsedSincePrevious:p$(X-Q.now),start:Q.start});class R_{schedule;ref;[pb]=lb;constructor($,X){this.schedule=$,this.ref=X}get state(){return L(o0(this.ref),($)=>$[1])}get last(){return U(o0(this.ref),([$,X])=>{switch($._tag){case"None":return G$(()=>new l8);case"Some":return O($.value)}})}iterationMeta=Q7(GH);get reset(){return G6(this.ref,[T(),this.schedule.initial]).pipe(vX(G6(this.iterationMeta,GH)))}next($){return D(L(o0(this.ref),(X)=>X[1]),U((X)=>D(J7,U((J)=>D(S(()=>this.schedule.step(J,$,X)),U(([Z,Q,Y])=>{let G=G6(this.ref,[q(Q),Z]);if(Z5(Y))return G.pipe(p(v(T())));let K=jY(Y.intervals)-J;if(K<=0)return G.pipe(p(P_(this.iterationMeta,J,$,Q)),e(Q));let B=p$(K);return D(G,p(P_(this.iterationMeta,J,$,Q)),p(rX(B)),e(Q))}))))))}}var vZ=($,X)=>new I_($,X);var ob=($)=>j_($,x$);var ib=W(2,($,X)=>BH($,(J,Z)=>w(()=>X(J,Z)))),BH=W(2,($,X)=>vZ($.initial,(J,Z,Q)=>U($.step(J,Z,Q),([Y,G,K])=>{if(Z5(K))return O([Y,G,O7]);return L(X(Z,G),(B)=>B?[Y,G,K]:[Y,G,O7])})));var WH=($)=>D(nX([T(),$.initial]),L((X)=>new R_($,X)));var S_=W(2,($,X)=>rb($,X,EM)),rb=W(3,($,X,J)=>vZ([$.initial,X.initial],(Z,Q,Y)=>D(Y6($.step(Z,Q,Y[0]),X.step(Z,Q,Y[1]),(G,K)=>[G,K]),U(([[G,K,B],[H,z,V]])=>{if(SW(B)&&SW(V))return KH($,X,Q,G,K,B.intervals,H,z,V.intervals,J);return O([[G,H],[K,z],O7])})))),KH=($,X,J,Z,Q,Y,G,K,B,H)=>{let z=H(Y,B);if(RM(z))return O([[Z,G],[Q,K],bM(z)]);if(D(Y,IM(B)))return U($.step(IW(Y),J,Z),([V,N,A])=>{if(Z5(A))return O([[V,G],[N,K],O7]);return KH($,X,J,V,N,A.intervals,G,K,B,H)});return U(X.step(IW(B),J,G),([V,N,A])=>{if(Z5(A))return O([[Z,V],[Q,N],O7]);return KH($,X,J,Z,Q,Y,V,N,A.intervals,H)})};var j_=W(2,($,X)=>ab($,(J)=>w(()=>X(J)))),ab=W(2,($,X)=>vZ($.initial,(J,Z,Q)=>U($.step(J,Z,Q),([Y,G,K])=>L(X(G),(B)=>[Y,B,K]))));var sb=($)=>vZ($.initial,(X,J,Z)=>D($.step(X,J,Z),L(([Q,Y,G])=>[Q,J,G])));var HH=($)=>eb(NH,(X)=>X<$);var tb=($,X)=>vZ($,(J,Z,Q)=>w(()=>[X(Q),Q,gM(LM(J))]));var x_=W(2,($,X)=>BH($,(J,Z)=>p1(X(J))));var k_=W(2,($,X)=>BH($,(J,Z)=>X(J))),eb=W(2,($,X)=>ib($,(J,Z)=>X(Z)));var $G=Symbol.for("effect/Schedule/ScheduleDefect");class v_{error;[$G];constructor($){this.error=$,this[$G]=$G}}var $g=($)=>P($,$G),XG=($)=>u8($,(X)=>Q8(new v_(X))),Xg=($)=>C0(L4($,(X)=>c5(X)&&$g(X.defect)?q(X.defect):T()),{onNone:()=>$,onSome:(X)=>I6(X.error)}),yZ=($)=>X6($,(X)=>h(Xg(X))),__=W(2,($,X)=>zH($,X,(J,Z)=>v(J))),y_=W(2,($,X)=>{if(E_(X))return __($,X);let J=X.schedule??sb(NH),Z=X.while?k_(J,(G)=>{let K=X.while(G);if(typeof K==="boolean")return O(K);return XG(K)}):J,Q=X.until?x_(Z,(G)=>{let K=X.until(G);if(typeof K==="boolean")return O(K);return XG(K)}):Z,Y=X.times?S_(Q,HH(X.times)).pipe(j_((G)=>G[0])):Q;return yZ(__($,Y))}),zH=W(3,($,X,J)=>U(WH(X),(Z)=>I0($,{onFailure:(Q)=>J(Q,T()),onSuccess:(Q)=>b_(m4($,xZ,o0(Z.iterationMeta)),Z,(Y,G)=>m4(J(Y,G),xZ,o0(Z.iterationMeta)),Q)}))),b_=($,X,J,Z)=>I0(X.next(Z),{onFailure:()=>xX(X.last),onSuccess:(Q)=>I0($,{onFailure:(Y)=>J(Y,q(Q)),onSuccess:(Y)=>b_($,X,J,Y)})}),kZ=W(2,($,X)=>DH($,X,(J,Z)=>v(J))),g_=W(2,($,X)=>{if(E_(X))return kZ($,X);return yZ(kZ($,JG(X)))}),JG=($)=>{let X=$.schedule??NH,J=$.while?k_(X,(Q)=>{let Y=$.while(Q);if(typeof Y==="boolean")return O(Y);return XG(Y)}):X,Z=$.until?x_(J,(Q)=>{let Y=$.until(Q);if(typeof Y==="boolean")return O(Y);return XG(Y)}):J;return $.times!==void 0?S_(Z,HH($.times)):Z},DH=W(3,($,X,J)=>U(WH(X),(Z)=>h_(m4($,xZ,o0(Z.iterationMeta)),Z,(Q,Y)=>m4(J(Q,Y),xZ,o0(Z.iterationMeta))))),h_=($,X,J)=>{return u8($,(Z)=>I0(X.next(Z),{onFailure:()=>D(X.last,xX,U((Q)=>J(Z,Q))),onSuccess:()=>h_($,X,J)}))},VH=W(2,($,X)=>UH($,void 0,X)),UH=W(3,($,X,J)=>U(WH(J),(Z)=>m_(m4($,xZ,o0(Z.iterationMeta)),X,Z))),m_=($,X,J)=>I0(J.next(X),{onFailure:()=>xX(J.last),onSuccess:()=>U($,(Z)=>m_($,Z,J))});var NH=tb(0,($)=>$+1),d_=ob(HH(1));var c_=W(2,($,X)=>yY(VH($,X)));var p_=W(2,($,X)=>S(()=>{let J=0,Z;return U(I4({while:()=>J<X.steps.length&&(Z===void 0||B8(Z)),body:()=>{let Q=X.steps[J],Y=sY($,Q.provide);if(Z){let G=!1,K=Y;Y=S(()=>{if(G)return K;return G=!0,Z}),Y=yZ(kZ(Y,f_(Q,!1)))}else{let G=f_(Q,!0);Y=G?yZ(kZ(Y,G)):Y}return _8(Y)},step:(Q)=>{Z=Q,J++}}),()=>Z)})),f_=($,X)=>{if(!X)return JG({schedule:$.schedule?$.schedule:$.attempts?void 0:d_,times:$.attempts,while:$.while});else if($.attempts===1||!($.schedule||$.attempts))return;return JG({schedule:$.schedule,while:$.while,times:$.attempts?$.attempts-1:void 0})};var L7=j(Symbol.for("effect/FiberRef/currentCache"),()=>z0(HM(65536,()=>L(o8(),($)=>({listeners:new NZ,handle:$})),()=>r3(60)))),bZ=j(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>z0(!1)),n_=($,X)=>U(o(X)?X:O(X),(J)=>C8((Z)=>{let Q=new Proxy($,{});return l0(bZ,(Y)=>{if(Y){let K=l0(L7,(B)=>U(B.getEither(Q),(H)=>{switch(H._tag){case"Left":{if(H.left.listeners.interrupted)return U(B.invalidateWhen(Q,(z)=>z.handle===H.left.handle),()=>K);return H.left.listeners.increment(),N0((z)=>U(W0(R6(fN,z(v0(H.left.handle)))),(V)=>{return H.left.listeners.decrement(),V}))}case"Right":return H.right.listeners.increment(),N0((z)=>U(W0(R6(c2(J,u2({request:Q,result:H.right.handle,listeners:H.right.listeners,ownerId:Z,state:{completed:!1}})),z(v0(H.right.handle)))),()=>{return H.right.listeners.decrement(),v0(H.right.handle)}))}}));return K}let G=new NZ;return G.increment(),U(o8(),(K)=>D$(R6(c2(J,u2({request:Q,result:K,listeners:G,ownerId:Z,state:{completed:!1}})),v0(K)),w(()=>G.decrement())))})})),l_=($,X)=>{return l0(bZ,(J)=>{if(J)return l0(L7,(Z)=>U(Z.getEither($),(Q)=>{switch(Q._tag){case"Left":return k;case"Right":return VK(Q.right.handle,X)}}));return k})},o_=W(2,($,X)=>H0($,bZ,X)),i_=W(2,($,X)=>H0($,L7,X));var a_=zq;var Zg=S6,Qg=o,Yg=oM,Gg=bW,Kg=f1,Bg=tM,Wg=zB,Hg=W6,zg=bq,Dg=gq,Vg=fw,Ug=pw,Ng=hF,Ag=mF,Og=XF,wg=kq,Fg=yq,Tg=lw,Lg=sw,qg=s8,Mg=ZF,Pg=YW,_g=GW,Cg=IF,Eg=SF,Ig=RF,Rg=uq,Sg=QW,jg=hq,xg=dq,kg=oq,vg=Z8,yg=RP,bg=SJ,gg=m,hg=v,mg=G$,$C=h,dg=j6,AH=Q8,cg=M4,ug=P4,fg=yQ,pg=R4,ng=LF,lg=CF,og=O,OH=aX,ig=bF,rg=S,ag=w,sg=k;var tg=Q6,eg=Iw;var $h=u8,Xh=X6,Jh=Rw,Zh=xJ,Qh=UA,Yh=Sw,Gh=jw,Kh=xw,Bh=kw,Wh=vw,Hh=KB,zh=u1,Dh=QF,Vh=_F,Uh=vF,Nh=g_,Ah=p_,Oh=DH,wh=GB;var Fh=lF,Th=oF,Lh=NB,qh=aF,Mh=gw,Ph=NA,_h=ZM,Ch=jQ,Eh=xQ,Ih=k6,Rh=AA,Sh=Z6,jh=y6,xh=N0,kh=rw,vh=e,yh=Y7,bh=Ew,gh=U0,hh=C4,mh=$F,K5=L,dh=FF,ch=vJ,uh=v6,fh=K7,ph=TF,nh=p1,lh=V7,oh=jq,ih=EQ,rh=B6,ah=D$,sh=kQ,th=D8,eh=LY,$m=qY,Xm=fq,Jm=HW,Zm=z$,Qm=MZ,Ym=PY,Gm=nq,Km=aq,Bm=lM,Wm=xq,Hm=hw,zm=d1,Dm=G7,Vm=iM,Um=vY,Nm=x6,Am=C8,Om=s6,wm=LZ,Fm=rM,Tm=gW,Lm=yY,qm=mq,Mm=aM,Pm=sM,_m=hW,Cm=vQ,Em=wA,Im=tT,Rm=HK,Sm=PA,jm=yw,xm=K6,km=iq,vm=cO,ym=N_,bm=A_,gm=w_,hm=O_,mm=bw,dm=rX,cm=pF,um=UB,fm=$P,pm=JP,nm=mW,lm=XP,om=_Z,im=bK,rm=uO,am=_Y,sm=S8,tm=nw,em=K$,$d=cX,Xd=sY,Jd=h4,Zd=m4,Qd=JT,Yd=XT,Gd=AB,Kd=OB,Bd=ZT,Wd=QT,Hd=wB,zd=sF,Dd=mw,Vd=dw,Ud=QP,Nd=cw,Ad=uw;var Od=qF,wd=_8,Fd=W0,Td=J6,Ld=SQ;var qd=ow,Md=iw,Pd=QZ,_d=aw,Cd=AK,Ed=yA,Id=iF,Rd=rF,Sd=l1,jd=o5,xd=tF,kd=eF,vd=U,yd=_4,bd=E8,gd=EY,hd=cq,md=eM,dd=DW,cd=GZ,ud=V8,fd=dF,pd=cF,nd=VB,ld=uF,od=fF,id=BB,rd=WB,ad=AF,sd=y_,td=xF,ed=zH,$c=VH,Xc=c_,Jc=UH,Zc=I4,Qc=c1,Yc=YF,Gc=H0,Kc=R0,Bc=Y8,Wc=i0,Hc=iX,zc=yF,Dc=n1,Vc=GF,Uc=KF,Nc=YZ,Ac=kJ,Oc=Q0,wc=I0,Fc=BF,Tc=($,...X)=>n6($)(...X),Lc=WF,qc=HB,Mc=HF,Pc=zF,_c=DF,Cc=VF,Ec=UF,Ic=Cw,Rc=Rq,Sc=NF,jc=_A,xc=Sq,kc=xX,vc=JK,yc=jX,bc=MF,gc=PF,hc=ew,mc=EF,dc=C1,XC=pO,cc=W(2,($,X)=>XC($,q_(X))),uc=rq,fc=F7,pc=l5,nc=E4,lc=bQ,oc=WW,ic=gF,rc=DB,ac=pq,sc=KW,tc=CA,ec=$T,$u=kY,Xu=fM,Ju=yW,Zu=nM,Qu=PP,Yu=MP,Gu=_P,Ku=CP,Bu=EP,Wu=IP,Hu=lq,zu=BW,Du=sq,Vu=tq,Uu=eq,JC=t6,Nu=W(2,($,X)=>JC($,X,(J,Z)=>J(Z))),Au=R6,Ou=CQ,wu=RQ,Fu=W(($)=>a_($[0]),n_),Tu=l_,Lu=FA,qu=o_,Mu=i_,Pu=nF,_u=E1,Cu=nO,Eu=IY,Iu=TA,Ru=LA,Su=KT,ju=YT,xu=o1,ku=BT,vu=VT,yu=UT,bu=WT,gu=GT,hu=DT,mu=H$,du=h1,ZC=TB,cu=NT,uu=QM,fu=m1,pu=AT,nu=OT,lu=($)=>{return H4($)?OH:K5($.value,T6)},ou=W(2,($,X)=>H4($)?OH:K5(X($.value),T6)),QC=($)=>{let X=new Map;return new Proxy($,{get(J,Z,Q){if(Z in J)return Reflect.get(J,Z,Q);if(X.has(Z))return X.get(Z);let Y=(...V)=>_4(J,(N)=>{if(typeof N[Z]==="function")return X.set(Z,(...A)=>_4(J,(F)=>F[Z](...A))),N[Z](...V);return X.set(Z,_4(J,(A)=>A[Z])),N[Z]}),G=_4(J,(V)=>V[Z]);Object.assign(Y,G);let{apply:K,bind:B,call:H}=Y,z=Object.setPrototypeOf({},Object.getPrototypeOf(G));return z.apply=K,z.bind=B,z.call=H,Object.setPrototypeOf(Y,z),X.set(Z,Y),Y}})},iu=($)=>()=>{let X=Error.stackTraceLimit;Error.stackTraceLimit=2;let J=Error();Error.stackTraceLimit=X;function Z(){}return Object.setPrototypeOf(Z,R5),Z.key=$,Object.defineProperty(Z,"use",{get(){return(Q)=>_4(this,Q)}}),Object.defineProperty(Z,"stack",{get(){return J.stack}}),QC(Z)},ru=function(){return function(){let[$,X]=arguments,J="accessors"in X?X.accessors:!1,Z=Error.stackTraceLimit;Error.stackTraceLimit=2;let Q=Error();Error.stackTraceLimit=Z;let Y="unchecked",G=function(V){if(Y==="unchecked"){let N=Object.getPrototypeOf(V);if(N===Object.prototype||N===null)Y="plain";else{let A=Object.getPrototypeOf(this);Object.setPrototypeOf(A,N),Y="patched"}}if(Y==="plain")Object.assign(this,V);else if(Y==="patched")return Object.setPrototypeOf(V,Object.getPrototypeOf(this)),V};G.prototype._tag=$,Object.defineProperty(G,"make",{get(){return(V)=>new this(V)}}),Object.defineProperty(G,"use",{get(){return(V)=>_4(this,V)}}),G.key=$,Object.assign(G,R5),Object.defineProperty(G,"stack",{get(){return Q.stack}});let K="dependencies"in X&&X.dependencies.length>0,B=K?"DefaultWithoutDependencies":"Default",H,z=!1;if("effect"in X)z=typeof X.effect==="function",Object.defineProperty(G,B,{get(){if(z)return function(){return f4(G,K5(X.effect.apply(null,arguments),(V)=>new this(V)))}.bind(this);return H??=f4(G,K5(X.effect,(V)=>new this(V)))}});else if("scoped"in X)z=typeof X.scoped==="function",Object.defineProperty(G,B,{get(){if(z)return function(){return p4(G,K5(X.scoped.apply(null,arguments),(V)=>new this(V)))}.bind(this);return H??=p4(G,K5(X.scoped,(V)=>new this(V)))}});else if("sync"in X)Object.defineProperty(G,B,{get(){return H??=aY(G,()=>new this(X.sync()))}});else Object.defineProperty(G,B,{get(){return H??=T7(G,new this(X.succeed))}});if(K){let V;Object.defineProperty(G,"Default",{get(){if(z)return function(){return G5(this.DefaultWithoutDependencies.apply(null,arguments),X.dependencies)};return V??=G5(this.DefaultWithoutDependencies,X.dependencies)}})}return J===!0?QC(G):G}},au=function($,...X){let J=Error.stackTraceLimit;Error.stackTraceLimit=2;let Z=Error();if(Error.stackTraceLimit=J,typeof $!=="string")return t_($.length,function(...G){let K=Error.stackTraceLimit;Error.stackTraceLimit=2;let B=Error();return Error.stackTraceLimit=K,e_({self:this,body:$,args:G,pipeables:X,spanName:"<anonymous>",spanOptions:{context:$7.context(!0)},errorDef:Z,errorCall:B})});let Q=$,Y=X[0];return(G,...K)=>t_(G.length,{[Q](...B){let H=Error.stackTraceLimit;Error.stackTraceLimit=2;let z=Error();return Error.stackTraceLimit=H,e_({self:this,body:G,args:B,pipeables:K,spanName:Q,spanOptions:Y,errorDef:Z,errorCall:z})}}[Q])};function t_($,X){return Object.defineProperty(X,"length",{value:$,configurable:!0})}function e_($){let X,J=void 0;if(HV($.body))X=IJ(()=>$.body.apply($.self,$.args));else try{X=$.body.apply($.self,$.args)}catch(G){J=G,X=AH(G)}if($.pipeables.length>0)try{for(let G of $.pipeables)X=G(X,...$.args)}catch(G){X=J?$C(B0(M0(J),M0(G))):AH(G)}let Z=!1,Q=()=>{if(Z!==!1)return Z;if($.errorCall.stack){let G=$.errorDef.stack.trim().split(`
`),K=$.errorCall.stack.trim().split(`
`),B=G.slice(2).join(`
`).trim();if(!B.includes("("))B=B.replace(/at (.*)/,"at ($1)");let H=K.slice(2).join(`
`).trim();if(!H.includes("("))H=H.replace(/at (.*)/,"at ($1)");return Z=`${B}
${H}`,Z}},Y=$.spanOptions&&"captureStackTrace"in $.spanOptions?$.spanOptions:{captureStackTrace:Q,...$.spanOptions};return ZC(X,$.spanName,Y)}var su=i5,tu=()=>($)=>$,eu=()=>($)=>$,$f=()=>($)=>$;var gZ={};o4(gZ,{zipWith:()=>Wp,withSpan:()=>Cp,withParentSpan:()=>Ep,updateService:()=>Sp,unwrapScoped:()=>zp,unwrapEffect:()=>Hp,toRuntimeWithMemoMap:()=>Kp,toRuntime:()=>Gp,tapErrorCause:()=>Yp,tapError:()=>Qp,tap:()=>Zp,syncContext:()=>Jp,sync:()=>Xp,suspend:()=>$p,succeedContext:()=>ef,succeed:()=>tf,span:()=>Tp,setVersionMismatchErrorLogLevel:()=>_p,setUnhandledErrorLogLevel:()=>Pp,setTracerTiming:()=>Mp,setTracerEnabled:()=>qp,setTracer:()=>Lp,setScheduler:()=>Fp,setRequestCaching:()=>Op,setRequestCache:()=>wp,setRequestBatching:()=>Ap,setRandom:()=>Np,setConfigProvider:()=>Vp,setClock:()=>Dp,service:()=>sf,scopedDiscard:()=>I$,scopedContext:()=>af,scoped:()=>rf,scope:()=>of,retry:()=>lf,provideMerge:()=>Bp,provide:()=>zC,project:()=>df,passthrough:()=>mf,parentSpan:()=>Up,orElse:()=>hf,orDie:()=>gf,mock:()=>If,mergeAll:()=>bf,merge:()=>yf,memoize:()=>vf,matchCause:()=>kf,match:()=>xf,mapError:()=>jf,map:()=>HC,makeMemoMap:()=>Ip,locallyWith:()=>ff,locallyScoped:()=>pf,locallyEffect:()=>cf,locally:()=>uf,launch:()=>Sf,isLayer:()=>Yf,isFresh:()=>Gf,function:()=>Rf,fresh:()=>Ef,flatten:()=>Cf,flatMap:()=>_f,fiberRefLocallyScopedWith:()=>nf,failSync:()=>qf,failCauseSync:()=>Pf,failCause:()=>Mf,fail:()=>Lf,extendScope:()=>Tf,empty:()=>Ff,effectDiscard:()=>Of,effectContext:()=>wf,effect:()=>Af,discard:()=>Nf,dieSync:()=>Uf,die:()=>Vf,context:()=>WC,catchAllCause:()=>Df,catchAll:()=>zf,buildWithScope:()=>Hf,buildWithMemoMap:()=>Rp,build:()=>Wf,annotateSpans:()=>Bf,annotateLogs:()=>Kf,MemoMapTypeId:()=>Zf,LayerTypeId:()=>Jf,CurrentMemoMap:()=>Qf});var YC=($)=>Y5(_Y($)),GC=($)=>J4(q8(O8,$)),KC=($,X)=>{return X=a8(X),p4(O8,X?.onEnd?V8(H$($,X),(J)=>B6((Z)=>X.onEnd(J,Z))):H$($,X))},BC=($)=>Y5(IY($));var Jf=dY,Zf=CZ,Qf=lW,Yf=IZ,Gf=oW,Kf=D_,Bf=V_,Wf=yP,Hf=u4,zf=Q5,Df=aW,WC=uY,Vf=sW,Uf=gP,Nf=hP,Af=f4,Of=cP,wf=G8,Ff=Q_,Tf=mP,Lf=tW,qf=eW,Mf=RZ,Pf=fY,_f=z6,Cf=dP,Ef=$H,If=oP,Rf=nP;var Sf=lP,HC=lY,jf=iP,xf=iY,kf=oY,vf=rP,yf=XH,bf=rY,gf=aP,hf=sP,mf=tP,df=eP,cf=pY,uf=uP,ff=nY,pf=fP,nf=pP,lf=$_,of=J_,rf=p4,I$=Y5,af=SZ,sf=Z_,tf=T7,ef=J4,$p=jZ,Xp=aY,Jp=Y_,Zp=G_,Qp=K_,Yp=B_,Gp=W_,Kp=H_,zC=G5,Bp=z_,Wp=JH,Hp=ZH,zp=EZ,Dp=($)=>I$(i0(G0,t(N8,$))),Vp=YC,Up=GC,Np=($)=>I$(i0(G0,t(c6,$))),Ap=($)=>I$(Y8(bJ,$)),Op=($)=>I$(Y8(bZ,$)),wp=($)=>I$(o($)?U($,(X)=>Y8(L7,X)):Y8(L7,$)),Fp=($)=>I$(Y8(l6,$)),Tp=KC,Lp=BC,qp=($)=>I$(Y8(hJ,$)),Mp=($)=>I$(Y8(S4,$)),Pp=($)=>I$(Y8(gJ,$)),_p=($)=>I$(Y8(pQ,$)),Cp=U_,Ep=mY,Ip=rW,Rp=cY,Sp=W(3,($,X,J)=>zC($,HC(WC(),(Z)=>t(Z,X,J(X$(Z,X))))));var KG={};o4(KG,{zipWith:()=>Pn,zip:()=>Mn,withDescription:()=>qn,withDefault:()=>Ln,validate:()=>Tn,url:()=>pp,unwrap:()=>Fn,sync:()=>On,suspend:()=>An,succeed:()=>Nn,string:()=>Vn,secret:()=>Wn,repeat:()=>Bn,redacted:()=>Hn,primitive:()=>Kn,port:()=>fp,orElseIf:()=>Yn,orElse:()=>Qn,option:()=>Gn,number:()=>ip,nonEmptyString:()=>Un,nested:()=>Zn,mapOrFail:()=>Jn,mapAttempt:()=>Xn,map:()=>$n,logLevel:()=>sp,literal:()=>ap,isConfig:()=>ep,integer:()=>rp,hashSet:()=>Dn,hashMap:()=>wn,fail:()=>op,duration:()=>tp,date:()=>lp,chunk:()=>np,branded:()=>zn,boolean:()=>up,array:()=>cp,all:()=>dp,ConfigTypeId:()=>mp});var wH=KO;var VC="effect/Redacted",q7=j("effect/Redacted/redactedRegistry",()=>new WeakMap),UC=Symbol.for(VC),FH={[UC]:{_A:($)=>$},pipe(){return M(this,arguments)},toString(){return"<redacted>"},toJSON(){return"<redacted>"},[g](){return"<redacted>"},[R](){return D(_(VC),x(_(q7.get(this))),b(this))},[I]($){return jp($)&&C(q7.get(this),q7.get($))}},jp=($)=>P($,UC),NC=($)=>{let X=Object.create(FH);return q7.set(X,$),X};var xp="effect/Secret",OC=Symbol.for(xp);var kp={...FH,[OC]:OC},vp=($)=>{let X=Object.create(kp);return Object.defineProperty(X,"toString",{enumerable:!1,value(){return"Secret(<redacted>)"}}),Object.defineProperty(X,"toJSON",{enumerable:!1,value(){return"<redacted>"}}),Object.defineProperty(X,"raw",{enumerable:!1,value:$}),q7.set(X,$.map((J)=>String.fromCharCode(J)).join("")),X};var wC=($)=>{return vp($.split("").map((X)=>X.charCodeAt(0)))};var bp="effect/Config",QG=Symbol.for(bp),gp={_A:($)=>$},U$={...F$,[QG]:gp,commit(){return fO(this)}},TC=($)=>{let X=N$("a boolean property",(J)=>{switch(J){case"true":case"yes":case"on":case"1":return f(!0);case"false":case"no":case"off":case"0":return f(!1);default:{let Z=A8([],`Expected a boolean value but received ${v$(J)}`);return $0(Z)}}});return $===void 0?X:r0(X,$)},LC=($)=>{let X=N$("an URL property",(J)=>IV({try:()=>new URL(J),catch:(Z)=>A8([],`Expected an URL value but received ${v$(J)}`)}));return $===void 0?X:r0(X,$)},qC=($)=>{let X=N$("a network port property",(J)=>{let Z=Number(J);if(Number.isNaN(Z)||Z.toString()!==J.toString()||!Number.isInteger(Z)||Z<1||Z>65535)return $0(A8([],`Expected a network port value but received ${v$(J)}`));return f(Z)});return $===void 0?X:r0(X,$)},MC=($,X)=>{return D(YG($,X),D6(FU))},YG=($,X)=>{return D6(X===void 0?ZG($):r0(ZG($),X),HX)},PC=($)=>{let X=N$("a date property",(J)=>{let Z=Date.parse(J);if(Number.isNaN(Z))return $0(A8([],`Expected a Date value but received ${v$(J)}`));return f(new Date(Z))});return $===void 0?X:r0(X,$)},_C=($)=>{let X=Object.create(U$);return X._tag=D1,X.message=$,X.parse=()=>$0(B1([],$)),X},CC=($)=>{let X=N$("a number property",(J)=>{let Z=Number(J);if(Number.isNaN(Z))return $0(A8([],`Expected a number value but received ${v$(J)}`));return f(Z)});return $===void 0?X:r0(X,$)},EC=($)=>{let X=N$("an integer property",(J)=>{let Z=Number(J);if(!Number.isInteger(Z))return $0(A8([],`Expected an integer value but received ${v$(J)}`));return f(Z)});return $===void 0?X:r0(X,$)},IC=(...$)=>(X)=>{let J=$.map(String).join(", "),Z=N$(`one of (${J})`,(Q)=>{let Y=$.find((G)=>String(G)===Q);if(Y===void 0)return $0(A8([],`Expected one of (${J}) but received ${v$(Q)}`));return f(Y)});return X===void 0?Z:r0(Z,X)},RC=($)=>{let X=n4(M7(),(J)=>{let Z=J.toUpperCase(),Q=BK.find((Y)=>Y.label===Z);return Q===void 0?$0(A8([],`Expected a log level but received ${v$(J)}`)):f(Q)});return $===void 0?X:r0(X,$)},SC=($)=>{let X=n4(M7(),(J)=>{let Z=_U(J);return EV(Z,()=>A8([],`Expected a duration but received ${v$(J)}`))});return $===void 0?X:r0(X,$)},D6=W(2,($,X)=>n4($,(J)=>f(X(J)))),jC=W(2,($,X)=>n4($,(J)=>{try{return f(X(J))}catch(Z){return $0(A8([],Z instanceof Error?Z.message:`${Z}`))}})),n4=W(2,($,X)=>{let J=Object.create(U$);return J._tag=N1,J.original=$,J.mapOrFail=X,J}),r0=W(2,($,X)=>{let J=Object.create(U$);return J._tag=A1,J.name=X,J.config=$,J}),xC=W(2,($,X)=>{let J=Object.create(U$);return J._tag=sJ,J.first=$,J.second=hZ(X),J.condition=b8,J}),GG=W(2,($,X)=>{let J=Object.create(U$);return J._tag=sJ,J.first=$,J.second=hZ(X.orElse),J.condition=X.if,J}),kC=($)=>{return D($,D6(q),GG({orElse:()=>P7(T()),if:wH}))},N$=($,X)=>{let J=Object.create(U$);return J._tag=O1,J.description=$,J.parse=X,J},ZG=($)=>{let X=Object.create(U$);return X._tag=w1,X.config=$,X},vC=($)=>{let X=N$("a secret property",(J)=>f(wC(J)));return $===void 0?X:r0(X,$)},yC=($)=>{let X=mZ($)?$:M7($);return D6(X,NC)},bC=W(2,($,X)=>{let J=mZ($)?$:M7($);return n4(J,(Z)=>X.either(Z).pipe(RV((Q)=>A8([],Q.map((Y)=>Y.message).join(`
`)))))}),gC=($,X)=>{let J=D6(YG($),UX);return X===void 0?J:r0(J,X)},M7=($)=>{let X=N$("a text property",f);return $===void 0?X:r0(X,$)},hC=($)=>{let X=N$("a non-empty text property",SV((J)=>J.length>0,()=>r8([],"Expected a non-empty string")));return $===void 0?X:r0(X,$)},mC=($)=>{if(Array.isArray($))return FC($);else if(Symbol.iterator in $)return FC([...$]);return dC($)},dC=($)=>{let X=Object.entries($),J=D(X[0][1],D6((Q)=>({[X[0][0]]:Q})));if(X.length===1)return J;let Z=X.slice(1);for(let[Q,Y]of Z)J=D(J,dZ(Y,(G,K)=>({...G,[Q]:K})));return J},P7=($)=>{let X=Object.create(U$);return X._tag=z1,X.value=$,X.parse=()=>f($),X},hZ=($)=>{let X=Object.create(U$);return X._tag=U1,X.config=$,X},cC=($)=>{return hZ(()=>P7($()))},uC=($,X)=>{let J=Object.create(U$);return J._tag=F1,J.valueConfig=$,X===void 0?J:r0(J,X)},mZ=($)=>P($,QG),FC=($)=>{if($.length===0)return P7([]);if($.length===1)return D6($[0],(J)=>[J]);let X=D6($[0],(J)=>[J]);for(let J=1;J<$.length;J++){let Z=$[J];X=D(X,dZ(Z,(Q,Y)=>[...Q,Y]))}return X},TH=($)=>{if(mZ($))return $;return dC(Object.fromEntries(Object.entries($).map(([X,J])=>[X,TH(J)])))},fC=W(2,($,{message:X,validation:J})=>n4($,(Z)=>{if(J(Z))return f(Z);return $0(A8([],X))})),pC=W(2,($,X)=>GG($,{orElse:()=>P7(X),if:wH})),nC=W(2,($,X)=>{let J=Object.create(U$);return J._tag=V1,J.config=$,J.description=X,J}),lC=W(2,($,X)=>dZ($,X,(J,Z)=>[J,Z])),dZ=W(3,($,X,J)=>{let Z=Object.create(U$);return Z._tag=T1,Z.left=$,Z.right=X,Z.zip=J,Z});var mp=QG,dp=mC,cp=MC,up=TC,fp=qC,pp=LC,np=YG,lp=PC,op=_C,ip=CC,rp=EC,ap=IC,sp=RC,tp=SC,ep=mZ,$n=D6,Xn=jC,Jn=n4,Zn=r0,Qn=xC,Yn=GG,Gn=kC,Kn=N$,Bn=ZG,Wn=vC,Hn=yC,zn=bC,Dn=gC,Vn=M7,Un=hC,Nn=P7,An=hZ,On=cC,wn=uC,Fn=TH,Tn=fC,Ln=pC,qn=nC,Mn=lC,Pn=dZ;var BG={};o4(BG,{within:()=>fn,upperCase:()=>un,unnested:()=>dn,snakeCase:()=>cn,orElse:()=>mn,nested:()=>hn,mapInputPath:()=>yn,makeFlat:()=>Rn,make:()=>In,lowerCase:()=>gn,kebabCase:()=>bn,fromMap:()=>kn,fromJson:()=>xn,fromFlat:()=>jn,fromEnv:()=>Sn,constantCase:()=>vn,FlatConfigProviderTypeId:()=>Cn,ConfigProviderTypeId:()=>_n,ConfigProvider:()=>En});var _n=q1,Cn=M1,En=x4,In=SK,Rn=k4,Sn=P1,jn=v4,xn=PO,kn=jK,vn=AO,yn=pX,bn=OO,gn=wO,hn=xK,mn=vK,dn=kK,cn=FO,un=TO,fn=LO;class LH extends eY.TaggedError("KeyVaultError"){}class cZ extends q0.Tag("effect-azure-kv/client/KeyVault")(){}var oC=($)=>E$.gen(function*(){let X=new $3($.vaultURL,$.credential,$.pipelineOptions);return cZ.of({use:(J)=>E$.gen(function*(){let Z=yield*E$.try({try:()=>J(X),catch:(Q)=>new LH({cause:Q,message:"Syncronous error in 'KeyVault.use'"})});if(Z instanceof Promise)return yield*E$.tryPromise({try:()=>Z,catch:(Q)=>new LH({cause:Q,message:"Asyncronous error in 'KeyVault.use'"})});else return Z})})}),tJ0=($)=>gZ.scoped(cZ,oC({credential:$.credential,vaultURL:$.vaultURL,pipelineOptions:$.pipelineOptions})),pn=gZ.scoped(cZ,E$.gen(function*(){let $=yield*KG.url("KV_URL");return yield*oC({vaultURL:$.href,credential:new z9}).pipe(E$.withConfigProvider(BG.fromEnv()))}));class nn extends E$.Service()("effect-azure-kv/client/KeyVaultAsCache",{dependencies:[pn],effect:($)=>E$.gen(function*(){let X=yield*cZ;return yield*RY.make({...$,lookup:(Z)=>X.use((Q)=>Q.getSecret(Z))})})}){}export{oC as make,tJ0 as layer,pn as fromEnv,LH as KeyVaultError,nn as KeyVaultAsCache,cZ as KeyVault};
